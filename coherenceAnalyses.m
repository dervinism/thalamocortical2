%cleanUp
format longG
warning('off','all')
pathStr = genpath('dependencies');
addpath(pathStr);
tic

AreaCx3(1) = area(5.644, 5.644);
AreaCx3(2) = area(5.644, 160*5.644);
AreaTC = area(60, 90);
AreaNRT = area(42, 63);

list = dir('*dat');
iList = 001:900;

dt = .25;
dtInterp = 40*dt;
xRange = [015000 1200000]+dt;
iRange = xRange./dt;
iRange = round(iRange(1):iRange(end));
nPY = 100;
nIN = 50;
nTC = 100;
nNRT = 50;
if ~exist('nCores','var')
    nCores = 32;
end

opt.maxFreq = 110;
opt.winfactor = 10;
opt.freqfactor = 1.333;
opt.tapers = 5;
opt.typespk1 = 'c';
opt.typespk2 = 'c';
if opt.maxFreq > (1000/dt)/2
    error('opt.maxFreq > Nyquist?!')
end

if ~exist('coherence','var')
    coherence = false;
end
if ~exist('xCorrelation','var')
    xCorrelation = true;
end
if ~exist('eegts','var')
    eegts = false;
end
if ~exist('eegsts','var')
    eegsts = true;
end
if ~exist('vm','var')
    vm = false;
end
if ~exist('fr','var')
    fr = true;
end
if ~exist('psi','var')
    psi = true;
end
if ~exist('fullRun','var')
    fullRun = true;
end
type = 'SWDs_human';

% Load the EEG data
EEGinit = readBinary('EEG.bin', 'double');

% Estimate EEG oscillation frequency and band-pass filter the EEG data
oscFrequency = oscFreq(EEGinit, dt, type);
Fpass = [oscFrequency-4; oscFrequency-2; oscFrequency; oscFrequency+2; oscFrequency+4];
Fpass(Fpass <= 0) = 1e-9;
if exist('filter.mat', 'file')
    load('filter.mat'); %#ok<*LOAD>
else
    d = designFilterBP(Fpass, 65, 0.5, 65, 1000/dt);
end
EEGinitFilt = filtfilt(d, EEGinit);
[~, phaseEEGinitHT] = hilbertTransform(EEGinitFilt-mean(EEGinitFilt));

% Detect EEG spikes
if strcmpi(type, 'SWDs_human') || strcmpi(type, 'SWDs_rodent')
    [eegSpikes, eegSpikesSWD, eegSpikesT, eegSpikesLocs, eegSpikesLocsSWD, eegSpikesLarge, eegSpikesLargeSWD,...
    eegSpikesLargeT, eegSpikesLargeLocs, eegSpikesLargeLocsSWD, tWaves, waveLocs, tWavesLarge, waveLocsLarge, SWDs,...
    SWDsLarge, phase, SWCs, phaseLarge, SWCsLarge, interictal, interictalLarge, swdFrequency] = detectEEGspikesSWDs(EEGinit(iRange), dt, true);
else
    eegSpikes = detectEEGspikes(EEGinit(iRange), dt, type);
end

% Initialise storage variables
freq = freqDependentWindowCoherence((EEGinit(iRange)-mean(EEGinit(iRange)))',...
    (EEGinit(iRange)-mean(EEGinit(iRange)))', dt/1000, [], opt);
cohAll = zeros(900, length(freq));
cohAll_conf = zeros(900, length(freq));
phaseAll = zeros(900, length(freq));
phaseAll_confU = zeros(900, length(freq));
phaseAll_confL = zeros(900, length(freq));
window = 3*round(1000/dt);
xCorrAll = zeros(900, 2*window+1);
eegtsAll = zeros(900, 2*window+1);
eegstsAll = zeros(900, 2*window+1);
if vm
    vmAll = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
end
if fr
    slide = dtInterp;
    frWindow = round(1000/dt);
    ISI = 18;
    frAll = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    trAll = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    brAll = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    br2All = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    frFrAll = zeros(900, 1);
    trFrAll = zeros(900, 1);
    brFrAll = zeros(900, 1);
    frFrLargeAll = zeros(900, 1);
    trFrLargeAll = zeros(900, 1);
    brFrLargeAll = zeros(900, 1);
end
if psi
    %psiWindow = round(1000/dt);
    psiWindow = round(1000/dt);
    phaseDiffAll = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    psiAll_t = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    psiAll = zeros(900, 1);
    phaseDiffRasterAll = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    phaseDiffRasterAllInitial = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    phaseDiffRasterAllFinal = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    psiRasterAll_t = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    psiRasterAll_tInitial = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    psiRasterAll_tFinal = zeros(900, ceil(numel(EEGinit(iRange))/(dtInterp/dt)));
    psiRasterAll = zeros(900, 1);
end
if eegts && eegsts && (strcmpi(type, 'SWDs_human') || strcmpi(type, 'SWDs_rodent'))
    eegtsInitAll = zeros(900, 2*window+1);
    eegtsInitLargeAll = zeros(900, 2*window+1);
    eegstsInitAll = zeros(900, 2*window+1);
    eegstsInitLargeAll = zeros(900, 2*window+1);
    eegtsFinalAll = zeros(900, 2*window+1);
    eegtsFinalLargeAll = zeros(900, 2*window+1);
    eegstsFinalAll = zeros(900, 2*window+1);
    eegstsFinalLargeAll = zeros(900, 2*window+1);
end

% Calculate coherence
if fullRun
    parpool(nCores);
    parfor l = iList
    %for l = iList
        disp(['Loading file: ' num2str(l)])
        fileName = list(l).name;
        if l <= 4*(nPY+nIN)
            [~, data, cellType] = loadFile(fileName, AreaCx3, 'Cx3');
        elseif l <= 4*(nPY+nIN)+2*nNRT
            [~, data, cellType] = loadFile(fileName, AreaNRT, 'NRT');
        elseif l <= 4*(nPY+nIN)+2*nNRT+2*nTC
            [~, data, cellType] = loadFile(fileName, AreaTC, 'TC');
        end
        
        % Trim data
        if xRange(1) > data.t(1) %#ok<*PFBNS>
            t = data.t(iRange);
            EEG = EEGinit(iRange);
            eegSpikesParfor = eegSpikes;
            v = data.v(iRange);
            EEGfilt = EEGinitFilt(iRange);
        else
            t = data.t;
            EEG = EEGinit;
            eegSpikesParfor = eegSpikes;
            v = data.v;
            EEGfilt = EEGinitFilt;
        end
        tInterp = t(1):dtInterp:t(end); %#ok<*NASGU>
        
        EEGnorm = (EEG-max(EEG))./min(EEG-max(EEG));
        EEGfiltNorm = (EEGfilt-max(EEGfilt))./min(EEGfilt-max(EEGfilt));
        vNorm = (v-min(v))./max(v-min(v));
        
        if strcmpi(type, 'SWDs_human') || strcmpi(type, 'SWDs_rodent')
            rasterInit = rastergramInit(v, SWCs);
            rasterInitLarge = rastergramInit(v, SWCsLarge);
            rasterFinal = rastergramInit(fliplr(v), fliplr(SWCs));
            rasterFinal = fliplr(rasterFinal);
            rasterFinalLarge = rastergramInit(fliplr(v), fliplr(SWCsLarge));
            rasterFinalLarge = fliplr(rasterFinalLarge);
        end
        
        if coherence
            [freq, coh, phase, coh_conf, phase_confU, phase_confL] = freqDependentWindowCoherence(...
                (EEGnorm-mean(EEGnorm))', (vNorm-mean(vNorm))', dt/1000, [], opt); %#ok<*UNRCH,*PFTUSW>
            phase(isnan(phase_confU)) = NaN;
            phase(isnan(phase_confL)) = NaN;
            
            cohAll(l,:) = coh;
            cohAll_conf(l,:) = coh_conf;
            phaseAll(l,:) = phase;
            phaseAll_confU(l,:) = phase_confU;
            phaseAll_confL(l,:) = phase_confL;
        end
        
        if xCorrelation
            [xCorrAll(l,:), lags] = xcorr(vNorm', EEGnorm', window, 'normalized'); %#ok<*ASGLU>
        end
        
        if eegts || eegsts || fr || psi
            raster = rastergram(v);
        end
        
        if eegts
            [eegtsAll(l,:), lags] = xcorr(raster', EEGnorm', window, 'normalized');
            if strcmpi(type, 'SWDs_human') || strcmpi(type, 'SWDs_rodent')
                [eegtsInitAll(l,:), lags] = xcorr(rasterInit', EEGnorm', window, 'normalized');
                [eegtsInitLargeAll(l,:), lags] = xcorr(rasterInitLarge', EEGnorm', window, 'normalized');
                [eegtsFinalAll(l,:), lags] = xcorr(rasterFinal', EEGnorm', window, 'normalized');
                [eegtsFinalLargeAll(l,:), lags] = xcorr(rasterFinalLarge', EEGnorm', window, 'normalized');
            end
        end
        
        if eegsts
            [eegstsAll(l,:), lags] = xcorr(raster', eegSpikesParfor', window, 'normalized');
            if strcmpi(type, 'SWDs_human') || strcmpi(type, 'SWDs_rodent')
                [eegstsInitAll(l,:), lags] = xcorr(rasterInit', eegSpikesParfor', window, 'normalized');
                [eegstsInitLargeAll(l,:), lags] = xcorr(rasterInitLarge', eegSpikesParfor', window, 'normalized');
                [eegstsFinalAll(l,:), lags] = xcorr(rasterFinal', eegSpikesParfor', window, 'normalized');
                [eegstsFinalLargeAll(l,:), lags] = xcorr(rasterFinalLarge', eegSpikesParfor', window, 'normalized');
            end
        end
        
        if vm
            nMean = floor(numel(v) / (dtInterp/dt));
            if nMean < numel(v)
                vInit = mean(v(1:end-(nMean*(dtInterp/dt))));
            end
            vmAll(l,:) = [vInit mean(reshape(v(end-(nMean*(dtInterp/dt))+1:end), dtInterp/dt, []), 1)];
        end
        
        if fr
            [frAllTemp, trAllTemp, brAllTemp, br2AllTemp, tFR] = frCalcT(raster, t, slide, frWindow, ISI);
            frAll(l,:) = interp1(tFR, frAllTemp, tInterp, 'linear', 'extrap');
            trAll(l,:) = interp1(tFR, trAllTemp, tInterp, 'linear', 'extrap');
            brAll(l,:) = interp1(tFR, brAllTemp, tInterp, 'linear', 'extrap');
            br2All(l,:) = interp1(tFR, br2AllTemp, tInterp, 'linear', 'extrap');
            [frFrAll(l), trFrAll(l), brFrAll(l)] = frCalc(raster, t, eegSpikesLocs, waveLocs, ISI);
            [frFrLargeAll(l), trFrLargeAll(l), brFrLargeAll(l)] = frCalc(raster, t, eegSpikesLargeLocs, waveLocs, ISI);
        end
        
        if psi
            vFilt = filtfilt(d, v);
            vFiltNorm = (vFilt-min(vFilt))./max(vFilt-min(vFilt));
            [psiAll(l), phaseSyncIndex_t, phase1, phase2, phaseDifference] = hilbertPhaseSync(vFiltNorm, EEGfiltNorm, psiWindow);
            psiAll_t(l,:) = interp1(t, phaseSyncIndex_t, tInterp);
            phaseDiffAll(l,:) = interp1(t, phaseDifference, tInterp);
%             figure; plot(t./1000, (vFiltNorm-mean(vFiltNorm)).*pi); hold on
%             plot(t./1000, (EEGfiltNorm-mean(EEGfiltNorm)).*pi);
%             plot(t./1000, phase1);
%             plot(t./1000, phase2);
%             plot(tInterp./1000, phaseDiffAll(l,:));
%             plot(tInterp./1000, psiAll_t(l,:)); hold off
%             legend('V_M','EEG','phi1','phi2','phi2-phi1','PSI');
            
            rasterFilt = filtfilt(d, raster);
            rasterFiltNorm = (rasterFilt-min(rasterFilt))./max(rasterFilt-min(rasterFilt));
            [psiRasterAll(l), phaseSyncIndexRaster_t, phaseRaster1, phaseRaster2,...
                phaseDifferenceRaster] = hilbertPhaseSync(rasterFiltNorm, EEGfiltNorm, psiWindow, raster);
            psiRasterAll_t(l,:) = interp1(t, phaseSyncIndexRaster_t, tInterp);
            phaseDiffRasterAll(l,:) = interp1(t, phaseDifferenceRaster, tInterp);
%             figure; plot(t./1000, (rasterFiltNorm-mean(rasterFiltNorm)).*300); hold on
%             plot(t./1000, (EEGfiltNorm-mean(EEGfiltNorm)).*pi);
%             plot(t./1000, phaseRaster1);
%             plot(t./1000, phaseRaster2);
%             plot(tInterp./1000, phaseDiffRasterAll(l,:));
%             plot(tInterp./1000, psiRasterAll_t(l,:)); hold off
%             legend('spikes','EEG','phi1','phi2','phi2-phi1','PSI');

            rasterFilt = filtfilt(d, rasterInit);
            rasterFiltNorm = (rasterFilt-min(rasterFilt))./max(rasterFilt-min(rasterFilt));
            [~,~,~,~, phaseDifferenceRasterInitial] = hilbertPhaseSync(rasterFiltNorm, EEGfiltNorm, psiWindow, rasterInit);
            psiRasterAll_tInitial(l,:) = interp1(t, phaseSyncIndexRaster_t, tInterp);
            phaseDiffRasterAllInitial(l,:) = interp1(t, phaseDifferenceRasterInitial, tInterp);

            rasterFilt = filtfilt(d, rasterFinal);
            rasterFiltNorm = (rasterFilt-min(rasterFilt))./max(rasterFilt-min(rasterFilt));
            [~,~,~,~, phaseDifferenceRasterFinal] = hilbertPhaseSync(rasterFiltNorm, EEGfiltNorm, psiWindow, rasterFinal);
            psiRasterAll_tFinal(l,:) = interp1(t, phaseSyncIndexRaster_t, tInterp);
            phaseDiffRasterAllFinal(l,:) = interp1(t, phaseDifferenceRasterFinal, tInterp);
        end
    end
    
    if coherence
        cohCx23 = cohAll(1:nPY,:);
        phaseCx23 = phaseAll(1:nPY,:);
        cohCx23i = cohAll((nPY+1):(nPY+nIN),:);
        phaseCx23i = phaseAll((nPY+1):(nPY+nIN),:);
        cohCx4 = cohAll((nPY+nIN):(2*nPY+nIN),:);
        phaseCx4 = phaseAll((nPY+nIN):(2*nPY+nIN),:);
        cohCx4i = cohAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        phaseCx4i = phaseAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        cohCx5 = cohAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        phaseCx5 = phaseAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        cohCx5i = cohAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        phaseCx5i = phaseAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        cohCx6 = cohAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        phaseCx6 = phaseAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        cohCx6i = cohAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        phaseCx6i = phaseAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        cohNRT = cohAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        phaseNRT = phaseAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        cohNRT2 = cohAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        phaseNRT2 = phaseAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        cohTC = cohAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        phaseTC = phaseAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        cohTC2 = cohAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        phaseTC2 = phaseAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
    end
    
    if xCorrelation
        xCorrCx23 = xCorrAll(1:nPY,:);
        xCorrCx23i = xCorrAll((nPY+1):(nPY+nIN),:);
        xCorrCx4 = xCorrAll((nPY+nIN):(2*nPY+nIN),:);
        xCorrCx4i = xCorrAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        xCorrCx5 = xCorrAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        xCorrCx5i = xCorrAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        xCorrCx6 = xCorrAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        xCorrCx6i = xCorrAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        xCorrNRT = xCorrAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        xCorrNRT2 = xCorrAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        xCorrTC = xCorrAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        xCorrTC2 = xCorrAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
    end
    
    if eegts
        eegtsCx23 = eegtsAll(1:nPY,:);
        eegtsCx23i = eegtsAll((nPY+1):(nPY+nIN),:);
        eegtsCx4 = eegtsAll((nPY+nIN):(2*nPY+nIN),:);
        eegtsCx4i = eegtsAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        eegtsCx5 = eegtsAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        eegtsCx5i = eegtsAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        eegtsCx6 = eegtsAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        eegtsCx6i = eegtsAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        eegtsNRT = eegtsAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        eegtsNRT2 = eegtsAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        eegtsTC = eegtsAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        eegtsTC2 = eegtsAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        if strcmpi(type, 'SWDs_human') || strcmpi(type, 'SWDs_rodent')
            eegtsInitCx23 = eegtsInitAll(1:nPY,:);
            eegtsInitCx23i = eegtsInitAll((nPY+1):(nPY+nIN),:);
            eegtsInitCx4 = eegtsInitAll((nPY+nIN):(2*nPY+nIN),:);
            eegtsInitCx4i = eegtsInitAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
            eegtsInitCx5 = eegtsInitAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
            eegtsInitCx5i = eegtsInitAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
            eegtsInitCx6 = eegtsInitAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
            eegtsInitCx6i = eegtsInitAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
            eegtsInitNRT = eegtsInitAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
            eegtsInitNRT2 = eegtsInitAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
            eegtsInitTC = eegtsInitAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
            eegtsInitTC2 = eegtsInitAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
            eegtsInitLargeCx23 = eegtsInitLargeAll(1:nPY,:);
            eegtsInitLargeCx23i = eegtsInitLargeAll((nPY+1):(nPY+nIN),:);
            eegtsInitLargeCx4 = eegtsInitLargeAll((nPY+nIN):(2*nPY+nIN),:);
            eegtsInitLargeCx4i = eegtsInitLargeAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
            eegtsInitLargeCx5 = eegtsInitLargeAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
            eegtsInitLargeCx5i = eegtsInitLargeAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
            eegtsInitLargeCx6 = eegtsInitLargeAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
            eegtsInitLargeCx6i = eegtsInitLargeAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
            eegtsInitLargeNRT = eegtsInitLargeAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
            eegtsInitLargeNRT2 = eegtsInitLargeAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
            eegtsInitLargeTC = eegtsInitLargeAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
            eegtsInitLargeTC2 = eegtsInitLargeAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
            eegtsFinalCx23 = eegtsFinalAll(1:nPY,:);
            eegtsFinalCx23i = eegtsFinalAll((nPY+1):(nPY+nIN),:);
            eegtsFinalCx4 = eegtsFinalAll((nPY+nIN):(2*nPY+nIN),:);
            eegtsFinalCx4i = eegtsFinalAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
            eegtsFinalCx5 = eegtsFinalAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
            eegtsFinalCx5i = eegtsFinalAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
            eegtsFinalCx6 = eegtsFinalAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
            eegtsFinalCx6i = eegtsFinalAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
            eegtsFinalNRT = eegtsFinalAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
            eegtsFinalNRT2 = eegtsFinalAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
            eegtsFinalTC = eegtsFinalAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
            eegtsFinalTC2 = eegtsFinalAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
            eegtsFinalLargeCx23 = eegtsFinalLargeAll(1:nPY,:);
            eegtsFinalLargeCx23i = eegtsFinalLargeAll((nPY+1):(nPY+nIN),:);
            eegtsFinalLargeCx4 = eegtsFinalLargeAll((nPY+nIN):(2*nPY+nIN),:);
            eegtsFinalLargeCx4i = eegtsFinalLargeAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
            eegtsFinalLargeCx5 = eegtsFinalLargeAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
            eegtsFinalLargeCx5i = eegtsFinalLargeAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
            eegtsFinalLargeCx6 = eegtsFinalLargeAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
            eegtsFinalLargeCx6i = eegtsFinalLargeAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
            eegtsFinalLargeNRT = eegtsFinalLargeAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
            eegtsFinalLargeNRT2 = eegtsFinalLargeAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
            eegtsFinalLargeTC = eegtsFinalLargeAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
            eegtsFinalLargeTC2 = eegtsFinalLargeAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        end
    end
    
    if eegsts
        eegstsCx23 = eegstsAll(1:nPY,:);
        eegstsCx23i = eegstsAll((nPY+1):(nPY+nIN),:);
        eegstsCx4 = eegstsAll((nPY+nIN):(2*nPY+nIN),:);
        eegstsCx4i = eegstsAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        eegstsCx5 = eegstsAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        eegstsCx5i = eegstsAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        eegstsCx6 = eegstsAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        eegstsCx6i = eegstsAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        eegstsNRT = eegstsAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        eegstsNRT2 = eegstsAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        eegstsTC = eegstsAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        eegstsTC2 = eegstsAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        if strcmpi(type, 'SWDs_human') || strcmpi(type, 'SWDs_rodent')
            eegstsInitCx23 = eegstsInitAll(1:nPY,:);
            eegstsInitCx23i = eegstsInitAll((nPY+1):(nPY+nIN),:);
            eegstsInitCx4 = eegstsInitAll((nPY+nIN):(2*nPY+nIN),:);
            eegstsInitCx4i = eegstsInitAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
            eegstsInitCx5 = eegstsInitAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
            eegstsInitCx5i = eegstsInitAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
            eegstsInitCx6 = eegstsInitAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
            eegstsInitCx6i = eegstsInitAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
            eegstsInitNRT = eegstsInitAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
            eegstsInitNRT2 = eegstsInitAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
            eegstsInitTC = eegstsInitAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
            eegstsInitTC2 = eegstsInitAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
            eegstsInitLargeCx23 = eegstsInitLargeAll(1:nPY,:);
            eegstsInitLargeCx23i = eegstsInitLargeAll((nPY+1):(nPY+nIN),:);
            eegstsInitLargeCx4 = eegstsInitLargeAll((nPY+nIN):(2*nPY+nIN),:);
            eegstsInitLargeCx4i = eegstsInitLargeAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
            eegstsInitLargeCx5 = eegstsInitLargeAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
            eegstsInitLargeCx5i = eegstsInitLargeAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
            eegstsInitLargeCx6 = eegstsInitLargeAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
            eegstsInitLargeCx6i = eegstsInitLargeAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
            eegstsInitLargeNRT = eegstsInitLargeAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
            eegstsInitLargeNRT2 = eegstsInitLargeAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
            eegstsInitLargeTC = eegstsInitLargeAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
            eegstsInitLargeTC2 = eegstsInitLargeAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
            eegstsFinalCx23 = eegstsFinalAll(1:nPY,:);
            eegstsFinalCx23i = eegstsFinalAll((nPY+1):(nPY+nIN),:);
            eegstsFinalCx4 = eegstsFinalAll((nPY+nIN):(2*nPY+nIN),:);
            eegstsFinalCx4i = eegstsFinalAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
            eegstsFinalCx5 = eegstsFinalAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
            eegstsFinalCx5i = eegstsFinalAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
            eegstsFinalCx6 = eegstsFinalAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
            eegstsFinalCx6i = eegstsFinalAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
            eegstsFinalNRT = eegstsFinalAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
            eegstsFinalNRT2 = eegstsFinalAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
            eegstsFinalTC = eegstsFinalAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
            eegstsFinalTC2 = eegstsFinalAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
            eegstsFinalLargeCx23 = eegstsFinalLargeAll(1:nPY,:);
            eegstsFinalLargeCx23i = eegstsFinalLargeAll((nPY+1):(nPY+nIN),:);
            eegstsFinalLargeCx4 = eegstsFinalLargeAll((nPY+nIN):(2*nPY+nIN),:);
            eegstsFinalLargeCx4i = eegstsFinalLargeAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
            eegstsFinalLargeCx5 = eegstsFinalLargeAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
            eegstsFinalLargeCx5i = eegstsFinalLargeAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
            eegstsFinalLargeCx6 = eegstsFinalLargeAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
            eegstsFinalLargeCx6i = eegstsFinalLargeAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
            eegstsFinalLargeNRT = eegstsFinalLargeAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
            eegstsFinalLargeNRT2 = eegstsFinalLargeAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
            eegstsFinalLargeTC = eegstsFinalLargeAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
            eegstsFinalLargeTC2 = eegstsFinalLargeAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        end
    end
    
    if vm
        vmCx23 = vmAll(1:nPY,:);
        vmCx23i = vmAll((nPY+1):(nPY+nIN),:);
        vmCx4 = vmAll((nPY+nIN):(2*nPY+nIN),:);
        vmCx4i = vmAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        vmCx5 = vmAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        vmCx5i = vmAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        vmCx6 = vmAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        vmCx6i = vmAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        vmNRT = vmAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        vmNRT2 = vmAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        vmTC = vmAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        vmTC2 = vmAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
    end
    
    if fr
        frCx23 = frAll(1:nPY,:);
        frCx23i = frAll((nPY+1):(nPY+nIN),:);
        frCx4 = frAll((nPY+nIN):(2*nPY+nIN),:);
        frCx4i = frAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        frCx5 = frAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        frCx5i = frAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        frCx6 = frAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        frCx6i = frAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        frNRT = frAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        frNRT2 = frAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        frTC = frAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        frTC2 = frAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        trCx23 = trAll(1:nPY,:);
        trCx23i = trAll((nPY+1):(nPY+nIN),:);
        trCx4 = trAll((nPY+nIN):(2*nPY+nIN),:);
        trCx4i = trAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        trCx5 = trAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        trCx5i = trAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        trCx6 = trAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        trCx6i = trAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        trNRT = trAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        trNRT2 = trAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        trTC = trAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        trTC2 = trAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        brCx23 = brAll(1:nPY,:);
        brCx23i = brAll((nPY+1):(nPY+nIN),:);
        brCx4 = brAll((nPY+nIN):(2*nPY+nIN),:);
        brCx4i = brAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        brCx5 = brAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        brCx5i = brAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        brCx6 = brAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        brCx6i = brAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        brNRT = brAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        brNRT2 = brAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        brTC = brAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        brTC2 = brAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        br2Cx23 = br2All(1:nPY,:);
        br2Cx23i = br2All((nPY+1):(nPY+nIN),:);
        br2Cx4 = br2All((nPY+nIN):(2*nPY+nIN),:);
        br2Cx4i = br2All((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        br2Cx5 = br2All((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        br2Cx5i = br2All((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        br2Cx6 = br2All((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        br2Cx6i = br2All((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        br2NRT = br2All((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        br2NRT2 = br2All((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        br2TC = br2All((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        br2TC2 = br2All((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        frFrCx23 = frFrAll(1:nPY,:);
        frFrCx23i = frFrAll((nPY+1):(nPY+nIN),:);
        frFrCx4 = frFrAll((nPY+nIN):(2*nPY+nIN),:);
        frFrCx4i = frFrAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        frFrCx5 = frFrAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        frFrCx5i = frFrAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        frFrCx6 = frFrAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        frFrCx6i = frFrAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        frFrNRT = frFrAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        frFrNRT2 = frFrAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        frFrTC = frFrAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        frFrTC2 = frFrAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        trFrCx23 = trFrAll(1:nPY,:);
        trFrCx23i = trFrAll((nPY+1):(nPY+nIN),:);
        trFrCx4 = trFrAll((nPY+nIN):(2*nPY+nIN),:);
        trFrCx4i = trFrAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        trFrCx5 = trFrAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        trFrCx5i = trFrAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        trFrCx6 = trFrAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        trFrCx6i = trFrAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        trFrNRT = trFrAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        trFrNRT2 = trFrAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        trFrTC = trFrAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        trFrTC2 = trFrAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        brFrCx23 = brFrAll(1:nPY,:);
        brFrCx23i = brFrAll((nPY+1):(nPY+nIN),:);
        brFrCx4 = brFrAll((nPY+nIN):(2*nPY+nIN),:);
        brFrCx4i = brFrAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        brFrCx5 = brFrAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        brFrCx5i = brFrAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        brFrCx6 = brFrAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        brFrCx6i = brFrAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        brFrNRT = brFrAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        brFrNRT2 = brFrAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        brFrTC = brFrAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        brFrTC2 = brFrAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        frFrLargeCx23 = frFrLargeAll(1:nPY,:);
        frFrLargeCx23i = frFrLargeAll((nPY+1):(nPY+nIN),:);
        frFrLargeCx4 = frFrLargeAll((nPY+nIN):(2*nPY+nIN),:);
        frFrLargeCx4i = frFrLargeAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        frFrLargeCx5 = frFrLargeAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        frFrLargeCx5i = frFrLargeAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        frFrLargeCx6 = frFrLargeAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        frFrLargeCx6i = frFrLargeAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        frFrLargeNRT = frFrLargeAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        frFrLargeNRT2 = frFrLargeAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        frFrLargeTC = frFrLargeAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        frFrLargeTC2 = frFrLargeAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        trFrLargeCx23 = trFrLargeAll(1:nPY,:);
        trFrLargeCx23i = trFrLargeAll((nPY+1):(nPY+nIN),:);
        trFrLargeCx4 = trFrLargeAll((nPY+nIN):(2*nPY+nIN),:);
        trFrLargeCx4i = trFrLargeAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        trFrLargeCx5 = trFrLargeAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        trFrLargeCx5i = trFrLargeAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        trFrLargeCx6 = trFrLargeAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        trFrLargeCx6i = trFrLargeAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        trFrLargeNRT = trFrLargeAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        trFrLargeNRT2 = trFrLargeAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        trFrLargeTC = trFrLargeAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        trFrLargeTC2 = trFrLargeAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        brFrLargeCx23 = brFrLargeAll(1:nPY,:);
        brFrLargeCx23i = brFrLargeAll((nPY+1):(nPY+nIN),:);
        brFrLargeCx4 = brFrLargeAll((nPY+nIN):(2*nPY+nIN),:);
        brFrLargeCx4i = brFrLargeAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        brFrLargeCx5 = brFrLargeAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        brFrLargeCx5i = brFrLargeAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        brFrLargeCx6 = brFrLargeAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        brFrLargeCx6i = brFrLargeAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        brFrLargeNRT = brFrLargeAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        brFrLargeNRT2 = brFrLargeAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        brFrLargeTC = brFrLargeAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        brFrLargeTC2 = brFrLargeAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
    end
    
    if psi
        psiCx23 = psiAll(1:nPY,:);
        psiCx23i = psiAll((nPY+1):(nPY+nIN),:);
        psiCx4 = psiAll((nPY+nIN):(2*nPY+nIN),:);
        psiCx4i = psiAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        psiCx5 = psiAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        psiCx5i = psiAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        psiCx6 = psiAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        psiCx6i = psiAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        psiNRT = psiAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        psiNRT2 = psiAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        psiTC = psiAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        psiTC2 = psiAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        psiCx23_t = psiAll_t(1:nPY,:);
        psiCx23i_t = psiAll_t((nPY+1):(nPY+nIN),:);
        psiCx4_t = psiAll_t((nPY+nIN):(2*nPY+nIN),:);
        psiCx4i_t = psiAll_t((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        psiCx5_t = psiAll_t((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        psiCx5i_t = psiAll_t((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        psiCx6_t = psiAll_t((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        psiCx6i_t = psiAll_t((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        psiNRT_t = psiAll_t((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        psiNRT2_t = psiAll_t((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        psiTC_t = psiAll_t((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        psiTC2_t = psiAll_t((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        phaseDiffCx23 = phaseDiffAll(1:nPY,:);
        phaseDiffCx23i = phaseDiffAll((nPY+1):(nPY+nIN),:);
        phaseDiffCx4 = phaseDiffAll((nPY+nIN):(2*nPY+nIN),:);
        phaseDiffCx4i = phaseDiffAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        phaseDiffCx5 = phaseDiffAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        phaseDiffCx5i = phaseDiffAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        phaseDiffCx6 = phaseDiffAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        phaseDiffCx6i = phaseDiffAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        phaseDiffNRT = phaseDiffAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        phaseDiffNRT2 = phaseDiffAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        phaseDiffTC = phaseDiffAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        phaseDiffTC2 = phaseDiffAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        psiRasterCx23 = psiRasterAll(1:nPY,:);
        psiRasterCx23i = psiRasterAll((nPY+1):(nPY+nIN),:);
        psiRasterCx4 = psiRasterAll((nPY+nIN):(2*nPY+nIN),:);
        psiRasterCx4i = psiRasterAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        psiRasterCx5 = psiRasterAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        psiRasterCx5i = psiRasterAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        psiRasterCx6 = psiRasterAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        psiRasterCx6i = psiRasterAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        psiRasterNRT = psiRasterAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        psiRasterNRT2 = psiRasterAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        psiRasterTC = psiRasterAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        psiRasterTC2 = psiRasterAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        psiRasterCx23_t = psiRasterAll_t(1:nPY,:);
        psiRasterCx23i_t = psiRasterAll_t((nPY+1):(nPY+nIN),:);
        psiRasterCx4_t = psiRasterAll_t((nPY+nIN):(2*nPY+nIN),:);
        psiRasterCx4i_t = psiRasterAll_t((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        psiRasterCx5_t = psiRasterAll_t((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        psiRasterCx5i_t = psiRasterAll_t((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        psiRasterCx6_t = psiRasterAll_t((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        psiRasterCx6i_t = psiRasterAll_t((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        psiRasterNRT_t = psiRasterAll_t((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        psiRasterNRT2_t = psiRasterAll_t((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        psiRasterTC_t = psiRasterAll_t((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        psiRasterTC2_t = psiRasterAll_t((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
        
        phaseDiffRasterCx23 = phaseDiffRasterAll(1:nPY,:);
        phaseDiffRasterCx23i = phaseDiffRasterAll((nPY+1):(nPY+nIN),:);
        phaseDiffRasterCx4 = phaseDiffRasterAll((nPY+nIN):(2*nPY+nIN),:);
        phaseDiffRasterCx4i = phaseDiffRasterAll((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        phaseDiffRasterCx5 = phaseDiffRasterAll((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        phaseDiffRasterCx5i = phaseDiffRasterAll((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        phaseDiffRasterCx6 = phaseDiffRasterAll((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        phaseDiffRasterCx6i = phaseDiffRasterAll((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        phaseDiffRasterNRT = phaseDiffRasterAll((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        phaseDiffRasterNRT2 = phaseDiffRasterAll((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        phaseDiffRasterTC = phaseDiffRasterAll((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        phaseDiffRasterTC2 = phaseDiffRasterAll((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);

        phaseDiffRasterCx23Initial = phaseDiffRasterAllInitial(1:nPY,:);
        phaseDiffRasterCx23iInitial = phaseDiffRasterAllInitial((nPY+1):(nPY+nIN),:);
        phaseDiffRasterCx4Initial = phaseDiffRasterAllInitial((nPY+nIN):(2*nPY+nIN),:);
        phaseDiffRasterCx4iInitial = phaseDiffRasterAllInitial((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        phaseDiffRasterCx5Initial = phaseDiffRasterAllInitial((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        phaseDiffRasterCx5iInitial = phaseDiffRasterAllInitial((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        phaseDiffRasterCx6Initial = phaseDiffRasterAllInitial((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        phaseDiffRasterCx6iInitial = phaseDiffRasterAllInitial((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        phaseDiffRasterNRTInitial = phaseDiffRasterAllInitial((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        phaseDiffRasterNRT2Initial = phaseDiffRasterAllInitial((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        phaseDiffRasterTCInitial = phaseDiffRasterAllInitial((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        phaseDiffRasterTC2Initial = phaseDiffRasterAllInitial((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);

        phaseDiffRasterCx23Final = phaseDiffRasterAllFinal(1:nPY,:);
        phaseDiffRasterCx23iFinal = phaseDiffRasterAllFinal((nPY+1):(nPY+nIN),:);
        phaseDiffRasterCx4Final = phaseDiffRasterAllFinal((nPY+nIN):(2*nPY+nIN),:);
        phaseDiffRasterCx4iFinal = phaseDiffRasterAllFinal((2*nPY+nIN+1):(2*nPY+2*nIN),:);
        phaseDiffRasterCx5Final = phaseDiffRasterAllFinal((2*nPY+2*nIN+1):(3*nPY+2*nIN),:);
        phaseDiffRasterCx5iFinal = phaseDiffRasterAllFinal((3*nPY+2*nIN+1):(3*nPY+3*nIN),:);
        phaseDiffRasterCx6Final = phaseDiffRasterAllFinal((3*nPY+3*nIN+1):(4*nPY+3*nIN),:);
        phaseDiffRasterCx6iFinal = phaseDiffRasterAllFinal((4*nPY+3*nIN+1):(4*nPY+4*nIN),:);
        phaseDiffRasterNRTFinal = phaseDiffRasterAllFinal((4*nPY+4*nIN+1):(4*nPY+4*nIN+nNRT),:);
        phaseDiffRasterNRT2Final = phaseDiffRasterAllFinal((4*nPY+4*nIN+nNRT+1):(4*nPY+4*nIN+2*nNRT),:);
        phaseDiffRasterTCFinal = phaseDiffRasterAllFinal((4*nPY+4*nIN+2*nNRT+1):(4*nPY+4*nIN+2*nNRT+nTC),:);
        phaseDiffRasterTC2Final = phaseDiffRasterAllFinal((4*nPY+4*nIN+2*nNRT+nTC+1):(4*nPY+4*nIN+2*nNRT+2*nTC),:);
    end
    
    % Means
    if coherence
        [cohCx23mean, cohCx23CI95, phaseCx23mean, phaseCx23CI95] = phaseCohMean(cohCx23, phaseCx23);
        [cohCx23imean, cohCx23iCI95, phaseCx23imean, phaseCx23iCI95] = phaseCohMean(cohCx23i, phaseCx23i);
        [cohCx4mean, cohCx4CI95, phaseCx4mean, phaseCx4CI95] = phaseCohMean(cohCx4, phaseCx4);
        [cohCx4imean, cohCx4iCI95, phaseCx4imean, phaseCx4iCI95] = phaseCohMean(cohCx4i, phaseCx4i);
        [cohCx5mean, cohCx5CI95, phaseCx5mean, phaseCx5CI95] = phaseCohMean(cohCx5, phaseCx5);
        [cohCx5imean, cohCx5iCI95, phaseCx5imean, phaseCx5iCI95] = phaseCohMean(cohCx5i, phaseCx5i);
        [cohCx6mean, cohCx6CI95, phaseCx6mean, phaseCx6CI95] = phaseCohMean(cohCx6, phaseCx6);
        [cohCx6imean, cohCx6iCI95, phaseCx6imean, phaseCx6iCI95] = phaseCohMean(cohCx6i, phaseCx6i);
        [cohNRTmean, cohNRTCI95, phaseNRTmean, phaseNRTCI95] = phaseCohMean(cohNRT, phaseNRT);
        [cohNRT2mean, cohNRT2CI95, phaseNRT2mean, phaseNRT2CI95] = phaseCohMean(cohNRT2, phaseNRT2);
        [cohTCmean, cohTCCI95, phaseTCmean, phaseTCCI95] = phaseCohMean(cohTC, phaseTC);
        [cohTC2mean, cohTC2CI95, phaseTC2mean, phaseTC2CI95] = phaseCohMean(cohTC2, phaseTC2);
        [cohAllmean, cohAllCI95, phaseAllmean, phaseAllCI95] = phaseCohMean(cohAll, phaseAll);
    end
    
    if xCorrelation
        [xCorrCx23mean, xCorrCx23CI95] = datamean(xCorrCx23);
        [xCorrCx23imean, xCorrCx23iCI95] = datamean(xCorrCx23i);
        [xCorrCx4mean, xCorrCx4CI95] = datamean(xCorrCx4);
        [xCorrCx4imean, xCorrCx4iCI95] = datamean(xCorrCx4i);
        [xCorrCx5mean, xCorrCx5CI95] = datamean(xCorrCx5);
        [xCorrCx5imean, xCorrCx5iCI95] = datamean(xCorrCx5i);
        [xCorrCx6mean, xCorrCx6CI95] = datamean(xCorrCx6);
        [xCorrCx6imean, xCorrCx6iCI95] = datamean(xCorrCx6i);
        [xCorrNRTmean, xCorrNRTCI95] = datamean(xCorrNRT);
        [xCorrNRT2mean, xCorrNRT2CI95] = datamean(xCorrNRT2);
        [xCorrTCmean, xCorrTCCI95] = datamean(xCorrTC);
        [xCorrTC2mean, xCorrTC2CI95] = datamean(xCorrTC2);
        [xCorrAllmean, xCorrAllCI95] = datamean(xCorrAll);
    end
    
    if eegts
        [eegtsCx23mean, eegtsCx23CI95] = datamean(eegtsCx23);
        [eegtsCx23imean, eegtsCx23iCI95] = datamean(eegtsCx23i);
        [eegtsCx4mean, eegtsCx4CI95] = datamean(eegtsCx4);
        [eegtsCx4imean, eegtsCx4iCI95] = datamean(eegtsCx4i);
        [eegtsCx5mean, eegtsCx5CI95] = datamean(eegtsCx5);
        [eegtsCx5imean, eegtsCx5iCI95] = datamean(eegtsCx5i);
        [eegtsCx6mean, eegtsCx6CI95] = datamean(eegtsCx6);
        [eegtsCx6imean, eegtsCx6iCI95] = datamean(eegtsCx6i);
        [eegtsNRTmean, eegtsNRTCI95] = datamean(eegtsNRT);
        [eegtsNRT2mean, eegtsNRT2CI95] = datamean(eegtsNRT2);
        [eegtsTCmean, eegtsTCCI95] = datamean(eegtsTC);
        [eegtsTC2mean, eegtsTC2CI95] = datamean(eegtsTC2);
        [eegtsAllmean, eegtsAllCI95] = datamean(eegtsAll);
        if strcmpi(type, 'SWDs_human') || strcmpi(type, 'SWDs_rodent')
            [eegtsInitCx23mean, eegtsInitCx23CI95] = datamean(eegtsInitCx23);
            [eegtsInitCx23imean, eegtsInitCx23iCI95] = datamean(eegtsInitCx23i);
            [eegtsInitCx4mean, eegtsInitCx4CI95] = datamean(eegtsInitCx4);
            [eegtsInitCx4imean, eegtsInitCx4iCI95] = datamean(eegtsInitCx4i);
            [eegtsInitCx5mean, eegtsInitCx5CI95] = datamean(eegtsInitCx5);
            [eegtsInitCx5imean, eegtsInitCx5iCI95] = datamean(eegtsInitCx5i);
            [eegtsInitCx6mean, eegtsInitCx6CI95] = datamean(eegtsInitCx6);
            [eegtsInitCx6imean, eegtsInitCx6iCI95] = datamean(eegtsInitCx6i);
            [eegtsInitNRTmean, eegtsInitNRTCI95] = datamean(eegtsInitNRT);
            [eegtsInitNRT2mean, eegtsInitNRT2CI95] = datamean(eegtsInitNRT2);
            [eegtsInitTCmean, eegtsInitTCCI95] = datamean(eegtsInitTC);
            [eegtsInitTC2mean, eegtsInitTC2CI95] = datamean(eegtsInitTC2);
            [eegtsInitAllmean, eegtsInitAllCI95] = datamean(eegtsInitAll);
            [eegtsInitLargeCx23mean, eegtsInitLargeCx23CI95] = datamean(eegtsInitLargeCx23);
            [eegtsInitLargeCx23imean, eegtsInitLargeCx23iCI95] = datamean(eegtsInitLargeCx23i);
            [eegtsInitLargeCx4mean, eegtsInitLargeCx4CI95] = datamean(eegtsInitLargeCx4);
            [eegtsInitLargeCx4imean, eegtsInitLargeCx4iCI95] = datamean(eegtsInitLargeCx4i);
            [eegtsInitLargeCx5mean, eegtsInitLargeCx5CI95] = datamean(eegtsInitLargeCx5);
            [eegtsInitLargeCx5imean, eegtsInitLargeCx5iCI95] = datamean(eegtsInitLargeCx5i);
            [eegtsInitLargeCx6mean, eegtsInitLargeCx6CI95] = datamean(eegtsInitLargeCx6);
            [eegtsInitLargeCx6imean, eegtsInitLargeCx6iCI95] = datamean(eegtsInitLargeCx6i);
            [eegtsInitLargeNRTmean, eegtsInitLargeNRTCI95] = datamean(eegtsInitLargeNRT);
            [eegtsInitLargeNRT2mean, eegtsInitLargeNRT2CI95] = datamean(eegtsInitLargeNRT2);
            [eegtsInitLargeTCmean, eegtsInitLargeTCCI95] = datamean(eegtsInitLargeTC);
            [eegtsInitLargeTC2mean, eegtsInitLargeTC2CI95] = datamean(eegtsInitLargeTC2);
            [eegtsInitLargeAllmean, eegtsInitLargeAllCI95] = datamean(eegtsInitLargeAll);
            [eegtsFinalCx23mean, eegtsFinalCx23CI95] = datamean(eegtsFinalCx23);
            [eegtsFinalCx23imean, eegtsFinalCx23iCI95] = datamean(eegtsFinalCx23i);
            [eegtsFinalCx4mean, eegtsFinalCx4CI95] = datamean(eegtsFinalCx4);
            [eegtsFinalCx4imean, eegtsFinalCx4iCI95] = datamean(eegtsFinalCx4i);
            [eegtsFinalCx5mean, eegtsFinalCx5CI95] = datamean(eegtsFinalCx5);
            [eegtsFinalCx5imean, eegtsFinalCx5iCI95] = datamean(eegtsFinalCx5i);
            [eegtsFinalCx6mean, eegtsFinalCx6CI95] = datamean(eegtsFinalCx6);
            [eegtsFinalCx6imean, eegtsFinalCx6iCI95] = datamean(eegtsFinalCx6i);
            [eegtsFinalNRTmean, eegtsFinalNRTCI95] = datamean(eegtsFinalNRT);
            [eegtsFinalNRT2mean, eegtsFinalNRT2CI95] = datamean(eegtsFinalNRT2);
            [eegtsFinalTCmean, eegtsFinalTCCI95] = datamean(eegtsFinalTC);
            [eegtsFinalTC2mean, eegtsFinalTC2CI95] = datamean(eegtsFinalTC2);
            [eegtsFinalAllmean, eegtsFinalAllCI95] = datamean(eegtsFinalAll);
            [eegtsFinalLargeCx23mean, eegtsFinalLargeCx23CI95] = datamean(eegtsFinalLargeCx23);
            [eegtsFinalLargeCx23imean, eegtsFinalLargeCx23iCI95] = datamean(eegtsFinalLargeCx23i);
            [eegtsFinalLargeCx4mean, eegtsFinalLargeCx4CI95] = datamean(eegtsFinalLargeCx4);
            [eegtsFinalLargeCx4imean, eegtsFinalLargeCx4iCI95] = datamean(eegtsFinalLargeCx4i);
            [eegtsFinalLargeCx5mean, eegtsFinalLargeCx5CI95] = datamean(eegtsFinalLargeCx5);
            [eegtsFinalLargeCx5imean, eegtsFinalLargeCx5iCI95] = datamean(eegtsFinalLargeCx5i);
            [eegtsFinalLargeCx6mean, eegtsFinalLargeCx6CI95] = datamean(eegtsFinalLargeCx6);
            [eegtsFinalLargeCx6imean, eegtsFinalLargeCx6iCI95] = datamean(eegtsFinalLargeCx6i);
            [eegtsFinalLargeNRTmean, eegtsFinalLargeNRTCI95] = datamean(eegtsFinalLargeNRT);
            [eegtsFinalLargeNRT2mean, eegtsFinalLargeNRT2CI95] = datamean(eegtsFinalLargeNRT2);
            [eegtsFinalLargeTCmean, eegtsFinalLargeTCCI95] = datamean(eegtsFinalLargeTC);
            [eegtsFinalLargeTC2mean, eegtsFinalLargeTC2CI95] = datamean(eegtsFinalLargeTC2);
            [eegtsFinalLargeAllmean, eegtsFinalLargeAllCI95] = datamean(eegtsFinalLargeAll);
        end
    end
    
    if eegsts
        [eegstsCx23mean, eegstsCx23CI95] = datamean(eegstsCx23);
        [eegstsCx23imean, eegstsCx23iCI95] = datamean(eegstsCx23i);
        [eegstsCx4mean, eegstsCx4CI95] = datamean(eegstsCx4);
        [eegstsCx4imean, eegstsCx4iCI95] = datamean(eegstsCx4i);
        [eegstsCx5mean, eegstsCx5CI95] = datamean(eegstsCx5);
        [eegstsCx5imean, eegstsCx5iCI95] = datamean(eegstsCx5i);
        [eegstsCx6mean, eegstsCx6CI95] = datamean(eegstsCx6);
        [eegstsCx6imean, eegstsCx6iCI95] = datamean(eegstsCx6i);
        [eegstsNRTmean, eegstsNRTCI95] = datamean(eegstsNRT);
        [eegstsNRT2mean, eegstsNRT2CI95] = datamean(eegstsNRT2);
        [eegstsTCmean, eegstsTCCI95] = datamean(eegstsTC);
        [eegstsTC2mean, eegstsTC2CI95] = datamean(eegstsTC2);
        [eegstsAllmean, eegstsAllCI95] = datamean(eegstsAll);
        if strcmpi(type, 'SWDs_human') || strcmpi(type, 'SWDs_rodent')
            [eegstsInitCx23mean, eegstsInitCx23CI95] = datamean(eegstsInitCx23);
            [eegstsInitCx23imean, eegstsInitCx23iCI95] = datamean(eegstsInitCx23i);
            [eegstsInitCx4mean, eegstsInitCx4CI95] = datamean(eegstsInitCx4);
            [eegstsInitCx4imean, eegstsInitCx4iCI95] = datamean(eegstsInitCx4i);
            [eegstsInitCx5mean, eegstsInitCx5CI95] = datamean(eegstsInitCx5);
            [eegstsInitCx5imean, eegstsInitCx5iCI95] = datamean(eegstsInitCx5i);
            [eegstsInitCx6mean, eegstsInitCx6CI95] = datamean(eegstsInitCx6);
            [eegstsInitCx6imean, eegstsInitCx6iCI95] = datamean(eegstsInitCx6i);
            [eegstsInitNRTmean, eegstsInitNRTCI95] = datamean(eegstsInitNRT);
            [eegstsInitNRT2mean, eegstsInitNRT2CI95] = datamean(eegstsInitNRT2);
            [eegstsInitTCmean, eegstsInitTCCI95] = datamean(eegstsInitTC);
            [eegstsInitTC2mean, eegstsInitTC2CI95] = datamean(eegstsInitTC2);
            [eegstsInitAllmean, eegstsInitAllCI95] = datamean(eegstsInitAll);
            [eegstsInitLargeCx23mean, eegstsInitLargeCx23CI95] = datamean(eegstsInitLargeCx23);
            [eegstsInitLargeCx23imean, eegstsInitLargeCx23iCI95] = datamean(eegstsInitLargeCx23i);
            [eegstsInitLargeCx4mean, eegstsInitLargeCx4CI95] = datamean(eegstsInitLargeCx4);
            [eegstsInitLargeCx4imean, eegstsInitLargeCx4iCI95] = datamean(eegstsInitLargeCx4i);
            [eegstsInitLargeCx5mean, eegstsInitLargeCx5CI95] = datamean(eegstsInitLargeCx5);
            [eegstsInitLargeCx5imean, eegstsInitLargeCx5iCI95] = datamean(eegstsInitLargeCx5i);
            [eegstsInitLargeCx6mean, eegstsInitLargeCx6CI95] = datamean(eegstsInitLargeCx6);
            [eegstsInitLargeCx6imean, eegstsInitLargeCx6iCI95] = datamean(eegstsInitLargeCx6i);
            [eegstsInitLargeNRTmean, eegstsInitLargeNRTCI95] = datamean(eegstsInitLargeNRT);
            [eegstsInitLargeNRT2mean, eegstsInitLargeNRT2CI95] = datamean(eegstsInitLargeNRT2);
            [eegstsInitLargeTCmean, eegstsInitLargeTCCI95] = datamean(eegstsInitLargeTC);
            [eegstsInitLargeTC2mean, eegstsInitLargeTC2CI95] = datamean(eegstsInitLargeTC2);
            [eegstsInitLargeAllmean, eegstsInitLargeAllCI95] = datamean(eegstsInitLargeAll);
            [eegstsFinalCx23mean, eegstsFinalCx23CI95] = datamean(eegstsFinalCx23);
            [eegstsFinalCx23imean, eegstsFinalCx23iCI95] = datamean(eegstsFinalCx23i);
            [eegstsFinalCx4mean, eegstsFinalCx4CI95] = datamean(eegstsFinalCx4);
            [eegstsFinalCx4imean, eegstsFinalCx4iCI95] = datamean(eegstsFinalCx4i);
            [eegstsFinalCx5mean, eegstsFinalCx5CI95] = datamean(eegstsFinalCx5);
            [eegstsFinalCx5imean, eegstsFinalCx5iCI95] = datamean(eegstsFinalCx5i);
            [eegstsFinalCx6mean, eegstsFinalCx6CI95] = datamean(eegstsFinalCx6);
            [eegstsFinalCx6imean, eegstsFinalCx6iCI95] = datamean(eegstsFinalCx6i);
            [eegstsFinalNRTmean, eegstsFinalNRTCI95] = datamean(eegstsFinalNRT);
            [eegstsFinalNRT2mean, eegstsFinalNRT2CI95] = datamean(eegstsFinalNRT2);
            [eegstsFinalTCmean, eegstsFinalTCCI95] = datamean(eegstsFinalTC);
            [eegstsFinalTC2mean, eegstsFinalTC2CI95] = datamean(eegstsFinalTC2);
            [eegstsFinalAllmean, eegstsFinalAllCI95] = datamean(eegstsFinalAll);
            [eegstsFinalLargeCx23mean, eegstsFinalLargeCx23CI95] = datamean(eegstsFinalLargeCx23);
            [eegstsFinalLargeCx23imean, eegstsFinalLargeCx23iCI95] = datamean(eegstsFinalLargeCx23i);
            [eegstsFinalLargeCx4mean, eegstsFinalLargeCx4CI95] = datamean(eegstsFinalLargeCx4);
            [eegstsFinalLargeCx4imean, eegstsFinalLargeCx4iCI95] = datamean(eegstsFinalLargeCx4i);
            [eegstsFinalLargeCx5mean, eegstsFinalLargeCx5CI95] = datamean(eegstsFinalLargeCx5);
            [eegstsFinalLargeCx5imean, eegstsFinalLargeCx5iCI95] = datamean(eegstsFinalLargeCx5i);
            [eegstsFinalLargeCx6mean, eegstsFinalLargeCx6CI95] = datamean(eegstsFinalLargeCx6);
            [eegstsFinalLargeCx6imean, eegstsFinalLargeCx6iCI95] = datamean(eegstsFinalLargeCx6i);
            [eegstsFinalLargeNRTmean, eegstsFinalLargeNRTCI95] = datamean(eegstsFinalLargeNRT);
            [eegstsFinalLargeNRT2mean, eegstsFinalLargeNRT2CI95] = datamean(eegstsFinalLargeNRT2);
            [eegstsFinalLargeTCmean, eegstsFinalLargeTCCI95] = datamean(eegstsFinalLargeTC);
            [eegstsFinalLargeTC2mean, eegstsFinalLargeTC2CI95] = datamean(eegstsFinalLargeTC2);
            [eegstsFinalLargeAllmean, eegstsFinalLargeAllCI95] = datamean(eegstsFinalLargeAll);
        end
    end
    
    if vm
        [vmCx23mean, vmCx23CI95] = datamean(vmCx23);
        [vmCx23imean, vmCx23iCI95] = datamean(vmCx23i);
        [vmCx4mean, vmCx4CI95] = datamean(vmCx4);
        [vmCx4imean, vmCx4iCI95] = datamean(vmCx4i);
        [vmCx5mean, vmCx5CI95] = datamean(vmCx5);
        [vmCx5imean, vmCx5iCI95] = datamean(vmCx5i);
        [vmCx6mean, vmCx6CI95] = datamean(vmCx6);
        [vmCx6imean, vmCx6iCI95] = datamean(vmCx6i);
        [vmNRTmean, vmNRTCI95] = datamean(vmNRT);
        [vmNRT2mean, vmNRT2CI95] = datamean(vmNRT2);
        [vmTCmean, vmTCCI95] = datamean(vmTC);
        [vmTC2mean, vmTC2CI95] = datamean(vmTC2);
        [vmAllmean, vmAllCI95] = datamean(vmAll);
    end
    
    if fr
        [frCx23mean, frCx23CI95] = datamean(frCx23);
        [frCx23imean, frCx23iCI95] = datamean(frCx23i);
        [frCx4mean, frCx4CI95] = datamean(frCx4);
        [frCx4imean, frCx4iCI95] = datamean(frCx4i);
        [frCx5mean, frCx5CI95] = datamean(frCx5);
        [frCx5imean, frCx5iCI95] = datamean(frCx5i);
        [frCx6mean, frCx6CI95] = datamean(frCx6);
        [frCx6imean, frCx6iCI95] = datamean(frCx6i);
        [frNRTmean, frNRTCI95] = datamean(frNRT);
        [frNRT2mean, frNRT2CI95] = datamean(frNRT2);
        [frTCmean, frTCCI95] = datamean(frTC);
        [frTC2mean, frTC2CI95] = datamean(frTC2);
        [frAllmean, frAllCI95] = datamean(frAll);
        
        [trCx23mean, trCx23CI95] = datamean(trCx23);
        [trCx23imean, trCx23iCI95] = datamean(trCx23i);
        [trCx4mean, trCx4CI95] = datamean(trCx4);
        [trCx4imean, trCx4iCI95] = datamean(trCx4i);
        [trCx5mean, trCx5CI95] = datamean(trCx5);
        [trCx5imean, trCx5iCI95] = datamean(trCx5i);
        [trCx6mean, trCx6CI95] = datamean(trCx6);
        [trCx6imean, trCx6iCI95] = datamean(trCx6i);
        [trNRTmean, trNRTCI95] = datamean(trNRT);
        [trNRT2mean, trNRT2CI95] = datamean(trNRT2);
        [trTCmean, trTCCI95] = datamean(trTC);
        [trTC2mean, trTC2CI95] = datamean(trTC2);
        [trAllmean, trAllCI95] = datamean(trAll);
        
        [brCx23mean, brCx23CI95] = datamean(brCx23);
        [brCx23imean, brCx23iCI95] = datamean(brCx23i);
        [brCx4mean, brCx4CI95] = datamean(brCx4);
        [brCx4imean, brCx4iCI95] = datamean(brCx4i);
        [brCx5mean, brCx5CI95] = datamean(brCx5);
        [brCx5imean, brCx5iCI95] = datamean(brCx5i);
        [brCx6mean, brCx6CI95] = datamean(brCx6);
        [brCx6imean, brCx6iCI95] = datamean(brCx6i);
        [brNRTmean, brNRTCI95] = datamean(brNRT);
        [brNRT2mean, brNRT2CI95] = datamean(brNRT2);
        [brTCmean, brTCCI95] = datamean(brTC);
        [brTC2mean, brTC2CI95] = datamean(brTC2);
        [brAllmean, brAllCI95] = datamean(brAll);
        
        [br2Cx23mean, br2Cx23CI95] = datamean(br2Cx23);
        [br2Cx23imean, br2Cx23iCI95] = datamean(br2Cx23i);
        [br2Cx4mean, br2Cx4CI95] = datamean(br2Cx4);
        [br2Cx4imean, br2Cx4iCI95] = datamean(br2Cx4i);
        [br2Cx5mean, br2Cx5CI95] = datamean(br2Cx5);
        [br2Cx5imean, br2Cx5iCI95] = datamean(br2Cx5i);
        [br2Cx6mean, br2Cx6CI95] = datamean(br2Cx6);
        [br2Cx6imean, br2Cx6iCI95] = datamean(br2Cx6i);
        [br2NRTmean, br2NRTCI95] = datamean(br2NRT);
        [br2NRT2mean, br2NRT2CI95] = datamean(br2NRT2);
        [br2TCmean, br2TCCI95] = datamean(br2TC);
        [br2TC2mean, br2TC2CI95] = datamean(br2TC2);
        [br2Allmean, br2AllCI95] = datamean(br2All);
        
        [frFrCx23mean, frFrCx23CI95] = datamean(frFrCx23);
        [frFrCx23imean, frFrCx23iCI95] = datamean(frFrCx23i);
        [frFrCx4mean, frFrCx4CI95] = datamean(frFrCx4);
        [frFrCx4imean, frFrCx4iCI95] = datamean(frFrCx4i);
        [frFrCx5mean, frFrCx5CI95] = datamean(frFrCx5);
        [frFrCx5imean, frFrCx5iCI95] = datamean(frFrCx5i);
        [frFrCx6mean, frFrCx6CI95] = datamean(frFrCx6);
        [frFrCx6imean, frFrCx6iCI95] = datamean(frFrCx6i);
        [frFrNRTmean, frFrNRTCI95] = datamean(frFrNRT);
        [frFrNRT2mean, frFrNRT2CI95] = datamean(frFrNRT2);
        [frFrTCmean, frFrTCCI95] = datamean(frFrTC);
        [frFrTC2mean, frFrTC2CI95] = datamean(frFrTC2);
        [frFrAllmean, frFrAllCI95] = datamean(frFrAll);
        
        [trFrCx23mean, trFrCx23CI95] = datamean(trFrCx23);
        [trFrCx23imean, trFrCx23iCI95] = datamean(trFrCx23i);
        [trFrCx4mean, trFrCx4CI95] = datamean(trFrCx4);
        [trFrCx4imean, trFrCx4iCI95] = datamean(trFrCx4i);
        [trFrCx5mean, trFrCx5CI95] = datamean(trFrCx5);
        [trFrCx5imean, trFrCx5iCI95] = datamean(trFrCx5i);
        [trFrCx6mean, trFrCx6CI95] = datamean(trFrCx6);
        [trFrCx6imean, trFrCx6iCI95] = datamean(trFrCx6i);
        [trFrNRTmean, trFrNRTCI95] = datamean(trFrNRT);
        [trFrNRT2mean, trFrNRT2CI95] = datamean(trFrNRT2);
        [trFrTCmean, trFrTCCI95] = datamean(trFrTC);
        [trFrTC2mean, trFrTC2CI95] = datamean(trFrTC2);
        [trFrAllmean, trFrAllCI95] = datamean(trFrAll);
        
        [brFrCx23mean, brFrCx23CI95] = datamean(brFrCx23);
        [brFrCx23imean, brFrCx23iCI95] = datamean(brFrCx23i);
        [brFrCx4mean, brFrCx4CI95] = datamean(brFrCx4);
        [brFrCx4imean, brFrCx4iCI95] = datamean(brFrCx4i);
        [brFrCx5mean, brFrCx5CI95] = datamean(brFrCx5);
        [brFrCx5imean, brFrCx5iCI95] = datamean(brFrCx5i);
        [brFrCx6mean, brFrCx6CI95] = datamean(brFrCx6);
        [brFrCx6imean, brFrCx6iCI95] = datamean(brFrCx6i);
        [brFrNRTmean, brFrNRTCI95] = datamean(brFrNRT);
        [brFrNRT2mean, brFrNRT2CI95] = datamean(brFrNRT2);
        [brFrTCmean, brFrTCCI95] = datamean(brFrTC);
        [brFrTC2mean, brFrTC2CI95] = datamean(brFrTC2);
        [brFrAllmean, brFrAllCI95] = datamean(brFrAll);
        
        [frFrLargeCx23mean, frFrLargeCx23CI95] = datamean(frFrLargeCx23);
        [frFrLargeCx23imean, frFrLargeCx23iCI95] = datamean(frFrLargeCx23i);
        [frFrLargeCx4mean, frFrLargeCx4CI95] = datamean(frFrLargeCx4);
        [frFrLargeCx4imean, frFrLargeCx4iCI95] = datamean(frFrLargeCx4i);
        [frFrLargeCx5mean, frFrLargeCx5CI95] = datamean(frFrLargeCx5);
        [frFrLargeCx5imean, frFrLargeCx5iCI95] = datamean(frFrLargeCx5i);
        [frFrLargeCx6mean, frFrLargeCx6CI95] = datamean(frFrLargeCx6);
        [frFrLargeCx6imean, frFrLargeCx6iCI95] = datamean(frFrLargeCx6i);
        [frFrLargeNRTmean, frFrLargeNRTCI95] = datamean(frFrLargeNRT);
        [frFrLargeNRT2mean, frFrLargeNRT2CI95] = datamean(frFrLargeNRT2);
        [frFrLargeTCmean, frFrLargeTCCI95] = datamean(frFrLargeTC);
        [frFrLargeTC2mean, frFrLargeTC2CI95] = datamean(frFrLargeTC2);
        [frFrLargeAllmean, frFrLargeAllCI95] = datamean(frFrLargeAll);
        
        [trFrLargeCx23mean, trFrLargeCx23CI95] = datamean(trFrLargeCx23);
        [trFrLargeCx23imean, trFrLargeCx23iCI95] = datamean(trFrLargeCx23i);
        [trFrLargeCx4mean, trFrLargeCx4CI95] = datamean(trFrLargeCx4);
        [trFrLargeCx4imean, trFrLargeCx4iCI95] = datamean(trFrLargeCx4i);
        [trFrLargeCx5mean, trFrLargeCx5CI95] = datamean(trFrLargeCx5);
        [trFrLargeCx5imean, trFrLargeCx5iCI95] = datamean(trFrLargeCx5i);
        [trFrLargeCx6mean, trFrLargeCx6CI95] = datamean(trFrLargeCx6);
        [trFrLargeCx6imean, trFrLargeCx6iCI95] = datamean(trFrLargeCx6i);
        [trFrLargeNRTmean, trFrLargeNRTCI95] = datamean(trFrLargeNRT);
        [trFrLargeNRT2mean, trFrLargeNRT2CI95] = datamean(trFrLargeNRT2);
        [trFrLargeTCmean, trFrLargeTCCI95] = datamean(trFrLargeTC);
        [trFrLargeTC2mean, trFrLargeTC2CI95] = datamean(trFrLargeTC2);
        [trFrLargeAllmean, trFrLargeAllCI95] = datamean(trFrLargeAll);
        
        [brFrLargeCx23mean, brFrLargeCx23CI95] = datamean(brFrLargeCx23);
        [brFrLargeCx23imean, brFrLargeCx23iCI95] = datamean(brFrLargeCx23i);
        [brFrLargeCx4mean, brFrLargeCx4CI95] = datamean(brFrLargeCx4);
        [brFrLargeCx4imean, brFrLargeCx4iCI95] = datamean(brFrLargeCx4i);
        [brFrLargeCx5mean, brFrLargeCx5CI95] = datamean(brFrLargeCx5);
        [brFrLargeCx5imean, brFrLargeCx5iCI95] = datamean(brFrLargeCx5i);
        [brFrLargeCx6mean, brFrLargeCx6CI95] = datamean(brFrLargeCx6);
        [brFrLargeCx6imean, brFrLargeCx6iCI95] = datamean(brFrLargeCx6i);
        [brFrLargeNRTmean, brFrLargeNRTCI95] = datamean(brFrLargeNRT);
        [brFrLargeNRT2mean, brFrLargeNRT2CI95] = datamean(brFrLargeNRT2);
        [brFrLargeTCmean, brFrLargeTCCI95] = datamean(brFrLargeTC);
        [brFrLargeTC2mean, brFrLargeTC2CI95] = datamean(brFrLargeTC2);
        [brFrLargeAllmean, brFrLargeAllCI95] = datamean(brFrLargeAll);
    end
    
    if psi
        [psiCx23mean, psiCx23CI95] = datamean(psiCx23);
        [psiCx23imean, psiCx23iCI95] = datamean(psiCx23i);
        [psiCx4mean, psiCx4CI95] = datamean(psiCx4);
        [psiCx4imean, psiCx4iCI95] = datamean(psiCx4i);
        [psiCx5mean, psiCx5CI95] = datamean(psiCx5);
        [psiCx5imean, psiCx5iCI95] = datamean(psiCx5i);
        [psiCx6mean, psiCx6CI95] = datamean(psiCx6);
        [psiCx6imean, psiCx6iCI95] = datamean(psiCx6i);
        [psiNRTmean, psiNRTCI95] = datamean(psiNRT);
        [psiNRT2mean, psiNRT2CI95] = datamean(psiNRT2);
        [psiTCmean, psiTCCI95] = datamean(psiTC);
        [psiTC2mean, psiTC2CI95] = datamean(psiTC2);
        [psiAllmean, psiAllCI95] = datamean(psiAll);
        
        [psiCx23mean_t, psiCx23CI95_t] = datamean(psiCx23_t);
        [psiCx23imean_t, psiCx23iCI95_t] = datamean(psiCx23i_t);
        [psiCx4mean_t, psiCx4CI95_t] = datamean(psiCx4_t);
        [psiCx4imean_t, psiCx4iCI95_t] = datamean(psiCx4i_t);
        [psiCx5mean_t, psiCx5CI95_t] = datamean(psiCx5_t);
        [psiCx5imean_t, psiCx5iCI95_t] = datamean(psiCx5i_t);
        [psiCx6mean_t, psiCx6CI95_t] = datamean(psiCx6_t);
        [psiCx6imean_t, psiCx6iCI95_t] = datamean(psiCx6i_t);
        [psiNRTmean_t, psiNRTCI95_t] = datamean(psiNRT_t);
        [psiNRT2mean_t, psiNRT2CI95_t] = datamean(psiNRT2_t);
        [psiTCmean_t, psiTCCI95_t] = datamean(psiTC_t);
        [psiTC2mean_t, psiTC2CI95_t] = datamean(psiTC2_t);
        [psiAllmean_t, psiAllCI95_t] = datamean(psiAll_t);
        
        [phaseDiffCx23mean, phaseDiffCx23CI95] = datamean(phaseDiffCx23);
        [phaseDiffCx23imean, phaseDiffCx23iCI95] = datamean(phaseDiffCx23i);
        [phaseDiffCx4mean, phaseDiffCx4CI95] = datamean(phaseDiffCx4);
        [phaseDiffCx4imean, phaseDiffCx4iCI95] = datamean(phaseDiffCx4i);
        [phaseDiffCx5mean, phaseDiffCx5CI95] = datamean(phaseDiffCx5);
        [phaseDiffCx5imean, phaseDiffCx5iCI95] = datamean(phaseDiffCx5i);
        [phaseDiffCx6mean, phaseDiffCx6CI95] = datamean(phaseDiffCx6);
        [phaseDiffCx6imean, phaseDiffCx6iCI95] = datamean(phaseDiffCx6i);
        [phaseDiffNRTmean, phaseDiffNRTCI95] = datamean(phaseDiffNRT);
        [phaseDiffNRT2mean, phaseDiffNRT2CI95] = datamean(phaseDiffNRT2);
        [phaseDiffTCmean, phaseDiffTCCI95] = datamean(phaseDiffTC);
        [phaseDiffTC2mean, phaseDiffTC2CI95] = datamean(phaseDiffTC2);
        [phaseDiffAllmean, phaseDiffAllCI95] = datamean(phaseDiffAll);
        
        [psiRasterCx23mean, psiRasterCx23CI95] = datamean(psiRasterCx23);
        [psiRasterCx23imean, psiRasterCx23iCI95] = datamean(psiRasterCx23i);
        [psiRasterCx4mean, psiRasterCx4CI95] = datamean(psiRasterCx4);
        [psiRasterCx4imean, psiRasterCx4iCI95] = datamean(psiRasterCx4i);
        [psiRasterCx5mean, psiRasterCx5CI95] = datamean(psiRasterCx5);
        [psiRasterCx5imean, psiRasterCx5iCI95] = datamean(psiRasterCx5i);
        [psiRasterCx6mean, psiRasterCx6CI95] = datamean(psiRasterCx6);
        [psiRasterCx6imean, psiRasterCx6iCI95] = datamean(psiRasterCx6i);
        [psiRasterNRTmean, psiRasterNRTCI95] = datamean(psiRasterNRT);
        [psiRasterNRT2mean, psiRasterNRT2CI95] = datamean(psiRasterNRT2);
        [psiRasterTCmean, psiRasterTCCI95] = datamean(psiRasterTC);
        [psiRasterTC2mean, psiRasterTC2CI95] = datamean(psiRasterTC2);
        [psiRasterAllmean, psiRasterAllCI95] = datamean(psiRasterAll);
        
        [psiRasterCx23mean_t, psiRasterCx23CI95_t] = datamean(psiRasterCx23_t);
        [psiRasterCx23imean_t, psiRasterCx23iCI95_t] = datamean(psiRasterCx23i_t);
        [psiRasterCx4mean_t, psiRasterCx4CI95_t] = datamean(psiRasterCx4_t);
        [psiRasterCx4imean_t, psiRasterCx4iCI95_t] = datamean(psiRasterCx4i_t);
        [psiRasterCx5mean_t, psiRasterCx5CI95_t] = datamean(psiRasterCx5_t);
        [psiRasterCx5imean_t, psiRasterCx5iCI95_t] = datamean(psiRasterCx5i_t);
        [psiRasterCx6mean_t, psiRasterCx6CI95_t] = datamean(psiRasterCx6_t);
        [psiRasterCx6imean_t, psiRasterCx6iCI95_t] = datamean(psiRasterCx6i_t);
        [psiRasterNRTmean_t, psiRasterNRTCI95_t] = datamean(psiRasterNRT_t);
        [psiRasterNRT2mean_t, psiRasterNRT2CI95_t] = datamean(psiRasterNRT2_t);
        [psiRasterTCmean_t, psiRasterTCCI95_t] = datamean(psiRasterTC_t);
        [psiRasterTC2mean_t, psiRasterTC2CI95_t] = datamean(psiRasterTC2_t);
        [psiRasterAllmean_t, psiRasterAllCI95_t] = datamean(psiRasterAll_t);
        
        [phaseDiffRasterCx23mean, phaseDiffRasterCx23CI95] = datamean(phaseDiffRasterCx23);
        [phaseDiffRasterCx23imean, phaseDiffRasterCx23iCI95] = datamean(phaseDiffRasterCx23i);
        [phaseDiffRasterCx4mean, phaseDiffRasterCx4CI95] = datamean(phaseDiffRasterCx4);
        [phaseDiffRasterCx4imean, phaseDiffRasterCx4iCI95] = datamean(phaseDiffRasterCx4i);
        [phaseDiffRasterCx5mean, phaseDiffRasterCx5CI95] = datamean(phaseDiffRasterCx5);
        [phaseDiffRasterCx5imean, phaseDiffRasterCx5iCI95] = datamean(phaseDiffRasterCx5i);
        [phaseDiffRasterCx6mean, phaseDiffRasterCx6CI95] = datamean(phaseDiffRasterCx6);
        [phaseDiffRasterCx6imean, phaseDiffRasterCx6iCI95] = datamean(phaseDiffRasterCx6i);
        [phaseDiffRasterNRTmean, phaseDiffRasterNRTCI95] = datamean(phaseDiffRasterNRT);
        [phaseDiffRasterNRT2mean, phaseDiffRasterNRT2CI95] = datamean(phaseDiffRasterNRT2);
        [phaseDiffRasterTCmean, phaseDiffRasterTCCI95] = datamean(phaseDiffRasterTC);
        [phaseDiffRasterTC2mean, phaseDiffRasterTC2CI95] = datamean(phaseDiffRasterTC2);
        [phaseDiffRasterAllmean, phaseDiffRasterAllCI95] = datamean(phaseDiffRasterAll);
    end
else
    if coherence
        load('coherenceData.mat');
    end
    if xCorrelation
        load('xCorrelationData.mat');
    end
    if eegts
        load('eegtsData.mat');
    end
    if eegsts
        load('eegstsData.mat');
    end
    if vm
        load('vmData.mat');
    end
    if fr
        load('frData.mat');
    end
    if psi
        load('psiData.mat');
    end
end

% Figures
if coherence
    % semilogx(freq,cohCx23mean);
    % hold on
    % semilogx(freq,cohCx23mean+cohCx23CI95(1,:));
    % semilogx(freq,cohCx23mean+cohCx23CI95(2,:));
    % hold off
    % semilogx(freq,phaseCx23mean);
    % hold on
    % semilogx(freq,phaseCx23mean-phaseCx23CI95);
    % semilogx(freq,phaseCx23mean+phaseCx23CI95);
    % hold off
    
    semilogx(freq,cohAllmean);
    hold on
    semilogx(freq,cohAllmean+cohAllCI95(1,:));
    semilogx(freq,cohAllmean+cohAllCI95(2,:));
    hold off
end

xLim = [-0.5 0.5]; xTicks = [-0.5 -0.25 0 0.25 0.5]; xTickLabels = {'-0.5'; '-0.25'; '0'; '0.25'; '0.5'};
%xLimZoom = [-0.05 0.05]; xTicksZoom = [-0.05 -0.025 0 0.025 0.05]; xTickLabelsZoom = {'-50'; '-25'; '0'; '25'; '50'};
xLimZoom = [-0.08 0.08]; xTicksZoom = [-0.08 -0.04 0 0.04 0.08]; xTickLabelsZoom = {'-80'; '-40'; '0'; '40'; '80'};
xLimZoomInit = [-0.13 0.03];xTicksZoomInit = [-0.12 -0.08 -0.04 0]; xTickLabelsZoomInit = {'-120'; '-80'; '-40'; '0'};
if xCorrelation && eegts && false
    yColourLeft = [0, 0.4470, 0.7410];
    fAll = xCorrFigs(xCorrAllmean, xCorrAllCI95, dt, window, yColourLeft);
    fCx5 = xCorrFigs(xCorrCx5mean, xCorrCx5CI95, dt, window, yColourLeft);
    fCx5i = xCorrFigs(xCorrCx5imean, xCorrCx5iCI95, dt, window, yColourLeft);
    fNRT = xCorrFigs(xCorrNRTmean, xCorrNRTCI95, dt, window, yColourLeft);
    fNRT2 = xCorrFigs(xCorrNRT2mean, xCorrNRT2CI95, dt, window, yColourLeft);
    fTC = xCorrFigs(xCorrTCmean, xCorrTCCI95, dt, window, yColourLeft);
    fTC2 = xCorrFigs(xCorrTC2mean, xCorrTC2CI95, dt, window, yColourLeft);
    
    yColourRight = [213 94 0]./255;
    fAll = eegtsFigs(fAll, eegtsAllmean, eegtsAllCI95, dt, window, yColourRight);
    fCx5 = eegtsFigs(fCx5, eegtsCx5mean, eegtsCx5CI95, dt, window, yColourRight);
    fCx5i = eegtsFigs(fCx5i, eegtsCx5imean, eegtsCx5iCI95, dt, window, yColourRight);
    fNRT = eegtsFigs(fNRT, eegtsNRTmean, eegtsNRTCI95, dt, window, yColourRight);
    fNRT2 = eegtsFigs(fNRT2, eegtsNRT2mean, eegtsNRT2CI95, dt, window, yColourRight);
    fTC = eegtsFigs(fTC, eegtsTCmean, eegtsTCCI95, dt, window, yColourRight);
    fTC2 = eegtsFigs(fTC2, eegtsTC2mean, eegtsTC2CI95, dt, window, yColourRight);
    
    fAll = xCorrFigAdjust(fAll, '', xLim, xTicks, {}, 'All', yColourLeft, yColourRight);
    fCx5 = xCorrFigAdjust(fCx5, '', xLim, xTicks, {}, 'Cx3', yColourLeft, yColourRight);
    fCx5i = xCorrFigAdjust(fCx5i, '', xLim, xTicks, {}, 'Cx3i', yColourLeft, yColourRight);
    fNRT = xCorrFigAdjust(fNRT, 'Time lag (s)', xLim, xTicks, xTickLabels, 'NRT', yColourLeft, yColourRight);
    fNRT2 = xCorrFigAdjust(fNRT2, 'Time lag (s)', xLim, xTicks, xTickLabels, 'NRT2', yColourLeft, yColourRight);
    fTC = xCorrFigAdjust(fTC, '', xLim, xTicks, {}, 'TC', yColourLeft, yColourRight);
    fTC2 = xCorrFigAdjust(fTC2, '', xLim, xTicks, {}, 'TC2', yColourLeft, yColourRight);
end

if eegts && eegsts && false
    yColourLeft = [0, 0.4470, 0.7410];
    fAll = xCorrFigs(eegstsAllmean, eegstsAllCI95, dt, window, yColourLeft);
    fCx5 = xCorrFigs(eegstsCx5mean, eegstsCx5CI95, dt, window, yColourLeft);
    fCx5i = xCorrFigs(eegstsCx5imean, eegstsCx5iCI95, dt, window, yColourLeft);
    fNRT = xCorrFigs(eegstsNRTmean, eegstsNRTCI95, dt, window, yColourLeft);
    fNRT2 = xCorrFigs(eegstsNRT2mean, eegstsNRT2CI95, dt, window, yColourLeft);
    fTC = xCorrFigs(eegstsTCmean, eegstsTCCI95, dt, window, yColourLeft);
    fTC2 = xCorrFigs(eegstsTC2mean, eegstsTC2CI95, dt, window, yColourLeft);
    
    yColourRight = [213 94 0]./255;
    fAll = eegtsFigs(fAll, eegtsAllmean, eegtsAllCI95, dt, window, yColourRight);
    fCx5 = eegtsFigs(fCx5, eegtsCx5mean, eegtsCx5CI95, dt, window, yColourRight);
    fCx5i = eegtsFigs(fCx5i, eegtsCx5imean, eegtsCx5iCI95, dt, window, yColourRight);
    fNRT = eegtsFigs(fNRT, eegtsNRTmean, eegtsNRTCI95, dt, window, yColourRight);
    fNRT2 = eegtsFigs(fNRT2, eegtsNRT2mean, eegtsNRT2CI95, dt, window, yColourRight);
    fTC = eegtsFigs(fTC, eegtsTCmean, eegtsTCCI95, dt, window, yColourRight);
    fTC2 = eegtsFigs(fTC2, eegtsTC2mean, eegtsTC2CI95, dt, window, yColourRight);
    
    fAll = xCorrFigAdjust(fAll, '', xLim, xTicks, {}, '2_All', yColourLeft, yColourRight);
    fCx5 = xCorrFigAdjust(fCx5, '', xLim, xTicks, {}, '2_Cx3', yColourLeft, yColourRight);
    fCx5i = xCorrFigAdjust(fCx5i, '', xLim, xTicks, {}, '2_Cx3i', yColourLeft, yColourRight);
    fNRT = xCorrFigAdjust(fNRT, 'Time lag (s)', xLim, xTicks, xTickLabels, '2_NRT', yColourLeft, yColourRight);
    fNRT2 = xCorrFigAdjust(fNRT2, 'Time lag (s)', xLim, xTicks, xTickLabels, '2_NRT2', yColourLeft, yColourRight);
    fTC = xCorrFigAdjust(fTC, '', xLim, xTicks, {}, '2_TC', yColourLeft, yColourRight);
    fTC2 = xCorrFigAdjust(fTC2, '', xLim, xTicks, xTickLabels, '2_TC2', yColourLeft, yColourRight);
    
    fAll = xCorrFigAdjust(fAll, '', xLimZoom, xTicksZoom, {}, '2_zoom_All', yColourLeft, yColourRight);
    fCx5 = xCorrFigAdjust(fCx5, '', xLimZoom, xTicksZoom, {}, '2_zoom_Cx3', yColourLeft, yColourRight);
    fCx5i = xCorrFigAdjust(fCx5i, '', xLimZoom, xTicksZoom, {}, '2_zoom_Cx3i', yColourLeft, yColourRight);
    fNRT = xCorrFigAdjust(fNRT, 'Time lag (s)', xLimZoom, xTicksZoom, xTickLabelsZoom, '2_zoom_NRT', yColourLeft, yColourRight);
    fNRT2 = xCorrFigAdjust(fNRT2, 'Time lag (s)', xLimZoom, xTicksZoom, xTickLabelsZoom, '2_zoom_NRT2', yColourLeft, yColourRight);
    fTC = xCorrFigAdjust(fTC, '', xLimZoom, xTicksZoom, {}, '2_zoom_TC', yColourLeft, yColourRight);
    fTC2 = xCorrFigAdjust(fTC2, '', xLimZoom, xTicksZoom, xTickLabelsZoom, '2_zoom_TC2', yColourLeft, yColourRight);
    
%     fAll = xCorrFigAdjust(fAll, '', xLim, xTicks, xTickLabels, '2_All', yColourLeft, yColourRight);
%     fCx5 = xCorrFigAdjust(fCx5, '', xLim, xTicks, xTickLabels, '2_Cx3', yColourLeft, yColourRight);
%     fCx5i = xCorrFigAdjust(fCx5i, '', xLim, xTicks, xTickLabels, '2_Cx3i', yColourLeft, yColourRight);
%     fNRT = xCorrFigAdjust(fNRT, 'Time lag (s)', xLim, xTicks, xTickLabels, '2_NRT', yColourLeft, yColourRight);
%     fNRT2 = xCorrFigAdjust(fNRT2, 'Time lag (s)', xLim, xTicks, xTickLabels, '2_NRT2', yColourLeft, yColourRight);
%     fTC = xCorrFigAdjust(fTC, '', xLim, xTicks, xTickLabels, '2_TC', yColourLeft, yColourRight);
%     fTC2 = xCorrFigAdjust(fTC2, '', xLim, xTicks, xTickLabels, '2_TC2', yColourLeft, yColourRight);
%     
%     fAll = xCorrFigAdjust(fAll, '', xLimZoom, xTicksZoom, xTickLabelsZoom, '2_zoom_All', yColourLeft, yColourRight);
%     fCx5 = xCorrFigAdjust(fCx5, '', xLimZoom, xTicksZoom, xTickLabelsZoom, '2_zoom_Cx3', yColourLeft, yColourRight);
%     fCx5i = xCorrFigAdjust(fCx5i, '', xLimZoom, xTicksZoom, xTickLabelsZoom, '2_zoom_Cx3i', yColourLeft, yColourRight);
%     fNRT = xCorrFigAdjust(fNRT, 'Time lag (s)', xLimZoom, xTicksZoom, xTickLabelsZoom, '2_zoom_NRT', yColourLeft, yColourRight);
%     fNRT2 = xCorrFigAdjust(fNRT2, 'Time lag (s)', xLimZoom, xTicksZoom, xTickLabelsZoom, '2_zoom_NRT2', yColourLeft, yColourRight);
%     fTC = xCorrFigAdjust(fTC, '', xLimZoom, xTicksZoom, xTickLabelsZoom, '2_zoom_TC', yColourLeft, yColourRight);
%     fTC2 = xCorrFigAdjust(fTC2, '', xLimZoom, xTicksZoom, xTickLabelsZoom, '2_zoom_TC2', yColourLeft, yColourRight);
end

if xCorrelation && eegsts && ~fullRun
    yColourLeft = [0, 0, 0];
    fAll = xCorrFigs(xCorrAllmean, xCorrAllCI95, dt, window, yColourLeft);
    fCx5 = xCorrFigs(xCorrCx5mean, xCorrCx5CI95, dt, window, yColourLeft);
    fCx5i = xCorrFigs(xCorrCx5imean, xCorrCx5iCI95, dt, window, yColourLeft);
    fNRT = xCorrFigs(xCorrNRTmean, xCorrNRTCI95, dt, window, yColourLeft);
    fNRT2 = xCorrFigs(xCorrNRT2mean, xCorrNRT2CI95, dt, window, yColourLeft);
    fTC = xCorrFigs(xCorrTCmean, xCorrTCCI95, dt, window, yColourLeft);
    fTC2 = xCorrFigs(xCorrTC2mean, xCorrTC2CI95, dt, window, yColourLeft);
    
    yColourRight = [213 94 0]./255;
    smooth = true;
    fAll = eegtsFigs(fAll, eegstsAllmean, eegstsAllCI95, dt, window, yColourRight, smooth);
    fCx5 = eegtsFigs(fCx5, eegstsCx5mean, eegstsCx5CI95, dt, window, cellColour('Cx5'), smooth);
    fCx5i = eegtsFigs(fCx5i, eegstsCx5imean, eegstsCx5iCI95, dt, window, cellColour('Cx5i'), smooth);
    fNRT = eegtsFigs(fNRT, eegstsNRTmean, eegstsNRTCI95, dt, window, cellColour('NRT'), smooth);
    fNRT2 = eegtsFigs(fNRT2, eegstsNRT2mean, eegstsNRT2CI95, dt, window, cellColour('NRT2'), smooth);
    fTC = eegtsFigs(fTC, eegstsTCmean, eegstsTCCI95, dt, window, cellColour('TC'), smooth);
    fTC2 = eegtsFigs(fTC2, eegstsTC2mean, eegstsTC2CI95, dt, window, cellColour('TC2'), smooth);
    
    xCorrFigAdjust(fAll, '', xLim, xTicks, {}, '3_All', yColourLeft, yColourRight);
    xCorrFigAdjust(fCx5, '', xLim, xTicks, {}, '3_Cx3', yColourLeft, cellColour('Cx5'));
    xCorrFigAdjust(fCx5i, '', xLim, xTicks, {}, '3_Cx3i', yColourLeft, cellColour('Cx5i'));
    xCorrFigAdjust(fNRT, 'Time lag (s)', xLim, xTicks, xTickLabels, '3_NRT', yColourLeft, cellColour('NRT'));
    xCorrFigAdjust(fNRT2, 'Time lag (s)', xLim, xTicks, xTickLabels, '3_NRT2', yColourLeft, cellColour('NRT2'));
    xCorrFigAdjust(fTC, 'Time lag (s)', xLim, xTicks, xTickLabels, '3_TC', yColourLeft, cellColour('TC'));
    xCorrFigAdjust(fTC2, 'Time lag (s)', xLim, xTicks, xTickLabels, '3_TC2', yColourLeft, cellColour('TC2'));
    
    fCx5 = xCorrFigs2(eegstsCx5mean, eegstsCx5CI95, dt, window, cellColour('Cx5'), '-', true);
    fCx5i = xCorrFigsUpdate2(fCx5, eegstsCx5imean, eegstsCx5iCI95, dt, window, cellColour('Cx5i'), '-', true);
    fNRT = xCorrFigsUpdate2(fCx5i, eegstsNRTmean, eegstsNRTCI95, dt, window, cellColour('NRT'), '-', true);
    fNRT2 = xCorrFigsUpdate2(fNRT, eegstsNRT2mean, eegstsNRT2CI95, dt, window, cellColour('NRT2'), '-', true);
    fTC = xCorrFigsUpdate2(fNRT2, eegstsTCmean, eegstsTCCI95, dt, window, cellColour('TC'), '-', true);
    fTC2 = xCorrFigsUpdate2(fTC, eegstsTC2mean, eegstsTC2CI95, dt, window, cellColour('TC2'), '-', true);
    xCorrFigAdjust2(fTC2, 'Time lag (ms)', xLimZoom, xTicksZoom, xTickLabelsZoom, '4_All', yColourLeft);
    
    fCx23 = xCorrFigs2(eegstsCx23mean, eegstsCx23CI95, dt, window, cellColour('Cx23'), '-', true);
    fCx23i = xCorrFigsUpdate2(fCx23, eegstsCx23imean, eegstsCx23iCI95, dt, window, cellColour('Cx23i'), '-', true);
    fCx4 = xCorrFigsUpdate2(fCx23i, eegstsCx4mean, eegstsCx4CI95, dt, window, cellColour('Cx4'), '-', true);
    fCx4i = xCorrFigsUpdate2(fCx4, eegstsCx4imean, eegstsCx4iCI95, dt, window, cellColour('Cx4i'), '-', true);
    fCx5 = xCorrFigsUpdate2(fCx4i, eegstsCx5mean, eegstsCx5CI95, dt, window, cellColour('Cx5'), '-', true);
    fCx5i = xCorrFigsUpdate2(fCx5, eegstsCx5imean, eegstsCx5iCI95, dt, window, cellColour('Cx5i'), '-', true);
    fCx6 = xCorrFigsUpdate2(fCx5i, eegstsCx6mean, eegstsCx6CI95, dt, window, cellColour('Cx6'), '-', true);
    fCx6i = xCorrFigsUpdate2(fCx6, eegstsCx6imean, eegstsCx6iCI95, dt, window, cellColour('Cx6i'), '-', true);
    fNRT = xCorrFigsUpdate2(fCx6i, eegstsNRTmean, eegstsNRTCI95, dt, window, cellColour('NRT'), '-', true);
    fNRT2 = xCorrFigsUpdate2(fNRT, eegstsNRT2mean, eegstsNRT2CI95, dt, window, cellColour('NRT2'), '-', true);
    fTC = xCorrFigsUpdate2(fNRT2, eegstsTCmean, eegstsTCCI95, dt, window, cellColour('TC'), '-', true);
    fTC2 = xCorrFigsUpdate2(fTC, eegstsTC2mean, eegstsTC2CI95, dt, window, cellColour('TC2'), '-', true);
    xCorrFigAdjust2(fTC2, 'Time lag (ms)', xLimZoom, xTicksZoom, xTickLabelsZoom, '41_All', yColourLeft);
    
    lineWidth = 3;
    cycle = (1/floor(swdFrequency));
    time2plot = (-window:window).*dt./1000; time2plotInds = time2plot >= -cycle/2 & time2plot <= cycle/2; time2plot = time2plot(time2plotInds);
    time2plotInit = (-window:window).*dt./1000; time2plotInitInds = time2plotInit >= -0.160 & time2plotInit <= 0.060; time2plotInit = time2plotInit(time2plotInitInds);
    cumsumFig = figure; plot(time2plot, cumsum(eegstsCx23mean(time2plotInds))./sum(eegstsCx23mean(time2plotInds)), 'color',cellColour('Cx23'), 'LineWidth',lineWidth); hold on
    plot(time2plot, cumsum(eegstsCx23imean(time2plotInds))./sum(eegstsCx23imean(time2plotInds)), 'color',cellColour('Cx23i'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsCx4mean(time2plotInds))./sum(eegstsCx4mean(time2plotInds)), 'color',cellColour('Cx4'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsCx4imean(time2plotInds))./sum(eegstsCx4imean(time2plotInds)), 'color',cellColour('Cx4i'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsCx5mean(time2plotInds))./sum(eegstsCx5mean(time2plotInds)), 'color',cellColour('Cx5'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsCx5imean(time2plotInds))./sum(eegstsCx5imean(time2plotInds)), 'color',cellColour('Cx5i'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsCx6mean(time2plotInds))./sum(eegstsCx6mean(time2plotInds)), 'color',cellColour('Cx6'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsCx6imean(time2plotInds))./sum(eegstsCx6imean(time2plotInds)), 'color',cellColour('Cx6i'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsNRTmean(time2plotInds))./sum(eegstsNRTmean(time2plotInds)), 'color',cellColour('NRT'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsNRT2mean(time2plotInds))./sum(eegstsNRT2mean(time2plotInds)), 'color',cellColour('NRT2'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsTCmean(time2plotInds))./sum(eegstsTCmean(time2plotInds)), 'color',cellColour('TC'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsTC2mean(time2plotInds))./sum(eegstsTC2mean(time2plotInds)), 'color',cellColour('TC2'), 'LineWidth',lineWidth); hold off
    cumsumFigAdjust(cumsumFig, 'Time lag (ms)', xLimZoom, xTicksZoom, xTickLabelsZoom, '41_All_cumsum', yColourLeft);
    
    fCx23 = xCorrFigs2(eegstsInitCx23mean, eegstsInitCx23CI95, dt, window, cellColour('Cx23'), '-', true);
    fCx23i = xCorrFigsUpdate2(fCx23, eegstsInitCx23imean, eegstsInitCx23iCI95, dt, window, cellColour('Cx23i'), '-', true);
    fCx4 = xCorrFigsUpdate2(fCx23i, eegstsInitCx4mean, eegstsInitCx4CI95, dt, window, cellColour('Cx4'), '-', true);
    fCx4i = xCorrFigsUpdate2(fCx4, eegstsInitCx4imean, eegstsInitCx4iCI95, dt, window, cellColour('Cx4i'), '-', true);
    fCx5 = xCorrFigsUpdate2(fCx4i, eegstsInitCx5mean, eegstsInitCx5CI95, dt, window, cellColour('Cx5'), '-', true);
    fCx5i = xCorrFigsUpdate2(fCx5, eegstsInitCx5imean, eegstsInitCx5iCI95, dt, window, cellColour('Cx5i'), '-', true);
    fCx6 = xCorrFigsUpdate2(fCx5i, eegstsInitCx6mean, eegstsInitCx6CI95, dt, window, cellColour('Cx6'), '-', true);
    fCx6i = xCorrFigsUpdate2(fCx6, eegstsInitCx6imean, eegstsInitCx6iCI95, dt, window, cellColour('Cx6i'), '-', true);
    fNRT = xCorrFigsUpdate2(fCx6i, eegstsInitNRTmean, eegstsInitNRTCI95, dt, window, cellColour('NRT'), '-', true);
    fNRT2 = xCorrFigsUpdate2(fNRT, eegstsInitNRT2mean, eegstsInitNRT2CI95, dt, window, cellColour('NRT2'), '-', true);
    fTC = xCorrFigsUpdate2(fNRT2, eegstsInitTCmean, eegstsInitTCCI95, dt, window, cellColour('TC'), '-', true);
    fTC2 = xCorrFigsUpdate2(fTC, eegstsInitTC2mean, eegstsInitTC2CI95, dt, window, cellColour('TC2'), '-', true);
    xCorrFigAdjust2(fTC2, 'Time lag (ms)', xLimZoomInit, xTicksZoomInit, xTickLabelsZoomInit, '41_I_All', yColourLeft);
    
    cumsumFigI = figure; plot(time2plotInit, cumsum(eegstsInitCx23mean(time2plotInitInds))./sum(eegstsInitCx23mean(time2plotInitInds)), 'color',cellColour('Cx23'), 'LineWidth',lineWidth); hold on
    plot(time2plotInit, cumsum(eegstsInitCx23imean(time2plotInitInds))./sum(eegstsInitCx23imean(time2plotInitInds)), 'color',cellColour('Cx23i'), 'LineWidth',lineWidth);
    plot(time2plotInit, cumsum(eegstsInitCx4mean(time2plotInitInds))./sum(eegstsInitCx4mean(time2plotInitInds)), 'color',cellColour('Cx4'), 'LineWidth',lineWidth);
    plot(time2plotInit, cumsum(eegstsInitCx4imean(time2plotInitInds))./sum(eegstsInitCx4imean(time2plotInitInds)), 'color',cellColour('Cx4i'), 'LineWidth',lineWidth);
    plot(time2plotInit, cumsum(eegstsInitCx5mean(time2plotInitInds))./sum(eegstsInitCx5mean(time2plotInitInds)), 'color',cellColour('Cx5'), 'LineWidth',lineWidth);
    plot(time2plotInit, cumsum(eegstsInitCx5imean(time2plotInitInds))./sum(eegstsInitCx5imean(time2plotInitInds)), 'color',cellColour('Cx5i'), 'LineWidth',lineWidth);
    plot(time2plotInit, cumsum(eegstsInitCx6mean(time2plotInitInds))./sum(eegstsInitCx6mean(time2plotInitInds)), 'color',cellColour('Cx6'), 'LineWidth',lineWidth);
    plot(time2plotInit, cumsum(eegstsInitCx6imean(time2plotInitInds))./sum(eegstsInitCx6imean(time2plotInitInds)), 'color',cellColour('Cx6i'), 'LineWidth',lineWidth);
    plot(time2plotInit, cumsum(eegstsInitNRTmean(time2plotInitInds))./sum(eegstsInitNRTmean(time2plotInitInds)), 'color',cellColour('NRT'), 'LineWidth',lineWidth);
    plot(time2plotInit, cumsum(eegstsInitNRT2mean(time2plotInitInds))./sum(eegstsInitNRT2mean(time2plotInitInds)), 'color',cellColour('NRT2'), 'LineWidth',lineWidth);
    plot(time2plotInit, cumsum(eegstsInitTCmean(time2plotInitInds))./sum(eegstsInitTCmean(time2plotInitInds)), 'color',cellColour('TC'), 'LineWidth',lineWidth);
    plot(time2plotInit, cumsum(eegstsInitTC2mean(time2plotInitInds))./sum(eegstsInitTC2mean(time2plotInitInds)), 'color',cellColour('TC2'), 'LineWidth',lineWidth); hold off
    cumsumFigAdjust(cumsumFigI, 'Time lag (ms)', xLimZoomInit, xTicksZoomInit, xTickLabelsZoomInit, '41_I_All_cumsum', yColourLeft);
    
    fCx23 = xCorrFigs2(eegstsInitLargeCx23mean, eegstsInitLargeCx23CI95, dt, window, cellColour('Cx23'), '-', true);
    fCx23i = xCorrFigsUpdate2(fCx23, eegstsInitLargeCx23imean, eegstsInitLargeCx23iCI95, dt, window, cellColour('Cx23i'), '-', true);
    fCx4 = xCorrFigsUpdate2(fCx23i, eegstsInitLargeCx4mean, eegstsInitLargeCx4CI95, dt, window, cellColour('Cx4'), '-', true);
    fCx4i = xCorrFigsUpdate2(fCx4, eegstsInitLargeCx4imean, eegstsInitLargeCx4iCI95, dt, window, cellColour('Cx4i'), '-', true);
    fCx5 = xCorrFigsUpdate2(fCx4i, eegstsInitLargeCx5mean, eegstsInitLargeCx5CI95, dt, window, cellColour('Cx5'), '-', true);
    fCx5i = xCorrFigsUpdate2(fCx5, eegstsInitLargeCx5imean, eegstsInitLargeCx5iCI95, dt, window, cellColour('Cx5i'), '-', true);
    fCx6 = xCorrFigsUpdate2(fCx5i, eegstsInitLargeCx6mean, eegstsInitLargeCx6CI95, dt, window, cellColour('Cx6'), '-', true);
    fCx6i = xCorrFigsUpdate2(fCx6, eegstsInitLargeCx6imean, eegstsInitLargeCx6iCI95, dt, window, cellColour('Cx6i'), '-', true);
    fNRT = xCorrFigsUpdate2(fCx6i, eegstsInitLargeNRTmean, eegstsInitLargeNRTCI95, dt, window, cellColour('NRT'), '-', true);
    fNRT2 = xCorrFigsUpdate2(fNRT, eegstsInitLargeNRT2mean, eegstsInitLargeNRT2CI95, dt, window, cellColour('NRT2'), '-', true);
    fTC = xCorrFigsUpdate2(fNRT2, eegstsInitLargeTCmean, eegstsInitLargeTCCI95, dt, window, cellColour('TC'), '-', true);
    fTC2 = xCorrFigsUpdate2(fTC, eegstsInitLargeTC2mean, eegstsInitLargeTC2CI95, dt, window, cellColour('TC2'), '-', true);
    xCorrFigAdjust2(fTC2, 'Time lag (ms)', xLimZoom, xTicksZoom, xTickLabelsZoom, '41_IL_All', yColourLeft);
    
    fCx23 = xCorrFigs2(eegstsFinalCx23mean, eegstsFinalCx23CI95, dt, window, cellColour('Cx23'), '-', true);
    fCx23i = xCorrFigsUpdate2(fCx23, eegstsFinalCx23imean, eegstsFinalCx23iCI95, dt, window, cellColour('Cx23i'), '-', true);
    fCx4 = xCorrFigsUpdate2(fCx23i, eegstsFinalCx4mean, eegstsFinalCx4CI95, dt, window, cellColour('Cx4'), '-', true);
    fCx4i = xCorrFigsUpdate2(fCx4, eegstsFinalCx4imean, eegstsFinalCx4iCI95, dt, window, cellColour('Cx4i'), '-', true);
    fCx5 = xCorrFigsUpdate2(fCx4i, eegstsFinalCx5mean, eegstsFinalCx5CI95, dt, window, cellColour('Cx5'), '-', true);
    fCx5i = xCorrFigsUpdate2(fCx5, eegstsFinalCx5imean, eegstsFinalCx5iCI95, dt, window, cellColour('Cx5i'), '-', true);
    fCx6 = xCorrFigsUpdate2(fCx5i, eegstsFinalCx6mean, eegstsFinalCx6CI95, dt, window, cellColour('Cx6'), '-', true);
    fCx6i = xCorrFigsUpdate2(fCx6, eegstsFinalCx6imean, eegstsFinalCx6iCI95, dt, window, cellColour('Cx6i'), '-', true);
    fNRT = xCorrFigsUpdate2(fCx6i, eegstsFinalNRTmean, eegstsFinalNRTCI95, dt, window, cellColour('NRT'), '-', true);
    fNRT2 = xCorrFigsUpdate2(fNRT, eegstsFinalNRT2mean, eegstsFinalNRT2CI95, dt, window, cellColour('NRT2'), '-', true);
    fTC = xCorrFigsUpdate2(fNRT2, eegstsFinalTCmean, eegstsFinalTCCI95, dt, window, cellColour('TC'), '-', true);
    fTC2 = xCorrFigsUpdate2(fTC, eegstsFinalTC2mean, eegstsFinalTC2CI95, dt, window, cellColour('TC2'), '-', true);
    xCorrFigAdjust2(fTC2, 'Time lag (ms)', xLimZoom, xTicksZoom, xTickLabelsZoom, '41_F_All', yColourLeft);
    
    cumsumFigF = figure; plot(time2plot, cumsum(eegstsFinalCx23mean(time2plotInds))./sum(eegstsFinalCx23mean(time2plotInds)), 'color',cellColour('Cx23'), 'LineWidth',lineWidth); hold on
    plot(time2plot, cumsum(eegstsFinalCx23imean(time2plotInds))./sum(eegstsFinalCx23imean(time2plotInds)), 'color',cellColour('Cx23i'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsFinalCx4mean(time2plotInds))./sum(eegstsFinalCx4mean(time2plotInds)), 'color',cellColour('Cx4'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsFinalCx4imean(time2plotInds))./sum(eegstsFinalCx4imean(time2plotInds)), 'color',cellColour('Cx4i'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsFinalCx5mean(time2plotInds))./sum(eegstsFinalCx5mean(time2plotInds)), 'color',cellColour('Cx5'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsFinalCx5imean(time2plotInds))./sum(eegstsFinalCx5imean(time2plotInds)), 'color',cellColour('Cx5i'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsFinalCx6mean(time2plotInds))./sum(eegstsFinalCx6mean(time2plotInds)), 'color',cellColour('Cx6'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsFinalCx6imean(time2plotInds))./sum(eegstsFinalCx6imean(time2plotInds)), 'color',cellColour('Cx6i'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsFinalNRTmean(time2plotInds))./sum(eegstsFinalNRTmean(time2plotInds)), 'color',cellColour('NRT'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsFinalNRT2mean(time2plotInds))./sum(eegstsFinalNRT2mean(time2plotInds)), 'color',cellColour('NRT2'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsFinalTCmean(time2plotInds))./sum(eegstsFinalTCmean(time2plotInds)), 'color',cellColour('TC'), 'LineWidth',lineWidth);
    plot(time2plot, cumsum(eegstsFinalTC2mean(time2plotInds))./sum(eegstsFinalTC2mean(time2plotInds)), 'color',cellColour('TC2'), 'LineWidth',lineWidth); hold off
    cumsumFigAdjust(cumsumFigF, 'Time lag (ms)', xLimZoom, xTicksZoom, xTickLabelsZoom, '41_F_All_cumsum', yColourLeft);
    
    fCx23 = xCorrFigs2(eegstsFinalLargeCx23mean, eegstsFinalLargeCx23CI95, dt, window, cellColour('Cx23'), '-', true);
    fCx23i = xCorrFigsUpdate2(fCx23, eegstsFinalLargeCx23imean, eegstsFinalLargeCx23iCI95, dt, window, cellColour('Cx23i'), '-', true);
    fCx4 = xCorrFigsUpdate2(fCx23i, eegstsFinalLargeCx4mean, eegstsFinalLargeCx4CI95, dt, window, cellColour('Cx4'), '-', true);
    fCx4i = xCorrFigsUpdate2(fCx4, eegstsFinalLargeCx4imean, eegstsFinalLargeCx4iCI95, dt, window, cellColour('Cx4i'), '-', true);
    fCx5 = xCorrFigsUpdate2(fCx4i, eegstsFinalLargeCx5mean, eegstsFinalLargeCx5CI95, dt, window, cellColour('Cx5'), '-', true);
    fCx5i = xCorrFigsUpdate2(fCx5, eegstsFinalLargeCx5imean, eegstsFinalLargeCx5iCI95, dt, window, cellColour('Cx5i'), '-', true);
    fCx6 = xCorrFigsUpdate2(fCx5i, eegstsFinalLargeCx6mean, eegstsFinalLargeCx6CI95, dt, window, cellColour('Cx6'), '-', true);
    fCx6i = xCorrFigsUpdate2(fCx6, eegstsFinalLargeCx6imean, eegstsFinalLargeCx6iCI95, dt, window, cellColour('Cx6i'), '-', true);
    fNRT = xCorrFigsUpdate2(fCx6i, eegstsFinalLargeNRTmean, eegstsFinalLargeNRTCI95, dt, window, cellColour('NRT'), '-', true);
    fNRT2 = xCorrFigsUpdate2(fNRT, eegstsFinalLargeNRT2mean, eegstsFinalLargeNRT2CI95, dt, window, cellColour('NRT2'), '-', true);
    fTC = xCorrFigsUpdate2(fNRT2, eegstsFinalLargeTCmean, eegstsFinalLargeTCCI95, dt, window, cellColour('TC'), '-', true);
    fTC2 = xCorrFigsUpdate2(fTC, eegstsFinalLargeTC2mean, eegstsFinalLargeTC2CI95, dt, window, cellColour('TC2'), '-', true);
    xCorrFigAdjust2(fTC2, 'Time lag (ms)', xLimZoom, xTicksZoom, xTickLabelsZoom, '41_FL_All', yColourLeft);
end

t = dt*(1:numel(EEGinit));
t = t(iRange);
tInterp = t(1):dtInterp:t(end);
if vm && ~fullRun
    SWDsInterp = interp1(t, SWDs, tInterp, 'linear', 'extrap');
    SWDsLargeInterp = interp1(t, SWDsLarge, tInterp, 'linear', 'extrap');
    [vmAllMeanAligned, vmAllCI95Aligned, tStartAligned, tEndAligned,...
        vmAllMeanAlignedScaled, vmAllCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled] = frAlign(SWDsInterp, vmAll, tInterp);
    [vmAllMeanAlignedLarge, vmAllCI95AlignedLarge, tStartAlignedLarge, tEndAlignedLarge,...
        vmAllMeanAlignedScaledLarge, vmAllCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmAll, tInterp);
    [vmCx23MeanAligned, vmCx23CI95Aligned, ~, ~,...
        vmCx23MeanAlignedScaled, vmCx23CI95AlignedScaled] = frAlign(SWDsInterp, vmCx23, tInterp);
    [vmCx23MeanAlignedLarge, vmCx23CI95AlignedLarge, ~, ~,...
        vmCx23MeanAlignedScaledLarge, vmCx23CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmCx23, tInterp);
    [vmCx23iMeanAligned, vmCx23iCI95Aligned, ~, ~,...
        vmCx23iMeanAlignedScaled, vmCx23iCI95AlignedScaled] = frAlign(SWDsInterp, vmCx23i, tInterp);
    [vmCx23iMeanAlignedLarge, vmCx23iCI95AlignedLarge, ~, ~,...
        vmCx23iMeanAlignedScaledLarge, vmCx23iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmCx23i, tInterp);
    [vmCx4MeanAligned, vmCx4CI95Aligned, ~, ~,...
        vmCx4MeanAlignedScaled, vmCx4CI95AlignedScaled] = frAlign(SWDsInterp, vmCx4, tInterp);
    [vmCx4MeanAlignedLarge, vmCx4CI95AlignedLarge, ~, ~,...
        vmCx4MeanAlignedScaledLarge, vmCx4CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmCx4, tInterp);
    [vmCx4iMeanAligned, vmCx4iCI95Aligned, ~, ~,...
        vmCx4iMeanAlignedScaled, vmCx4iCI95AlignedScaled] = frAlign(SWDsInterp, vmCx4i, tInterp);
    [vmCx4iMeanAlignedLarge, vmCx4iCI95AlignedLarge, ~, ~,...
        vmCx4iMeanAlignedScaledLarge, vmCx4iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmCx4i, tInterp);
    [vmCx5MeanAligned, vmCx5CI95Aligned, ~, ~,...
        vmCx5MeanAlignedScaled, vmCx5CI95AlignedScaled] = frAlign(SWDsInterp, vmCx5, tInterp);
    [vmCx5MeanAlignedLarge, vmCx5CI95AlignedLarge, ~, ~,...
        vmCx5MeanAlignedScaledLarge, vmCx5CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmCx5, tInterp);
    [vmCx5iMeanAligned, vmCx5iCI95Aligned, ~, ~,...
        vmCx5iMeanAlignedScaled, vmCx5iCI95AlignedScaled] = frAlign(SWDsInterp, vmCx5i, tInterp);
    [vmCx5iMeanAlignedLarge, vmCx5iCI95AlignedLarge, ~, ~,...
        vmCx5iMeanAlignedScaledLarge, vmCx5iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmCx5i, tInterp);
    [vmCx6MeanAligned, vmCx6CI95Aligned, ~, ~,...
        vmCx6MeanAlignedScaled, vmCx6CI95AlignedScaled] = frAlign(SWDsInterp, vmCx6, tInterp);
    [vmCx6MeanAlignedLarge, vmCx6CI95AlignedLarge, ~, ~,...
        vmCx6MeanAlignedScaledLarge, vmCx6CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmCx6, tInterp);
    [vmCx6iMeanAligned, vmCx6iCI95Aligned, ~, ~,...
        vmCx6iMeanAlignedScaled, vmCx6iCI95AlignedScaled] = frAlign(SWDsInterp, vmCx6i, tInterp);
    [vmCx6iMeanAlignedLarge, vmCx6iCI95AlignedLarge, ~, ~,...
        vmCx6iMeanAlignedScaledLarge, vmCx6iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmCx6i, tInterp);
    [vmNRTMeanAligned, vmNRTCI95Aligned, ~, ~,...
        vmNRTMeanAlignedScaled, vmNRTCI95AlignedScaled] = frAlign(SWDsInterp, vmNRT, tInterp);
    [vmNRTMeanAlignedLarge, vmNRTCI95AlignedLarge, ~, ~,...
        vmNRTMeanAlignedScaledLarge, vmNRTCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmNRT, tInterp);
    [vmNRT2MeanAligned, vmNRT2CI95Aligned, ~, ~,...
        vmNRT2MeanAlignedScaled, vmNRT2CI95AlignedScaled] = frAlign(SWDsInterp, vmNRT2, tInterp);
    [vmNRT2MeanAlignedLarge, vmNRT2CI95AlignedLarge, ~, ~,...
        vmNRT2MeanAlignedScaledLarge, vmNRT2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmNRT2, tInterp);
    [vmTCMeanAligned, vmTCCI95Aligned, ~, ~,...
        vmTCMeanAlignedScaled, vmTCCI95AlignedScaled] = frAlign(SWDsInterp, vmTC, tInterp);
    [vmTCMeanAlignedLarge, vmTCCI95AlignedLarge, ~, ~,...
        vmTCMeanAlignedScaledLarge, vmTCCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmTC, tInterp);
    [vmTC2MeanAligned, vmTC2CI95Aligned, ~, ~,...
        vmTC2MeanAlignedScaled, vmTC2CI95AlignedScaled] = frAlign(SWDsInterp, vmTC2, tInterp);
    [vmTC2MeanAlignedLarge, vmTC2CI95AlignedLarge, ~, ~,...
        vmTC2MeanAlignedScaledLarge, vmTC2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, vmTC2, tInterp);
    
    vmMeanAlignedScaled = [vmCx23MeanAlignedScaled; vmCx23iMeanAlignedScaled; vmCx4MeanAlignedScaled; vmCx4iMeanAlignedScaled;...
        vmCx5MeanAlignedScaled; vmCx5iMeanAlignedScaled; vmCx6MeanAlignedScaled; vmCx6iMeanAlignedScaled;
        vmNRTMeanAlignedScaled; vmNRT2MeanAlignedScaled; vmTCMeanAlignedScaled; vmTC2MeanAlignedScaled];
    vmCI95AlignedScaled = [vmCx23CI95AlignedScaled; vmCx23iCI95AlignedScaled; vmCx4CI95AlignedScaled; vmCx4iCI95AlignedScaled;...
        vmCx5CI95AlignedScaled; vmCx5iCI95AlignedScaled; vmCx6CI95AlignedScaled; vmCx6iCI95AlignedScaled;
        vmNRTCI95AlignedScaled; vmNRT2CI95AlignedScaled; vmTCCI95AlignedScaled; vmTC2CI95AlignedScaled];
    colours = [cellColour('Cx23'); cellColour('Cx23'); cellColour('Cx4'); cellColour('Cx4'); cellColour('Cx5'); cellColour('Cx5');...
        cellColour('Cx6'); cellColour('Cx6'); cellColour('NRT'); cellColour('NRT2'); cellColour('TC'); cellColour('TC2')];
    lineTypes = {'-','--','-','--','-','--','-','--','-','-','-','-'};
    legendEntries = {'L2/3 PY', 'L2/3 IN', 'L4 PY', 'L4 IN', 'L5 PY', 'L5 IN', 'L6 PY', 'L6 IN', 'NRT_F_O', 'NRT_H_O', 'TC_F_O', 'TC_H_O'};
    fVM = frAlignPlot(vmMeanAlignedScaled, vmCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled, colours, lineTypes, 'V_M (mV)',...
        legendEntries, 'Membrane potential');
    
    interictalInterp = interp1(t, interictal, tInterp, 'linear', 'extrap');
    interictalLargeInterp = interp1(t, interictalLarge, tInterp, 'linear', 'extrap');
    [vmAllMeanAligned_i, vmAllCI95Aligned_i, tStartAligned_i, tEndAligned_i,...
        vmAllMeanAlignedScaled_i, vmAllCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i] = frAlign(interictalInterp, vmAll, tInterp);
    [vmAllMeanAlignedLarge_i, vmAllCI95AlignedLarge_i, tStartAlignedLarge_i, tEndAlignedLarge_i,...
        vmAllMeanAlignedScaledLarge_i, vmAllCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmAll, tInterp);
    [vmCx23MeanAligned_i, vmCx23CI95Aligned_i, ~, ~,...
        vmCx23MeanAlignedScaled_i, vmCx23CI95AlignedScaled_i] = frAlign(interictalInterp, vmCx23, tInterp);
    [vmCx23MeanAlignedLarge_i, vmCx23CI95AlignedLarge_i, ~, ~,...
        vmCx23MeanAlignedScaledLarge_i, vmCx23CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmCx23, tInterp);
    [vmCx23iMeanAligned_i, vmCx23iCI95Aligned_i, ~, ~,...
        vmCx23iMeanAlignedScaled_i, vmCx23iCI95AlignedScaled_i] = frAlign(interictalInterp, vmCx23i, tInterp);
    [vmCx23iMeanAlignedLarge_i, vmCx23iCI95AlignedLarge_i, ~, ~,...
        vmCx23iMeanAlignedScaledLarge_i, vmCx23iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmCx23i, tInterp);
    [vmCx4MeanAligned_i, vmCx4CI95Aligned_i, ~, ~,...
        vmCx4MeanAlignedScaled_i, vmCx4CI95AlignedScaled_i] = frAlign(interictalInterp, vmCx4, tInterp);
    [vmCx4MeanAlignedLarge_i, vmCx4CI95AlignedLarge_i, ~, ~,...
        vmCx4MeanAlignedScaledLarge_i, vmCx4CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmCx4, tInterp);
    [vmCx4iMeanAligned_i, vmCx4iCI95Aligned_i, ~, ~,...
        vmCx4iMeanAlignedScaled_i, vmCx4iCI95AlignedScaled_i] = frAlign(interictalInterp, vmCx4i, tInterp);
    [vmCx4iMeanAlignedLarge_i, vmCx4iCI95AlignedLarge_i, ~, ~,...
        vmCx4iMeanAlignedScaledLarge_i, vmCx4iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmCx4i, tInterp);
    [vmCx5MeanAligned_i, vmCx5CI95Aligned_i, ~, ~,...
        vmCx5MeanAlignedScaled_i, vmCx5CI95AlignedScaled_i] = frAlign(interictalInterp, vmCx5, tInterp);
    [vmCx5MeanAlignedLarge_i, vmCx5CI95AlignedLarge_i, ~, ~,...
        vmCx5MeanAlignedScaledLarge_i, vmCx5CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmCx5, tInterp);
    [vmCx5iMeanAligned_i, vmCx5iCI95Aligned_i, ~, ~,...
        vmCx5iMeanAlignedScaled_i, vmCx5iCI95AlignedScaled_i] = frAlign(interictalInterp, vmCx5i, tInterp);
    [vmCx5iMeanAlignedLarge_i, vmCx5iCI95AlignedLarge_i, ~, ~,...
        vmCx5iMeanAlignedScaledLarge_i, vmCx5iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmCx5i, tInterp);
    [vmCx6MeanAligned_i, vmCx6CI95Aligned_i, ~, ~,...
        vmCx6MeanAlignedScaled_i, vmCx6CI95AlignedScaled_i] = frAlign(interictalInterp, vmCx6, tInterp);
    [vmCx6MeanAlignedLarge_i, vmCx6CI95AlignedLarge_i, ~, ~,...
        vmCx6MeanAlignedScaledLarge_i, vmCx6CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmCx6, tInterp);
    [vmCx6iMeanAligned_i, vmCx6iCI95Aligned_i, ~, ~,...
        vmCx6iMeanAlignedScaled_i, vmCx6iCI95AlignedScaled_i] = frAlign(interictalInterp, vmCx6i, tInterp);
    [vmCx6iMeanAlignedLarge_i, vmCx6iCI95AlignedLarge_i, ~, ~,...
        vmCx6iMeanAlignedScaledLarge_i, vmCx6iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmCx6i, tInterp);
    [vmNRTMeanAligned_i, vmNRTCI95Aligned_i, ~, ~,...
        vmNRTMeanAlignedScaled_i, vmNRTCI95AlignedScaled_i] = frAlign(interictalInterp, vmNRT, tInterp);
    [vmNRTMeanAlignedLarge_i, vmNRTCI95AlignedLarge_i, ~, ~,...
        vmNRTMeanAlignedScaledLarge_i, vmNRTCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmNRT, tInterp);
    [vmNRT2MeanAligned_i, vmNRT2CI95Aligned_i, ~, ~,...
        vmNRT2MeanAlignedScaled_i, vmNRT2CI95AlignedScaled_i] = frAlign(interictalInterp, vmNRT2, tInterp);
    [vmNRT2MeanAlignedLarge_i, vmNRT2CI95AlignedLarge_i, ~, ~,...
        vmNRT2MeanAlignedScaledLarge_i, vmNRT2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmNRT2, tInterp);
    [vmTCMeanAligned_i, vmTCCI95Aligned_i, ~, ~,...
        vmTCMeanAlignedScaled_i, vmTCCI95AlignedScaled_i] = frAlign(interictalInterp, vmTC, tInterp);
    [vmTCMeanAlignedLarge_i, vmTCCI95AlignedLarge_i, ~, ~,...
        vmTCMeanAlignedScaledLarge_i, vmTCCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmTC, tInterp);
    [vmTC2MeanAligned_i, vmTC2CI95Aligned_i, ~, ~,...
        vmTC2MeanAlignedScaled_i, vmTC2CI95AlignedScaled_i] = frAlign(interictalInterp, vmTC2, tInterp);
    [vmTC2MeanAlignedLarge_i, vmTC2CI95AlignedLarge_i, ~, ~,...
        vmTC2MeanAlignedScaledLarge_i, vmTC2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, vmTC2, tInterp);
    
    vmMeanAlignedScaled_i = [vmCx23MeanAlignedScaled_i; vmCx23iMeanAlignedScaled_i; vmCx4MeanAlignedScaled_i; vmCx4iMeanAlignedScaled_i;...
        vmCx5MeanAlignedScaled_i; vmCx5iMeanAlignedScaled_i; vmCx6MeanAlignedScaled_i; vmCx6iMeanAlignedScaled_i;
        vmNRTMeanAlignedScaled_i; vmNRT2MeanAlignedScaled_i; vmTCMeanAlignedScaled_i; vmTC2MeanAlignedScaled_i];
    vmCI95AlignedScaled_i = [vmCx23CI95AlignedScaled_i; vmCx23iCI95AlignedScaled_i; vmCx4CI95AlignedScaled_i; vmCx4iCI95AlignedScaled_i;...
        vmCx5CI95AlignedScaled_i; vmCx5iCI95AlignedScaled_i; vmCx6CI95AlignedScaled_i; vmCx6iCI95AlignedScaled_i;
        vmNRTCI95AlignedScaled_i; vmNRT2CI95AlignedScaled_i; vmTCCI95AlignedScaled_i; vmTC2CI95AlignedScaled_i];
    colours = [cellColour('Cx23'); cellColour('Cx23'); cellColour('Cx4'); cellColour('Cx4'); cellColour('Cx5'); cellColour('Cx5');...
        cellColour('Cx6'); cellColour('Cx6'); cellColour('NRT'); cellColour('NRT2'); cellColour('TC'); cellColour('TC2')];
    lineTypes = {'-','--','-','--','-','--','-','--','-','-','-','-'};
    legendEntries = {'L2/3 PY', 'L2/3 IN', 'L4 PY', 'L4 IN', 'L5 PY', 'L5 IN', 'L6 PY', 'L6 IN', 'NRT_F_O', 'NRT_H_O', 'TC_F_O', 'TC_H_O'};
    fVM = frAlignPlot(vmMeanAlignedScaled_i, vmCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i, colours, lineTypes, 'V_M (mV)',...
        legendEntries, 'Membrane potential');
    
    save('vmData.mat', 'vmMeanAlignedScaled','vmCI95AlignedScaled','tStartAlignedScaled','tEndAlignedScaled',...
        'vmMeanAlignedScaled_i','vmCI95AlignedScaled_i','tStartAlignedScaled_i','tEndAlignedScaled_i', '-append');
end

if fr && ~fullRun
    SWDsInterp = interp1(t, SWDs, tInterp, 'linear', 'extrap');
    SWDsLargeInterp = interp1(t, SWDsLarge, tInterp, 'linear', 'extrap');
    [frAllMeanAligned, frAllCI95Aligned, tStartAligned, tEndAligned,...
        frAllMeanAlignedScaled, frAllCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled] = frAlign(SWDsInterp, frAll, tInterp);
    [frAllMeanAlignedLarge, frAllCI95AlignedLarge, tStartAlignedLarge, tEndAlignedLarge,...
        frAllMeanAlignedScaledLarge, frAllCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frAll, tInterp);
    [frCx23MeanAligned, frCx23CI95Aligned, ~, ~,...
        frCx23MeanAlignedScaled, frCx23CI95AlignedScaled] = frAlign(SWDsInterp, frCx23, tInterp);
    [frCx23MeanAlignedLarge, frCx23CI95AlignedLarge, ~, ~,...
        frCx23MeanAlignedScaledLarge, frCx23CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frCx23, tInterp);
    [frCx23iMeanAligned, frCx23iCI95Aligned, ~, ~,...
        frCx23iMeanAlignedScaled, frCx23iCI95AlignedScaled] = frAlign(SWDsInterp, frCx23i, tInterp);
    [frCx23iMeanAlignedLarge, frCx23iCI95AlignedLarge, ~, ~,...
        frCx23iMeanAlignedScaledLarge, frCx23iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frCx23i, tInterp);
    [frCx4MeanAligned, frCx4CI95Aligned, ~, ~,...
        frCx4MeanAlignedScaled, frCx4CI95AlignedScaled] = frAlign(SWDsInterp, frCx4, tInterp);
    [frCx4MeanAlignedLarge, frCx4CI95AlignedLarge, ~, ~,...
        frCx4MeanAlignedScaledLarge, frCx4CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frCx4, tInterp);
    [frCx4iMeanAligned, frCx4iCI95Aligned, ~, ~,...
        frCx4iMeanAlignedScaled, frCx4iCI95AlignedScaled] = frAlign(SWDsInterp, frCx4i, tInterp);
    [frCx4iMeanAlignedLarge, frCx4iCI95AlignedLarge, ~, ~,...
        frCx4iMeanAlignedScaledLarge, frCx4iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frCx4i, tInterp);
    [frCx5MeanAligned, frCx5CI95Aligned, ~, ~,...
        frCx5MeanAlignedScaled, frCx5CI95AlignedScaled] = frAlign(SWDsInterp, frCx5, tInterp);
    [frCx5MeanAlignedLarge, frCx5CI95AlignedLarge, ~, ~,...
        frCx5MeanAlignedScaledLarge, frCx5CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frCx5, tInterp);
    [frCx5iMeanAligned, frCx5iCI95Aligned, ~, ~,...
        frCx5iMeanAlignedScaled, frCx5iCI95AlignedScaled] = frAlign(SWDsInterp, frCx5i, tInterp);
    [frCx5iMeanAlignedLarge, frCx5iCI95AlignedLarge, ~, ~,...
        frCx5iMeanAlignedScaledLarge, frCx5iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frCx5i, tInterp);
    [frCx6MeanAligned, frCx6CI95Aligned, ~, ~,...
        frCx6MeanAlignedScaled, frCx6CI95AlignedScaled] = frAlign(SWDsInterp, frCx6, tInterp);
    [frCx6MeanAlignedLarge, frCx6CI95AlignedLarge, ~, ~,...
        frCx6MeanAlignedScaledLarge, frCx6CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frCx6, tInterp);
    [frCx6iMeanAligned, frCx6iCI95Aligned, ~, ~,...
        frCx6iMeanAlignedScaled, frCx6iCI95AlignedScaled] = frAlign(SWDsInterp, frCx6i, tInterp);
    [frCx6iMeanAlignedLarge, frCx6iCI95AlignedLarge, ~, ~,...
        frCx6iMeanAlignedScaledLarge, frCx6iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frCx6i, tInterp);
    [frNRTMeanAligned, frNRTCI95Aligned, ~, ~,...
        frNRTMeanAlignedScaled, frNRTCI95AlignedScaled] = frAlign(SWDsInterp, frNRT, tInterp);
    [frNRTMeanAlignedLarge, frNRTCI95AlignedLarge, ~, ~,...
        frNRTMeanAlignedScaledLarge, frNRTCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frNRT, tInterp);
    [frNRT2MeanAligned, frNRT2CI95Aligned, ~, ~,...
        frNRT2MeanAlignedScaled, frNRT2CI95AlignedScaled] = frAlign(SWDsInterp, frNRT2, tInterp);
    [frNRT2MeanAlignedLarge, frNRT2CI95AlignedLarge, ~, ~,...
        frNRT2MeanAlignedScaledLarge, frNRT2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frNRT2, tInterp);
    [frTCMeanAligned, frTCCI95Aligned, ~, ~,...
        frTCMeanAlignedScaled, frTCCI95AlignedScaled] = frAlign(SWDsInterp, frTC, tInterp);
    [frTCMeanAlignedLarge, frTCCI95AlignedLarge, ~, ~,...
        frTCMeanAlignedScaledLarge, frTCCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frTC, tInterp);
    [frTC2MeanAligned, frTC2CI95Aligned, ~, ~,...
        frTC2MeanAlignedScaled, frTC2CI95AlignedScaled] = frAlign(SWDsInterp, frTC2, tInterp);
    [frTC2MeanAlignedLarge, frTC2CI95AlignedLarge, ~, ~,...
        frTC2MeanAlignedScaledLarge, frTC2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, frTC2, tInterp);
    
    frMeanAlignedScaled = [frCx23MeanAlignedScaled; frCx23iMeanAlignedScaled; frCx4MeanAlignedScaled; frCx4iMeanAlignedScaled;...
        frCx5MeanAlignedScaled; frCx5iMeanAlignedScaled; frCx6MeanAlignedScaled; frCx6iMeanAlignedScaled;
        frNRTMeanAlignedScaled; frNRT2MeanAlignedScaled; frTCMeanAlignedScaled; frTC2MeanAlignedScaled];
    frCI95AlignedScaled = [frCx23CI95AlignedScaled; frCx23iCI95AlignedScaled; frCx4CI95AlignedScaled; frCx4iCI95AlignedScaled;...
        frCx5CI95AlignedScaled; frCx5iCI95AlignedScaled; frCx6CI95AlignedScaled; frCx6iCI95AlignedScaled;
        frNRTCI95AlignedScaled; frNRT2CI95AlignedScaled; frTCCI95AlignedScaled; frTC2CI95AlignedScaled];
    colours = [cellColour('Cx23'); cellColour('Cx23i'); cellColour('Cx4'); cellColour('Cx4i'); cellColour('Cx5'); cellColour('Cx5i');...
        cellColour('Cx6'); cellColour('Cx6i'); cellColour('NRT'); cellColour('NRT2'); cellColour('TC'); cellColour('TC2')];
    lineTypes = {'-','-','-','-','-','-','-','-','-','-','-','-'};
    legendEntries = {'L2/3 PY', 'L2/3 IN', 'L4 PY', 'L4 IN', 'L5 PY', 'L5 IN', 'L6 PY', 'L6 IN', 'NRT_F_O', 'NRT_H_O', 'TC_F_O', 'TC_H_O'};
    fFR = frAlignPlot(frMeanAlignedScaled, frCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled, colours, lineTypes, 'APs/sec',...
        legendEntries, 'Total firing');
    
    [trAllMeanAligned, trAllCI95Aligned, tStartAligned, tEndAligned,...
        trAllMeanAlignedScaled, trAllCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled] = frAlign(SWDsInterp, trAll, tInterp);
    [trAllMeanAlignedLarge, trAllCI95AlignedLarge, tStartAlignedLarge, tEndAlignedLarge,...
        trAllMeanAlignedScaledLarge, trAllCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trAll, tInterp);
    [trCx23MeanAligned, trCx23CI95Aligned, ~, ~,...
        trCx23MeanAlignedScaled, trCx23CI95AlignedScaled] = frAlign(SWDsInterp, trCx23, tInterp);
    [trCx23MeanAlignedLarge, trCx23CI95AlignedLarge, ~, ~,...
        trCx23MeanAlignedScaledLarge, trCx23CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trCx23, tInterp);
    [trCx23iMeanAligned, trCx23iCI95Aligned, ~, ~,...
        trCx23iMeanAlignedScaled, trCx23iCI95AlignedScaled] = frAlign(SWDsInterp, trCx23i, tInterp);
    [trCx23iMeanAlignedLarge, trCx23iCI95AlignedLarge, ~, ~,...
        trCx23iMeanAlignedScaledLarge, trCx23iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trCx23i, tInterp);
    [trCx4MeanAligned, trCx4CI95Aligned, ~, ~,...
        trCx4MeanAlignedScaled, trCx4CI95AlignedScaled] = frAlign(SWDsInterp, trCx4, tInterp);
    [trCx4MeanAlignedLarge, trCx4CI95AlignedLarge, ~, ~,...
        trCx4MeanAlignedScaledLarge, trCx4CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trCx4, tInterp);
    [trCx4iMeanAligned, trCx4iCI95Aligned, ~, ~,...
        trCx4iMeanAlignedScaled, trCx4iCI95AlignedScaled] = frAlign(SWDsInterp, trCx4i, tInterp);
    [trCx4iMeanAlignedLarge, trCx4iCI95AlignedLarge, ~, ~,...
        trCx4iMeanAlignedScaledLarge, trCx4iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trCx4i, tInterp);
    [trCx5MeanAligned, trCx5CI95Aligned, ~, ~,...
        trCx5MeanAlignedScaled, trCx5CI95AlignedScaled] = frAlign(SWDsInterp, trCx5, tInterp);
    [trCx5MeanAlignedLarge, trCx5CI95AlignedLarge, ~, ~,...
        trCx5MeanAlignedScaledLarge, trCx5CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trCx5, tInterp);
    [trCx5iMeanAligned, trCx5iCI95Aligned, ~, ~,...
        trCx5iMeanAlignedScaled, trCx5iCI95AlignedScaled] = frAlign(SWDsInterp, trCx5i, tInterp);
    [trCx5iMeanAlignedLarge, trCx5iCI95AlignedLarge, ~, ~,...
        trCx5iMeanAlignedScaledLarge, trCx5iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trCx5i, tInterp);
    [trCx6MeanAligned, trCx6CI95Aligned, ~, ~,...
        trCx6MeanAlignedScaled, trCx6CI95AlignedScaled] = frAlign(SWDsInterp, trCx6, tInterp);
    [trCx6MeanAlignedLarge, trCx6CI95AlignedLarge, ~, ~,...
        trCx6MeanAlignedScaledLarge, trCx6CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trCx6, tInterp);
    [trCx6iMeanAligned, trCx6iCI95Aligned, ~, ~,...
        trCx6iMeanAlignedScaled, trCx6iCI95AlignedScaled] = frAlign(SWDsInterp, trCx6i, tInterp);
    [trCx6iMeanAlignedLarge, trCx6iCI95AlignedLarge, ~, ~,...
        trCx6iMeanAlignedScaledLarge, trCx6iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trCx6i, tInterp);
    [trNRTMeanAligned, trNRTCI95Aligned, ~, ~,...
        trNRTMeanAlignedScaled, trNRTCI95AlignedScaled] = frAlign(SWDsInterp, trNRT, tInterp);
    [trNRTMeanAlignedLarge, trNRTCI95AlignedLarge, ~, ~,...
        trNRTMeanAlignedScaledLarge, trNRTCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trNRT, tInterp);
    [trNRT2MeanAligned, trNRT2CI95Aligned, ~, ~,...
        trNRT2MeanAlignedScaled, trNRT2CI95AlignedScaled] = frAlign(SWDsInterp, trNRT2, tInterp);
    [trNRT2MeanAlignedLarge, trNRT2CI95AlignedLarge, ~, ~,...
        trNRT2MeanAlignedScaledLarge, trNRT2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trNRT2, tInterp);
    [trTCMeanAligned, trTCCI95Aligned, ~, ~,...
        trTCMeanAlignedScaled, trTCCI95AlignedScaled] = frAlign(SWDsInterp, trTC, tInterp);
    [trTCMeanAlignedLarge, trTCCI95AlignedLarge, ~, ~,...
        trTCMeanAlignedScaledLarge, trTCCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trTC, tInterp);
    [trTC2MeanAligned, trTC2CI95Aligned, ~, ~,...
        trTC2MeanAlignedScaled, trTC2CI95AlignedScaled] = frAlign(SWDsInterp, trTC2, tInterp);
    [trTC2MeanAlignedLarge, trTC2CI95AlignedLarge, ~, ~,...
        trTC2MeanAlignedScaledLarge, trTC2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, trTC2, tInterp);
    
    trMeanAlignedScaled = [trCx23MeanAlignedScaled; trCx23iMeanAlignedScaled; trCx4MeanAlignedScaled; trCx4iMeanAlignedScaled;...
        trCx5MeanAlignedScaled; trCx5iMeanAlignedScaled; trCx6MeanAlignedScaled; trCx6iMeanAlignedScaled;
        trNRTMeanAlignedScaled; trNRT2MeanAlignedScaled; trTCMeanAlignedScaled; trTC2MeanAlignedScaled];
    trCI95AlignedScaled = [trCx23CI95AlignedScaled; trCx23iCI95AlignedScaled; trCx4CI95AlignedScaled; trCx4iCI95AlignedScaled;...
        trCx5CI95AlignedScaled; trCx5iCI95AlignedScaled; trCx6CI95AlignedScaled; trCx6iCI95AlignedScaled;
        trNRTCI95AlignedScaled; trNRT2CI95AlignedScaled; trTCCI95AlignedScaled; trTC2CI95AlignedScaled];
    fTR = frAlignPlot(trMeanAlignedScaled, trCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled, colours, lineTypes, 'APs/sec',...
        legendEntries, 'Tonic firing');
    
    [brAllMeanAligned, brAllCI95Aligned, tStartAligned, tEndAligned,...
        brAllMeanAlignedScaled, brAllCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled] = frAlign(SWDsInterp, brAll, tInterp);
    [brAllMeanAlignedLarge, brAllCI95AlignedLarge, tStartAlignedLarge, tEndAlignedLarge,...
        brAllMeanAlignedScaledLarge, brAllCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brAll, tInterp);
    [brCx23MeanAligned, brCx23CI95Aligned, ~, ~,...
        brCx23MeanAlignedScaled, brCx23CI95AlignedScaled] = frAlign(SWDsInterp, brCx23, tInterp);
    [brCx23MeanAlignedLarge, brCx23CI95AlignedLarge, ~, ~,...
        brCx23MeanAlignedScaledLarge, brCx23CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brCx23, tInterp);
    [brCx23iMeanAligned, brCx23iCI95Aligned, ~, ~,...
        brCx23iMeanAlignedScaled, brCx23iCI95AlignedScaled] = frAlign(SWDsInterp, brCx23i, tInterp);
    [brCx23iMeanAlignedLarge, brCx23iCI95AlignedLarge, ~, ~,...
        brCx23iMeanAlignedScaledLarge, brCx23iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brCx23i, tInterp);
    [brCx4MeanAligned, brCx4CI95Aligned, ~, ~,...
        brCx4MeanAlignedScaled, brCx4CI95AlignedScaled] = frAlign(SWDsInterp, brCx4, tInterp);
    [brCx4MeanAlignedLarge, brCx4CI95AlignedLarge, ~, ~,...
        brCx4MeanAlignedScaledLarge, brCx4CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brCx4, tInterp);
    [brCx4iMeanAligned, brCx4iCI95Aligned, ~, ~,...
        brCx4iMeanAlignedScaled, brCx4iCI95AlignedScaled] = frAlign(SWDsInterp, brCx4i, tInterp);
    [brCx4iMeanAlignedLarge, brCx4iCI95AlignedLarge, ~, ~,...
        brCx4iMeanAlignedScaledLarge, brCx4iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brCx4i, tInterp);
    [brCx5MeanAligned, brCx5CI95Aligned, ~, ~,...
        brCx5MeanAlignedScaled, brCx5CI95AlignedScaled] = frAlign(SWDsInterp, brCx5, tInterp);
    [brCx5MeanAlignedLarge, brCx5CI95AlignedLarge, ~, ~,...
        brCx5MeanAlignedScaledLarge, brCx5CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brCx5, tInterp);
    [brCx5iMeanAligned, brCx5iCI95Aligned, ~, ~,...
        brCx5iMeanAlignedScaled, brCx5iCI95AlignedScaled] = frAlign(SWDsInterp, brCx5i, tInterp);
    [brCx5iMeanAlignedLarge, brCx5iCI95AlignedLarge, ~, ~,...
        brCx5iMeanAlignedScaledLarge, brCx5iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brCx5i, tInterp);
    [brCx6MeanAligned, brCx6CI95Aligned, ~, ~,...
        brCx6MeanAlignedScaled, brCx6CI95AlignedScaled] = frAlign(SWDsInterp, brCx6, tInterp);
    [brCx6MeanAlignedLarge, brCx6CI95AlignedLarge, ~, ~,...
        brCx6MeanAlignedScaledLarge, brCx6CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brCx6, tInterp);
    [brCx6iMeanAligned, brCx6iCI95Aligned, ~, ~,...
        brCx6iMeanAlignedScaled, brCx6iCI95AlignedScaled] = frAlign(SWDsInterp, brCx6i, tInterp);
    [brCx6iMeanAlignedLarge, brCx6iCI95AlignedLarge, ~, ~,...
        brCx6iMeanAlignedScaledLarge, brCx6iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brCx6i, tInterp);
    [brNRTMeanAligned, brNRTCI95Aligned, ~, ~,...
        brNRTMeanAlignedScaled, brNRTCI95AlignedScaled] = frAlign(SWDsInterp, brNRT, tInterp);
    [brNRTMeanAlignedLarge, brNRTCI95AlignedLarge, ~, ~,...
        brNRTMeanAlignedScaledLarge, brNRTCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brNRT, tInterp);
    [brNRT2MeanAligned, brNRT2CI95Aligned, ~, ~,...
        brNRT2MeanAlignedScaled, brNRT2CI95AlignedScaled] = frAlign(SWDsInterp, brNRT2, tInterp);
    [brNRT2MeanAlignedLarge, brNRT2CI95AlignedLarge, ~, ~,...
        brNRT2MeanAlignedScaledLarge, brNRT2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brNRT2, tInterp);
    [brTCMeanAligned, brTCCI95Aligned, ~, ~,...
        brTCMeanAlignedScaled, brTCCI95AlignedScaled] = frAlign(SWDsInterp, brTC, tInterp);
    [brTCMeanAlignedLarge, brTCCI95AlignedLarge, ~, ~,...
        brTCMeanAlignedScaledLarge, brTCCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brTC, tInterp);
    [brTC2MeanAligned, brTC2CI95Aligned, ~, ~,...
        brTC2MeanAlignedScaled, brTC2CI95AlignedScaled] = frAlign(SWDsInterp, brTC2, tInterp);
    [brTC2MeanAlignedLarge, brTC2CI95AlignedLarge, ~, ~,...
        brTC2MeanAlignedScaledLarge, brTC2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, brTC2, tInterp);
    
    brMeanAlignedScaled = [brCx23MeanAlignedScaled; brCx23iMeanAlignedScaled; brCx4MeanAlignedScaled; brCx4iMeanAlignedScaled;...
        brCx5MeanAlignedScaled; brCx5iMeanAlignedScaled; brCx6MeanAlignedScaled; brCx6iMeanAlignedScaled;
        brNRTMeanAlignedScaled; brNRT2MeanAlignedScaled; brTCMeanAlignedScaled; brTC2MeanAlignedScaled];
    brCI95AlignedScaled = [brCx23CI95AlignedScaled; brCx23iCI95AlignedScaled; brCx4CI95AlignedScaled; brCx4iCI95AlignedScaled;...
        brCx5CI95AlignedScaled; brCx5iCI95AlignedScaled; brCx6CI95AlignedScaled; brCx6iCI95AlignedScaled;
        brNRTCI95AlignedScaled; brNRT2CI95AlignedScaled; brTCCI95AlignedScaled; brTC2CI95AlignedScaled];
    fBR = frAlignPlot(brMeanAlignedScaled, brCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled, colours, lineTypes, 'Bursts/sec',...
        legendEntries, 'Burst firing');
    
    [br2AllMeanAligned, br2AllCI95Aligned, tStartAligned, tEndAligned,...
        br2AllMeanAlignedScaled, br2AllCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled] = frAlign(SWDsInterp, br2All, tInterp);
    [br2AllMeanAlignedLarge, br2AllCI95AlignedLarge, tStartAlignedLarge, tEndAlignedLarge,...
        br2AllMeanAlignedScaledLarge, br2AllCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2All, tInterp);
    [br2Cx23MeanAligned, br2Cx23CI95Aligned, ~, ~,...
        br2Cx23MeanAlignedScaled, br2Cx23CI95AlignedScaled] = frAlign(SWDsInterp, br2Cx23, tInterp);
    [br2Cx23MeanAlignedLarge, br2Cx23CI95AlignedLarge, ~, ~,...
        br2Cx23MeanAlignedScaledLarge, br2Cx23CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2Cx23, tInterp);
    [br2Cx23iMeanAligned, br2Cx23iCI95Aligned, ~, ~,...
        br2Cx23iMeanAlignedScaled, br2Cx23iCI95AlignedScaled] = frAlign(SWDsInterp, br2Cx23i, tInterp);
    [br2Cx23iMeanAlignedLarge, br2Cx23iCI95AlignedLarge, ~, ~,...
        br2Cx23iMeanAlignedScaledLarge, br2Cx23iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2Cx23i, tInterp);
    [br2Cx4MeanAligned, br2Cx4CI95Aligned, ~, ~,...
        br2Cx4MeanAlignedScaled, br2Cx4CI95AlignedScaled] = frAlign(SWDsInterp, br2Cx4, tInterp);
    [br2Cx4MeanAlignedLarge, br2Cx4CI95AlignedLarge, ~, ~,...
        br2Cx4MeanAlignedScaledLarge, br2Cx4CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2Cx4, tInterp);
    [br2Cx4iMeanAligned, br2Cx4iCI95Aligned, ~, ~,...
        br2Cx4iMeanAlignedScaled, br2Cx4iCI95AlignedScaled] = frAlign(SWDsInterp, br2Cx4i, tInterp);
    [br2Cx4iMeanAlignedLarge, br2Cx4iCI95AlignedLarge, ~, ~,...
        br2Cx4iMeanAlignedScaledLarge, br2Cx4iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2Cx4i, tInterp);
    [br2Cx5MeanAligned, br2Cx5CI95Aligned, ~, ~,...
        br2Cx5MeanAlignedScaled, br2Cx5CI95AlignedScaled] = frAlign(SWDsInterp, br2Cx5, tInterp);
    [br2Cx5MeanAlignedLarge, br2Cx5CI95AlignedLarge, ~, ~,...
        br2Cx5MeanAlignedScaledLarge, br2Cx5CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2Cx5, tInterp);
    [br2Cx5iMeanAligned, br2Cx5iCI95Aligned, ~, ~,...
        br2Cx5iMeanAlignedScaled, br2Cx5iCI95AlignedScaled] = frAlign(SWDsInterp, br2Cx5i, tInterp);
    [br2Cx5iMeanAlignedLarge, br2Cx5iCI95AlignedLarge, ~, ~,...
        br2Cx5iMeanAlignedScaledLarge, br2Cx5iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2Cx5i, tInterp);
    [br2Cx6MeanAligned, br2Cx6CI95Aligned, ~, ~,...
        br2Cx6MeanAlignedScaled, br2Cx6CI95AlignedScaled] = frAlign(SWDsInterp, br2Cx6, tInterp);
    [br2Cx6MeanAlignedLarge, br2Cx6CI95AlignedLarge, ~, ~,...
        br2Cx6MeanAlignedScaledLarge, br2Cx6CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2Cx6, tInterp);
    [br2Cx6iMeanAligned, br2Cx6iCI95Aligned, ~, ~,...
        br2Cx6iMeanAlignedScaled, br2Cx6iCI95AlignedScaled] = frAlign(SWDsInterp, br2Cx6i, tInterp);
    [br2Cx6iMeanAlignedLarge, br2Cx6iCI95AlignedLarge, ~, ~,...
        br2Cx6iMeanAlignedScaledLarge, br2Cx6iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2Cx6i, tInterp);
    [br2NRTMeanAligned, br2NRTCI95Aligned, ~, ~,...
        br2NRTMeanAlignedScaled, br2NRTCI95AlignedScaled] = frAlign(SWDsInterp, br2NRT, tInterp);
    [br2NRTMeanAlignedLarge, br2NRTCI95AlignedLarge, ~, ~,...
        br2NRTMeanAlignedScaledLarge, br2NRTCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2NRT, tInterp);
    [br2NRT2MeanAligned, br2NRT2CI95Aligned, ~, ~,...
        br2NRT2MeanAlignedScaled, br2NRT2CI95AlignedScaled] = frAlign(SWDsInterp, br2NRT2, tInterp);
    [br2NRT2MeanAlignedLarge, br2NRT2CI95AlignedLarge, ~, ~,...
        br2NRT2MeanAlignedScaledLarge, br2NRT2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2NRT2, tInterp);
    [br2TCMeanAligned, br2TCCI95Aligned, ~, ~,...
        br2TCMeanAlignedScaled, br2TCCI95AlignedScaled] = frAlign(SWDsInterp, br2TC, tInterp);
    [br2TCMeanAlignedLarge, br2TCCI95AlignedLarge, ~, ~,...
        br2TCMeanAlignedScaledLarge, br2TCCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2TC, tInterp);
    [br2TC2MeanAligned, br2TC2CI95Aligned, ~, ~,...
        br2TC2MeanAlignedScaled, br2TC2CI95AlignedScaled] = frAlign(SWDsInterp, br2TC2, tInterp);
    [br2TC2MeanAlignedLarge, br2TC2CI95AlignedLarge, ~, ~,...
        br2TC2MeanAlignedScaledLarge, br2TC2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, br2TC2, tInterp);
    
    br2MeanAlignedScaled = [br2Cx23MeanAlignedScaled; br2Cx23iMeanAlignedScaled; br2Cx4MeanAlignedScaled; br2Cx4iMeanAlignedScaled;...
        br2Cx5MeanAlignedScaled; br2Cx5iMeanAlignedScaled; br2Cx6MeanAlignedScaled; br2Cx6iMeanAlignedScaled;
        br2NRTMeanAlignedScaled; br2NRT2MeanAlignedScaled; br2TCMeanAlignedScaled; br2TC2MeanAlignedScaled];
    br2CI95AlignedScaled = [br2Cx23CI95AlignedScaled; br2Cx23iCI95AlignedScaled; br2Cx4CI95AlignedScaled; br2Cx4iCI95AlignedScaled;...
        br2Cx5CI95AlignedScaled; br2Cx5iCI95AlignedScaled; br2Cx6CI95AlignedScaled; br2Cx6iCI95AlignedScaled;
        br2NRTCI95AlignedScaled; br2NRT2CI95AlignedScaled; br2TCCI95AlignedScaled; br2TC2CI95AlignedScaled];
    fBR2 = frAlignPlot(br2MeanAlignedScaled, br2CI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled, colours, lineTypes,...
        'APs/burst', legendEntries, 'Burst firing in detail');
    
    interictalInterp = interp1(t, interictal, tInterp, 'linear', 'extrap');
    interictalLargeInterp = interp1(t, interictalLarge, tInterp, 'linear', 'extrap');
    [frAllMeanAligned_i, frAllCI95Aligned_i, tStartAligned_i, tEndAligned_i,...
        frAllMeanAlignedScaled_i, frAllCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i] = frAlign(interictalInterp, frAll, tInterp);
    [frAllMeanAlignedLarge_i, frAllCI95AlignedLarge_i, tStartAlignedLarge_i, tEndAlignedLarge_i,...
        frAllMeanAlignedScaledLarge_i, frAllCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frAll, tInterp);
    [frCx23MeanAligned_i, frCx23CI95Aligned_i, ~, ~,...
        frCx23MeanAlignedScaled_i, frCx23CI95AlignedScaled_i] = frAlign(interictalInterp, frCx23, tInterp);
    [frCx23MeanAlignedLarge_i, frCx23CI95AlignedLarge_i, ~, ~,...
        frCx23MeanAlignedScaledLarge_i, frCx23CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frCx23, tInterp);
    [frCx23iMeanAligned_i, frCx23iCI95Aligned_i, ~, ~,...
        frCx23iMeanAlignedScaled_i, frCx23iCI95AlignedScaled_i] = frAlign(interictalInterp, frCx23i, tInterp);
    [frCx23iMeanAlignedLarge_i, frCx23iCI95AlignedLarge_i, ~, ~,...
        frCx23iMeanAlignedScaledLarge_i, frCx23iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frCx23i, tInterp);
    [frCx4MeanAligned_i, frCx4CI95Aligned_i, ~, ~,...
        frCx4MeanAlignedScaled_i, frCx4CI95AlignedScaled_i] = frAlign(interictalInterp, frCx4, tInterp);
    [frCx4MeanAlignedLarge_i, frCx4CI95AlignedLarge_i, ~, ~,...
        frCx4MeanAlignedScaledLarge_i, frCx4CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frCx4, tInterp);
    [frCx4iMeanAligned_i, frCx4iCI95Aligned_i, ~, ~,...
        frCx4iMeanAlignedScaled_i, frCx4iCI95AlignedScaled_i] = frAlign(interictalInterp, frCx4i, tInterp);
    [frCx4iMeanAlignedLarge_i, frCx4iCI95AlignedLarge_i, ~, ~,...
        frCx4iMeanAlignedScaledLarge_i, frCx4iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frCx4i, tInterp);
    [frCx5MeanAligned_i, frCx5CI95Aligned_i, ~, ~,...
        frCx5MeanAlignedScaled_i, frCx5CI95AlignedScaled_i] = frAlign(interictalInterp, frCx5, tInterp);
    [frCx5MeanAlignedLarge_i, frCx5CI95AlignedLarge_i, ~, ~,...
        frCx5MeanAlignedScaledLarge_i, frCx5CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frCx5, tInterp);
    [frCx5iMeanAligned_i, frCx5iCI95Aligned_i, ~, ~,...
        frCx5iMeanAlignedScaled_i, frCx5iCI95AlignedScaled_i] = frAlign(interictalInterp, frCx5i, tInterp);
    [frCx5iMeanAlignedLarge_i, frCx5iCI95AlignedLarge_i, ~, ~,...
        frCx5iMeanAlignedScaledLarge_i, frCx5iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frCx5i, tInterp);
    [frCx6MeanAligned_i, frCx6CI95Aligned_i, ~, ~,...
        frCx6MeanAlignedScaled_i, frCx6CI95AlignedScaled_i] = frAlign(interictalInterp, frCx6, tInterp);
    [frCx6MeanAlignedLarge_i, frCx6CI95AlignedLarge_i, ~, ~,...
        frCx6MeanAlignedScaledLarge_i, frCx6CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frCx6, tInterp);
    [frCx6iMeanAligned_i, frCx6iCI95Aligned_i, ~, ~,...
        frCx6iMeanAlignedScaled_i, frCx6iCI95AlignedScaled_i] = frAlign(interictalInterp, frCx6i, tInterp);
    [frCx6iMeanAlignedLarge_i, frCx6iCI95AlignedLarge_i, ~, ~,...
        frCx6iMeanAlignedScaledLarge_i, frCx6iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frCx6i, tInterp);
    [frNRTMeanAligned_i, frNRTCI95Aligned_i, ~, ~,...
        frNRTMeanAlignedScaled_i, frNRTCI95AlignedScaled_i] = frAlign(interictalInterp, frNRT, tInterp);
    [frNRTMeanAlignedLarge_i, frNRTCI95AlignedLarge_i, ~, ~,...
        frNRTMeanAlignedScaledLarge_i, frNRTCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frNRT, tInterp);
    [frNRT2MeanAligned_i, frNRT2CI95Aligned_i, ~, ~,...
        frNRT2MeanAlignedScaled_i, frNRT2CI95AlignedScaled_i] = frAlign(interictalInterp, frNRT2, tInterp);
    [frNRT2MeanAlignedLarge_i, frNRT2CI95AlignedLarge_i, ~, ~,...
        frNRT2MeanAlignedScaledLarge_i, frNRT2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frNRT2, tInterp);
    [frTCMeanAligned_i, frTCCI95Aligned_i, ~, ~,...
        frTCMeanAlignedScaled_i, frTCCI95AlignedScaled_i] = frAlign(interictalInterp, frTC, tInterp);
    [frTCMeanAlignedLarge_i, frTCCI95AlignedLarge_i, ~, ~,...
        frTCMeanAlignedScaledLarge_i, frTCCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frTC, tInterp);
    [frTC2MeanAligned_i, frTC2CI95Aligned_i, ~, ~,...
        frTC2MeanAlignedScaled_i, frTC2CI95AlignedScaled_i] = frAlign(interictalInterp, frTC2, tInterp);
    [frTC2MeanAlignedLarge_i, frTC2CI95AlignedLarge_i, ~, ~,...
        frTC2MeanAlignedScaledLarge_i, frTC2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, frTC2, tInterp);
    
    frMeanAlignedScaled_i = [frCx23MeanAlignedScaled_i; frCx23iMeanAlignedScaled_i; frCx4MeanAlignedScaled_i; frCx4iMeanAlignedScaled_i;...
        frCx5MeanAlignedScaled_i; frCx5iMeanAlignedScaled_i; frCx6MeanAlignedScaled_i; frCx6iMeanAlignedScaled_i;
        frNRTMeanAlignedScaled_i; frNRT2MeanAlignedScaled_i; frTCMeanAlignedScaled_i; frTC2MeanAlignedScaled_i];
    frCI95AlignedScaled_i = [frCx23CI95AlignedScaled_i; frCx23iCI95AlignedScaled_i; frCx4CI95AlignedScaled_i; frCx4iCI95AlignedScaled_i;...
        frCx5CI95AlignedScaled_i; frCx5iCI95AlignedScaled_i; frCx6CI95AlignedScaled_i; frCx6iCI95AlignedScaled_i;
        frNRTCI95AlignedScaled_i; frNRT2CI95AlignedScaled_i; frTCCI95AlignedScaled_i; frTC2CI95AlignedScaled_i];
    colours = [cellColour('Cx23'); cellColour('Cx23i'); cellColour('Cx4'); cellColour('Cx4i'); cellColour('Cx5'); cellColour('Cx5i');...
        cellColour('Cx6'); cellColour('Cx6i'); cellColour('NRT'); cellColour('NRT2'); cellColour('TC'); cellColour('TC2')];
    lineTypes = {'-','-','-','-','-','-','-','-','-','-','-','-'};
    legendEntries = {'L2/3 PY', 'L2/3 IN', 'L4 PY', 'L4 IN', 'L5 PY', 'L5 IN', 'L6 PY', 'L6 IN', 'NRT_F_O', 'NRT_H_O', 'TC_F_O', 'TC_H_O'};
    fFR = frAlignPlot(frMeanAlignedScaled_i, frCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i, colours, lineTypes, 'APs/sec',...
        legendEntries, 'Total firing');
    
    [trAllMeanAligned_i, trAllCI95Aligned_i, tStartAligned_i, tEndAligned_i,...
        trAllMeanAlignedScaled_i, trAllCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i] = frAlign(interictalInterp, trAll, tInterp);
    [trAllMeanAlignedLarge_i, trAllCI95AlignedLarge_i, tStartAlignedLarge_i, tEndAlignedLarge_i,...
        trAllMeanAlignedScaledLarge_i, trAllCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trAll, tInterp);
    [trCx23MeanAligned_i, trCx23CI95Aligned_i, ~, ~,...
        trCx23MeanAlignedScaled_i, trCx23CI95AlignedScaled_i] = frAlign(interictalInterp, trCx23, tInterp);
    [trCx23MeanAlignedLarge_i, trCx23CI95AlignedLarge_i, ~, ~,...
        trCx23MeanAlignedScaledLarge_i, trCx23CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trCx23, tInterp);
    [trCx23iMeanAligned_i, trCx23iCI95Aligned_i, ~, ~,...
        trCx23iMeanAlignedScaled_i, trCx23iCI95AlignedScaled_i] = frAlign(interictalInterp, trCx23i, tInterp);
    [trCx23iMeanAlignedLarge_i, trCx23iCI95AlignedLarge_i, ~, ~,...
        trCx23iMeanAlignedScaledLarge_i, trCx23iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trCx23i, tInterp);
    [trCx4MeanAligned_i, trCx4CI95Aligned_i, ~, ~,...
        trCx4MeanAlignedScaled_i, trCx4CI95AlignedScaled_i] = frAlign(interictalInterp, trCx4, tInterp);
    [trCx4MeanAlignedLarge_i, trCx4CI95AlignedLarge_i, ~, ~,...
        trCx4MeanAlignedScaledLarge_i, trCx4CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trCx4, tInterp);
    [trCx4iMeanAligned_i, trCx4iCI95Aligned_i, ~, ~,...
        trCx4iMeanAlignedScaled_i, trCx4iCI95AlignedScaled_i] = frAlign(interictalInterp, trCx4i, tInterp);
    [trCx4iMeanAlignedLarge_i, trCx4iCI95AlignedLarge_i, ~, ~,...
        trCx4iMeanAlignedScaledLarge_i, trCx4iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trCx4i, tInterp);
    [trCx5MeanAligned_i, trCx5CI95Aligned_i, ~, ~,...
        trCx5MeanAlignedScaled_i, trCx5CI95AlignedScaled_i] = frAlign(interictalInterp, trCx5, tInterp);
    [trCx5MeanAlignedLarge_i, trCx5CI95AlignedLarge_i, ~, ~,...
        trCx5MeanAlignedScaledLarge_i, trCx5CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trCx5, tInterp);
    [trCx5iMeanAligned_i, trCx5iCI95Aligned_i, ~, ~,...
        trCx5iMeanAlignedScaled_i, trCx5iCI95AlignedScaled_i] = frAlign(interictalInterp, trCx5i, tInterp);
    [trCx5iMeanAlignedLarge_i, trCx5iCI95AlignedLarge_i, ~, ~,...
        trCx5iMeanAlignedScaledLarge_i, trCx5iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trCx5i, tInterp);
    [trCx6MeanAligned_i, trCx6CI95Aligned_i, ~, ~,...
        trCx6MeanAlignedScaled_i, trCx6CI95AlignedScaled_i] = frAlign(interictalInterp, trCx6, tInterp);
    [trCx6MeanAlignedLarge_i, trCx6CI95AlignedLarge_i, ~, ~,...
        trCx6MeanAlignedScaledLarge_i, trCx6CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trCx6, tInterp);
    [trCx6iMeanAligned_i, trCx6iCI95Aligned_i, ~, ~,...
        trCx6iMeanAlignedScaled_i, trCx6iCI95AlignedScaled_i] = frAlign(interictalInterp, trCx6i, tInterp);
    [trCx6iMeanAlignedLarge_i, trCx6iCI95AlignedLarge_i, ~, ~,...
        trCx6iMeanAlignedScaledLarge_i, trCx6iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trCx6i, tInterp);
    [trNRTMeanAligned_i, trNRTCI95Aligned_i, ~, ~,...
        trNRTMeanAlignedScaled_i, trNRTCI95AlignedScaled_i] = frAlign(interictalInterp, trNRT, tInterp);
    [trNRTMeanAlignedLarge_i, trNRTCI95AlignedLarge_i, ~, ~,...
        trNRTMeanAlignedScaledLarge_i, trNRTCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trNRT, tInterp);
    [trNRT2MeanAligned_i, trNRT2CI95Aligned_i, ~, ~,...
        trNRT2MeanAlignedScaled_i, trNRT2CI95AlignedScaled_i] = frAlign(interictalInterp, trNRT2, tInterp);
    [trNRT2MeanAlignedLarge_i, trNRT2CI95AlignedLarge_i, ~, ~,...
        trNRT2MeanAlignedScaledLarge_i, trNRT2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trNRT2, tInterp);
    [trTCMeanAligned_i, trTCCI95Aligned_i, ~, ~,...
        trTCMeanAlignedScaled_i, trTCCI95AlignedScaled_i] = frAlign(interictalInterp, trTC, tInterp);
    [trTCMeanAlignedLarge_i, trTCCI95AlignedLarge_i, ~, ~,...
        trTCMeanAlignedScaledLarge_i, trTCCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trTC, tInterp);
    [trTC2MeanAligned_i, trTC2CI95Aligned_i, ~, ~,...
        trTC2MeanAlignedScaled_i, trTC2CI95AlignedScaled_i] = frAlign(interictalInterp, trTC2, tInterp);
    [trTC2MeanAlignedLarge_i, trTC2CI95AlignedLarge_i, ~, ~,...
        trTC2MeanAlignedScaledLarge_i, trTC2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, trTC2, tInterp);
    
    trMeanAlignedScaled_i = [trCx23MeanAlignedScaled_i; trCx23iMeanAlignedScaled_i; trCx4MeanAlignedScaled_i; trCx4iMeanAlignedScaled_i;...
        trCx5MeanAlignedScaled_i; trCx5iMeanAlignedScaled_i; trCx6MeanAlignedScaled_i; trCx6iMeanAlignedScaled_i;
        trNRTMeanAlignedScaled_i; trNRT2MeanAlignedScaled_i; trTCMeanAlignedScaled_i; trTC2MeanAlignedScaled_i];
    trCI95AlignedScaled_i = [trCx23CI95AlignedScaled_i; trCx23iCI95AlignedScaled_i; trCx4CI95AlignedScaled_i; trCx4iCI95AlignedScaled_i;...
        trCx5CI95AlignedScaled_i; trCx5iCI95AlignedScaled_i; trCx6CI95AlignedScaled_i; trCx6iCI95AlignedScaled_i;
        trNRTCI95AlignedScaled_i; trNRT2CI95AlignedScaled_i; trTCCI95AlignedScaled_i; trTC2CI95AlignedScaled_i];
    fTR = frAlignPlot(trMeanAlignedScaled_i, trCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i, colours, lineTypes, 'APs/sec',...
        legendEntries, 'Tonic firing');
    
    [brAllMeanAligned_i, brAllCI95Aligned_i, tStartAligned_i, tEndAligned_i,...
        brAllMeanAlignedScaled_i, brAllCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i] = frAlign(interictalInterp, brAll, tInterp);
    [brAllMeanAlignedLarge_i, brAllCI95AlignedLarge_i, tStartAlignedLarge_i, tEndAlignedLarge_i,...
        brAllMeanAlignedScaledLarge_i, brAllCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brAll, tInterp);
    [brCx23MeanAligned_i, brCx23CI95Aligned_i, ~, ~,...
        brCx23MeanAlignedScaled_i, brCx23CI95AlignedScaled_i] = frAlign(interictalInterp, brCx23, tInterp);
    [brCx23MeanAlignedLarge_i, brCx23CI95AlignedLarge_i, ~, ~,...
        brCx23MeanAlignedScaledLarge_i, brCx23CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brCx23, tInterp);
    [brCx23iMeanAligned_i, brCx23iCI95Aligned_i, ~, ~,...
        brCx23iMeanAlignedScaled_i, brCx23iCI95AlignedScaled_i] = frAlign(interictalInterp, brCx23i, tInterp);
    [brCx23iMeanAlignedLarge_i, brCx23iCI95AlignedLarge_i, ~, ~,...
        brCx23iMeanAlignedScaledLarge_i, brCx23iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brCx23i, tInterp);
    [brCx4MeanAligned_i, brCx4CI95Aligned_i, ~, ~,...
        brCx4MeanAlignedScaled_i, brCx4CI95AlignedScaled_i] = frAlign(interictalInterp, brCx4, tInterp);
    [brCx4MeanAlignedLarge_i, brCx4CI95AlignedLarge_i, ~, ~,...
        brCx4MeanAlignedScaledLarge_i, brCx4CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brCx4, tInterp);
    [brCx4iMeanAligned_i, brCx4iCI95Aligned_i, ~, ~,...
        brCx4iMeanAlignedScaled_i, brCx4iCI95AlignedScaled_i] = frAlign(interictalInterp, brCx4i, tInterp);
    [brCx4iMeanAlignedLarge_i, brCx4iCI95AlignedLarge_i, ~, ~,...
        brCx4iMeanAlignedScaledLarge_i, brCx4iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brCx4i, tInterp);
    [brCx5MeanAligned_i, brCx5CI95Aligned_i, ~, ~,...
        brCx5MeanAlignedScaled_i, brCx5CI95AlignedScaled_i] = frAlign(interictalInterp, brCx5, tInterp);
    [brCx5MeanAlignedLarge_i, brCx5CI95AlignedLarge_i, ~, ~,...
        brCx5MeanAlignedScaledLarge_i, brCx5CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brCx5, tInterp);
    [brCx5iMeanAligned_i, brCx5iCI95Aligned_i, ~, ~,...
        brCx5iMeanAlignedScaled_i, brCx5iCI95AlignedScaled_i] = frAlign(interictalInterp, brCx5i, tInterp);
    [brCx5iMeanAlignedLarge_i, brCx5iCI95AlignedLarge_i, ~, ~,...
        brCx5iMeanAlignedScaledLarge_i, brCx5iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brCx5i, tInterp);
    [brCx6MeanAligned_i, brCx6CI95Aligned_i, ~, ~,...
        brCx6MeanAlignedScaled_i, brCx6CI95AlignedScaled_i] = frAlign(interictalInterp, brCx6, tInterp);
    [brCx6MeanAlignedLarge_i, brCx6CI95AlignedLarge_i, ~, ~,...
        brCx6MeanAlignedScaledLarge_i, brCx6CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brCx6, tInterp);
    [brCx6iMeanAligned_i, brCx6iCI95Aligned_i, ~, ~,...
        brCx6iMeanAlignedScaled_i, brCx6iCI95AlignedScaled_i] = frAlign(interictalInterp, brCx6i, tInterp);
    [brCx6iMeanAlignedLarge_i, brCx6iCI95AlignedLarge_i, ~, ~,...
        brCx6iMeanAlignedScaledLarge_i, brCx6iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brCx6i, tInterp);
    [brNRTMeanAligned_i, brNRTCI95Aligned_i, ~, ~,...
        brNRTMeanAlignedScaled_i, brNRTCI95AlignedScaled_i] = frAlign(interictalInterp, brNRT, tInterp);
    [brNRTMeanAlignedLarge_i, brNRTCI95AlignedLarge_i, ~, ~,...
        brNRTMeanAlignedScaledLarge_i, brNRTCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brNRT, tInterp);
    [brNRT2MeanAligned_i, brNRT2CI95Aligned_i, ~, ~,...
        brNRT2MeanAlignedScaled_i, brNRT2CI95AlignedScaled_i] = frAlign(interictalInterp, brNRT2, tInterp);
    [brNRT2MeanAlignedLarge_i, brNRT2CI95AlignedLarge_i, ~, ~,...
        brNRT2MeanAlignedScaledLarge_i, brNRT2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brNRT2, tInterp);
    [brTCMeanAligned_i, brTCCI95Aligned_i, ~, ~,...
        brTCMeanAlignedScaled_i, brTCCI95AlignedScaled_i] = frAlign(interictalInterp, brTC, tInterp);
    [brTCMeanAlignedLarge_i, brTCCI95AlignedLarge_i, ~, ~,...
        brTCMeanAlignedScaledLarge_i, brTCCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brTC, tInterp);
    [brTC2MeanAligned_i, brTC2CI95Aligned_i, ~, ~,...
        brTC2MeanAlignedScaled_i, brTC2CI95AlignedScaled_i] = frAlign(interictalInterp, brTC2, tInterp);
    [brTC2MeanAlignedLarge_i, brTC2CI95AlignedLarge_i, ~, ~,...
        brTC2MeanAlignedScaledLarge_i, brTC2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, brTC2, tInterp);
    
    brMeanAlignedScaled_i = [brCx23MeanAlignedScaled_i; brCx23iMeanAlignedScaled_i; brCx4MeanAlignedScaled_i; brCx4iMeanAlignedScaled_i;...
        brCx5MeanAlignedScaled_i; brCx5iMeanAlignedScaled_i; brCx6MeanAlignedScaled_i; brCx6iMeanAlignedScaled_i;
        brNRTMeanAlignedScaled_i; brNRT2MeanAlignedScaled_i; brTCMeanAlignedScaled_i; brTC2MeanAlignedScaled_i];
    brCI95AlignedScaled_i = [brCx23CI95AlignedScaled_i; brCx23iCI95AlignedScaled_i; brCx4CI95AlignedScaled_i; brCx4iCI95AlignedScaled_i;...
        brCx5CI95AlignedScaled_i; brCx5iCI95AlignedScaled_i; brCx6CI95AlignedScaled_i; brCx6iCI95AlignedScaled_i;
        brNRTCI95AlignedScaled_i; brNRT2CI95AlignedScaled_i; brTCCI95AlignedScaled_i; brTC2CI95AlignedScaled_i];
    fBR = frAlignPlot(brMeanAlignedScaled_i, brCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i, colours, lineTypes, 'Bursts/sec',...
        legendEntries, 'Burst firing');
    
    [br2AllMeanAligned_i, br2AllCI95Aligned_i, tStartAligned_i, tEndAligned_i,...
        br2AllMeanAlignedScaled_i, br2AllCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i] = frAlign(interictalInterp, br2All, tInterp);
    [br2AllMeanAlignedLarge_i, br2AllCI95AlignedLarge_i, tStartAlignedLarge_i, tEndAlignedLarge_i,...
        br2AllMeanAlignedScaledLarge_i, br2AllCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2All, tInterp);
    [br2Cx23MeanAligned_i, br2Cx23CI95Aligned_i, ~, ~,...
        br2Cx23MeanAlignedScaled_i, br2Cx23CI95AlignedScaled_i] = frAlign(interictalInterp, br2Cx23, tInterp);
    [br2Cx23MeanAlignedLarge_i, br2Cx23CI95AlignedLarge_i, ~, ~,...
        br2Cx23MeanAlignedScaledLarge_i, br2Cx23CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2Cx23, tInterp);
    [br2Cx23iMeanAligned_i, br2Cx23iCI95Aligned_i, ~, ~,...
        br2Cx23iMeanAlignedScaled_i, br2Cx23iCI95AlignedScaled_i] = frAlign(interictalInterp, br2Cx23i, tInterp);
    [br2Cx23iMeanAlignedLarge_i, br2Cx23iCI95AlignedLarge_i, ~, ~,...
        br2Cx23iMeanAlignedScaledLarge_i, br2Cx23iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2Cx23i, tInterp);
    [br2Cx4MeanAligned_i, br2Cx4CI95Aligned_i, ~, ~,...
        br2Cx4MeanAlignedScaled_i, br2Cx4CI95AlignedScaled_i] = frAlign(interictalInterp, br2Cx4, tInterp);
    [br2Cx4MeanAlignedLarge_i, br2Cx4CI95AlignedLarge_i, ~, ~,...
        br2Cx4MeanAlignedScaledLarge_i, br2Cx4CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2Cx4, tInterp);
    [br2Cx4iMeanAligned_i, br2Cx4iCI95Aligned_i, ~, ~,...
        br2Cx4iMeanAlignedScaled_i, br2Cx4iCI95AlignedScaled_i] = frAlign(interictalInterp, br2Cx4i, tInterp);
    [br2Cx4iMeanAlignedLarge_i, br2Cx4iCI95AlignedLarge_i, ~, ~,...
        br2Cx4iMeanAlignedScaledLarge_i, br2Cx4iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2Cx4i, tInterp);
    [br2Cx5MeanAligned_i, br2Cx5CI95Aligned_i, ~, ~,...
        br2Cx5MeanAlignedScaled_i, br2Cx5CI95AlignedScaled_i] = frAlign(interictalInterp, br2Cx5, tInterp);
    [br2Cx5MeanAlignedLarge_i, br2Cx5CI95AlignedLarge_i, ~, ~,...
        br2Cx5MeanAlignedScaledLarge_i, br2Cx5CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2Cx5, tInterp);
    [br2Cx5iMeanAligned_i, br2Cx5iCI95Aligned_i, ~, ~,...
        br2Cx5iMeanAlignedScaled_i, br2Cx5iCI95AlignedScaled_i] = frAlign(interictalInterp, br2Cx5i, tInterp);
    [br2Cx5iMeanAlignedLarge_i, br2Cx5iCI95AlignedLarge_i, ~, ~,...
        br2Cx5iMeanAlignedScaledLarge_i, br2Cx5iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2Cx5i, tInterp);
    [br2Cx6MeanAligned_i, br2Cx6CI95Aligned_i, ~, ~,...
        br2Cx6MeanAlignedScaled_i, br2Cx6CI95AlignedScaled_i] = frAlign(interictalInterp, br2Cx6, tInterp);
    [br2Cx6MeanAlignedLarge_i, br2Cx6CI95AlignedLarge_i, ~, ~,...
        br2Cx6MeanAlignedScaledLarge_i, br2Cx6CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2Cx6, tInterp);
    [br2Cx6iMeanAligned_i, br2Cx6iCI95Aligned_i, ~, ~,...
        br2Cx6iMeanAlignedScaled_i, br2Cx6iCI95AlignedScaled_i] = frAlign(interictalInterp, br2Cx6i, tInterp);
    [br2Cx6iMeanAlignedLarge_i, br2Cx6iCI95AlignedLarge_i, ~, ~,...
        br2Cx6iMeanAlignedScaledLarge_i, br2Cx6iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2Cx6i, tInterp);
    [br2NRTMeanAligned_i, br2NRTCI95Aligned_i, ~, ~,...
        br2NRTMeanAlignedScaled_i, br2NRTCI95AlignedScaled_i] = frAlign(interictalInterp, br2NRT, tInterp);
    [br2NRTMeanAlignedLarge_i, br2NRTCI95AlignedLarge_i, ~, ~,...
        br2NRTMeanAlignedScaledLarge_i, br2NRTCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2NRT, tInterp);
    [br2NRT2MeanAligned_i, br2NRT2CI95Aligned_i, ~, ~,...
        br2NRT2MeanAlignedScaled_i, br2NRT2CI95AlignedScaled_i] = frAlign(interictalInterp, br2NRT2, tInterp);
    [br2NRT2MeanAlignedLarge_i, br2NRT2CI95AlignedLarge_i, ~, ~,...
        br2NRT2MeanAlignedScaledLarge_i, br2NRT2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2NRT2, tInterp);
    [br2TCMeanAligned_i, br2TCCI95Aligned_i, ~, ~,...
        br2TCMeanAlignedScaled_i, br2TCCI95AlignedScaled_i] = frAlign(interictalInterp, br2TC, tInterp);
    [br2TCMeanAlignedLarge_i, br2TCCI95AlignedLarge_i, ~, ~,...
        br2TCMeanAlignedScaledLarge_i, br2TCCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2TC, tInterp);
    [br2TC2MeanAligned_i, br2TC2CI95Aligned_i, ~, ~,...
        br2TC2MeanAlignedScaled_i, br2TC2CI95AlignedScaled_i] = frAlign(interictalInterp, br2TC2, tInterp);
    [br2TC2MeanAlignedLarge_i, br2TC2CI95AlignedLarge_i, ~, ~,...
        br2TC2MeanAlignedScaledLarge_i, br2TC2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, br2TC2, tInterp);
    
    br2MeanAlignedScaled_i = [br2Cx23MeanAlignedScaled_i; br2Cx23iMeanAlignedScaled_i; br2Cx4MeanAlignedScaled_i; br2Cx4iMeanAlignedScaled_i;...
        br2Cx5MeanAlignedScaled_i; br2Cx5iMeanAlignedScaled_i; br2Cx6MeanAlignedScaled_i; br2Cx6iMeanAlignedScaled_i;
        br2NRTMeanAlignedScaled_i; br2NRT2MeanAlignedScaled_i; br2TCMeanAlignedScaled_i; br2TC2MeanAlignedScaled_i];
    br2CI95AlignedScaled_i = [br2Cx23CI95AlignedScaled_i; br2Cx23iCI95AlignedScaled_i; br2Cx4CI95AlignedScaled_i; br2Cx4iCI95AlignedScaled_i;...
        br2Cx5CI95AlignedScaled_i; br2Cx5iCI95AlignedScaled_i; br2Cx6CI95AlignedScaled_i; br2Cx6iCI95AlignedScaled_i;
        br2NRTCI95AlignedScaled_i; br2NRT2CI95AlignedScaled_i; br2TCCI95AlignedScaled_i; br2TC2CI95AlignedScaled_i];
    fBR2 = frAlignPlot(br2MeanAlignedScaled_i, br2CI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i, colours, lineTypes,...
        'APs/burst', legendEntries, 'Burst firing in detail');
    
    save('frData.mat', 'frMeanAlignedScaled','frCI95AlignedScaled','trMeanAlignedScaled',...
        'trCI95AlignedScaled','brMeanAlignedScaled','brCI95AlignedScaled','br2MeanAlignedScaled',...
        'br2CI95AlignedScaled','tStartAlignedScaled','tEndAlignedScaled','frMeanAlignedScaled_i',...
        'frCI95AlignedScaled_i','trMeanAlignedScaled_i','trCI95AlignedScaled_i','brMeanAlignedScaled_i',...
        'brCI95AlignedScaled_i','br2MeanAlignedScaled_i','br2CI95AlignedScaled_i','tStartAlignedScaled_i',...
        'tEndAlignedScaled_i', '-append');
end

if psi && ~fullRun
    SWDsInterp = interp1(t, SWDs, tInterp, 'linear', 'extrap');
    SWDsLargeInterp = interp1(t, SWDsLarge, tInterp, 'linear', 'extrap');
    [psiAllMeanAligned, psiAllCI95Aligned, tStartAligned, tEndAligned,...
        psiAllMeanAlignedScaled, psiAllCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled] = frAlign(SWDsInterp, psiAll_t, tInterp);
    [psiAllMeanAlignedLarge, psiAllCI95AlignedLarge, tStartAlignedLarge, tEndAlignedLarge,...
        psiAllMeanAlignedScaledLarge, psiAllCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiAll_t, tInterp);
    [psiCx23MeanAligned, psiCx23CI95Aligned, ~, ~,...
        psiCx23MeanAlignedScaled, psiCx23CI95AlignedScaled] = frAlign(SWDsInterp, psiCx23_t, tInterp);
    [psiCx23MeanAlignedLarge, psiCx23CI95AlignedLarge, ~, ~,...
        psiCx23MeanAlignedScaledLarge, psiCx23CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiCx23_t, tInterp);
    [psiCx23iMeanAligned, psiCx23iCI95Aligned, ~, ~,...
        psiCx23iMeanAlignedScaled, psiCx23iCI95AlignedScaled] = frAlign(SWDsInterp, psiCx23i_t, tInterp);
    [psiCx23iMeanAlignedLarge, psiCx23iCI95AlignedLarge, ~, ~,...
        psiCx23iMeanAlignedScaledLarge, psiCx23iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiCx23i_t, tInterp);
    [psiCx4MeanAligned, psiCx4CI95Aligned, ~, ~,...
        psiCx4MeanAlignedScaled, psiCx4CI95AlignedScaled] = frAlign(SWDsInterp, psiCx4_t, tInterp);
    [psiCx4MeanAlignedLarge, psiCx4CI95AlignedLarge, ~, ~,...
        psiCx4MeanAlignedScaledLarge, psiCx4CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiCx4_t, tInterp);
    [psiCx4iMeanAligned, psiCx4iCI95Aligned, ~, ~,...
        psiCx4iMeanAlignedScaled, psiCx4iCI95AlignedScaled] = frAlign(SWDsInterp, psiCx4i_t, tInterp);
    [psiCx4iMeanAlignedLarge, psiCx4iCI95AlignedLarge, ~, ~,...
        psiCx4iMeanAlignedScaledLarge, psiCx4iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiCx4i_t, tInterp);
    [psiCx5MeanAligned, psiCx5CI95Aligned, ~, ~,...
        psiCx5MeanAlignedScaled, psiCx5CI95AlignedScaled] = frAlign(SWDsInterp, psiCx5_t, tInterp);
    [psiCx5MeanAlignedLarge, psiCx5CI95AlignedLarge, ~, ~,...
        psiCx5MeanAlignedScaledLarge, psiCx5CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiCx5_t, tInterp);
    [psiCx5iMeanAligned, psiCx5iCI95Aligned, ~, ~,...
        psiCx5iMeanAlignedScaled, psiCx5iCI95AlignedScaled] = frAlign(SWDsInterp, psiCx5i_t, tInterp);
    [psiCx5iMeanAlignedLarge, psiCx5iCI95AlignedLarge, ~, ~,...
        psiCx5iMeanAlignedScaledLarge, psiCx5iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiCx5i_t, tInterp);
    [psiCx6MeanAligned, psiCx6CI95Aligned, ~, ~,...
        psiCx6MeanAlignedScaled, psiCx6CI95AlignedScaled] = frAlign(SWDsInterp, psiCx6_t, tInterp);
    [psiCx6MeanAlignedLarge, psiCx6CI95AlignedLarge, ~, ~,...
        psiCx6MeanAlignedScaledLarge, psiCx6CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiCx6_t, tInterp);
    [psiCx6iMeanAligned, psiCx6iCI95Aligned, ~, ~,...
        psiCx6iMeanAlignedScaled, psiCx6iCI95AlignedScaled] = frAlign(SWDsInterp, psiCx6i_t, tInterp);
    [psiCx6iMeanAlignedLarge, psiCx6iCI95AlignedLarge, ~, ~,...
        psiCx6iMeanAlignedScaledLarge, psiCx6iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiCx6i_t, tInterp);
    [psiNRTMeanAligned, psiNRTCI95Aligned, ~, ~,...
        psiNRTMeanAlignedScaled, psiNRTCI95AlignedScaled] = frAlign(SWDsInterp, psiNRT_t, tInterp);
    [psiNRTMeanAlignedLarge, psiNRTCI95AlignedLarge, ~, ~,...
        psiNRTMeanAlignedScaledLarge, psiNRTCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiNRT_t, tInterp);
    [psiNRT2MeanAligned, psiNRT2CI95Aligned, ~, ~,...
        psiNRT2MeanAlignedScaled, psiNRT2CI95AlignedScaled] = frAlign(SWDsInterp, psiNRT2_t, tInterp);
    [psiNRT2MeanAlignedLarge, psiNRT2CI95AlignedLarge, ~, ~,...
        psiNRT2MeanAlignedScaledLarge, psiNRT2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiNRT2_t, tInterp);
    [psiTCMeanAligned, psiTCCI95Aligned, ~, ~,...
        psiTCMeanAlignedScaled, psiTCCI95AlignedScaled] = frAlign(SWDsInterp, psiTC_t, tInterp);
    [psiTCMeanAlignedLarge, psiTCCI95AlignedLarge, ~, ~,...
        psiTCMeanAlignedScaledLarge, psiTCCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiTC_t, tInterp);
    [psiTC2MeanAligned, psiTC2CI95Aligned, ~, ~,...
        psiTC2MeanAlignedScaled, psiTC2CI95AlignedScaled] = frAlign(SWDsInterp, psiTC2_t, tInterp);
    [psiTC2MeanAlignedLarge, psiTC2CI95AlignedLarge, ~, ~,...
        psiTC2MeanAlignedScaledLarge, psiTC2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiTC2_t, tInterp);
    
    psiMeanAlignedScaled = [psiCx23MeanAlignedScaled; psiCx23iMeanAlignedScaled; psiCx4MeanAlignedScaled; psiCx4iMeanAlignedScaled;...
        psiCx5MeanAlignedScaled; psiCx5iMeanAlignedScaled; psiCx6MeanAlignedScaled; psiCx6iMeanAlignedScaled;
        psiNRTMeanAlignedScaled; psiNRT2MeanAlignedScaled; psiTCMeanAlignedScaled; psiTC2MeanAlignedScaled];
    psiCI95AlignedScaled = [psiCx23CI95AlignedScaled; psiCx23iCI95AlignedScaled; psiCx4CI95AlignedScaled; psiCx4iCI95AlignedScaled;...
        psiCx5CI95AlignedScaled; psiCx5iCI95AlignedScaled; psiCx6CI95AlignedScaled; psiCx6iCI95AlignedScaled;
        psiNRTCI95AlignedScaled; psiNRT2CI95AlignedScaled; psiTCCI95AlignedScaled; psiTC2CI95AlignedScaled];
    colours = [cellColour('Cx23'); cellColour('Cx23i'); cellColour('Cx4'); cellColour('Cx4i'); cellColour('Cx5'); cellColour('Cx5i');...
        cellColour('Cx6'); cellColour('Cx6i'); cellColour('NRT'); cellColour('NRT2'); cellColour('TC'); cellColour('TC2')];
    lineTypes = {'-','-','-','-','-','-','-','-','-','-','-','-'};
    legendEntries = {'L2/3 PY', 'L2/3 IN', 'L4 PY', 'L4 IN', 'L5 PY', 'L5 IN', 'L6 PY', 'L6 IN', 'NRT_F_O', 'NRT_H_O', 'TC_F_O', 'TC_H_O'};
    fPSI = frAlignPlot(psiMeanAlignedScaled, psiCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled, colours, lineTypes, 'PSI',...
        legendEntries, 'V_M PSI');
    
    [phaseDiffAllMeanAligned, phaseDiffAllCI95Aligned, tStartAligned, tEndAligned,...
        phaseDiffAllMeanAlignedScaled, phaseDiffAllCI95AlignedScaled, tStartAlignedScaled,...
        tEndAlignedScaled] = frAlign(SWDsInterp, phaseDiffAll, tInterp, 'circularNP');
    [phaseDiffAllMeanAlignedLarge, phaseDiffAllCI95AlignedLarge, tStartAlignedLarge, tEndAlignedLarge,...
        phaseDiffAllMeanAlignedScaledLarge, phaseDiffAllCI95AlignedScaledLarge, tStartAlignedScaledLarge,...
        tEndAlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffAll, tInterp, 'circularNP');
    [phaseDiffCx23MeanAligned, phaseDiffCx23CI95Aligned, ~, ~,...
        phaseDiffCx23MeanAlignedScaled, phaseDiffCx23CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffCx23, tInterp, 'circularNP');
    [phaseDiffCx23MeanAlignedLarge, phaseDiffCx23CI95AlignedLarge, ~, ~,...
        phaseDiffCx23MeanAlignedScaledLarge, phaseDiffCx23CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffCx23, tInterp, 'circularNP');
    [phaseDiffCx23iMeanAligned, phaseDiffCx23iCI95Aligned, ~, ~,...
        phaseDiffCx23iMeanAlignedScaled, phaseDiffCx23iCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffCx23i, tInterp, 'circularNP');
    [phaseDiffCx23iMeanAlignedLarge, phaseDiffCx23iCI95AlignedLarge, ~, ~,...
        phaseDiffCx23iMeanAlignedScaledLarge, phaseDiffCx23iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffCx23i, tInterp, 'circularNP');
    [phaseDiffCx4MeanAligned, phaseDiffCx4CI95Aligned, ~, ~,...
        phaseDiffCx4MeanAlignedScaled, phaseDiffCx4CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffCx4, tInterp, 'circularNP');
    [phaseDiffCx4MeanAlignedLarge, phaseDiffCx4CI95AlignedLarge, ~, ~,...
        phaseDiffCx4MeanAlignedScaledLarge, phaseDiffCx4CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffCx4, tInterp, 'circularNP');
    [phaseDiffCx4iMeanAligned, phaseDiffCx4iCI95Aligned, ~, ~,...
        phaseDiffCx4iMeanAlignedScaled, phaseDiffCx4iCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffCx4i, tInterp, 'circularNP');
    [phaseDiffCx4iMeanAlignedLarge, phaseDiffCx4iCI95AlignedLarge, ~, ~,...
        phaseDiffCx4iMeanAlignedScaledLarge, phaseDiffCx4iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffCx4i, tInterp, 'circularNP');
    [phaseDiffCx5MeanAligned, phaseDiffCx5CI95Aligned, ~, ~,...
        phaseDiffCx5MeanAlignedScaled, phaseDiffCx5CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffCx5, tInterp, 'circularNP');
    [phaseDiffCx5MeanAlignedLarge, phaseDiffCx5CI95AlignedLarge, ~, ~,...
        phaseDiffCx5MeanAlignedScaledLarge, phaseDiffCx5CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffCx5, tInterp, 'circularNP');
    [phaseDiffCx5iMeanAligned, phaseDiffCx5iCI95Aligned, ~, ~,...
        phaseDiffCx5iMeanAlignedScaled, phaseDiffCx5iCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffCx5i, tInterp, 'circularNP');
    [phaseDiffCx5iMeanAlignedLarge, phaseDiffCx5iCI95AlignedLarge, ~, ~,...
        phaseDiffCx5iMeanAlignedScaledLarge, phaseDiffCx5iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffCx5i, tInterp, 'circularNP');
    [phaseDiffCx6MeanAligned, phaseDiffCx6CI95Aligned, ~, ~,...
        phaseDiffCx6MeanAlignedScaled, phaseDiffCx6CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffCx6, tInterp, 'circularNP');
    [phaseDiffCx6MeanAlignedLarge, phaseDiffCx6CI95AlignedLarge, ~, ~,...
        phaseDiffCx6MeanAlignedScaledLarge, phaseDiffCx6CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffCx6, tInterp, 'circularNP');
    [phaseDiffCx6iMeanAligned, phaseDiffCx6iCI95Aligned, ~, ~,...
        phaseDiffCx6iMeanAlignedScaled, phaseDiffCx6iCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffCx6i, tInterp, 'circularNP');
    [phaseDiffCx6iMeanAlignedLarge, phaseDiffCx6iCI95AlignedLarge, ~, ~,...
        phaseDiffCx6iMeanAlignedScaledLarge, phaseDiffCx6iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffCx6i, tInterp, 'circularNP');
    [phaseDiffNRTMeanAligned, phaseDiffNRTCI95Aligned, ~, ~,...
        phaseDiffNRTMeanAlignedScaled, phaseDiffNRTCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffNRT, tInterp, 'circularNP');
    [phaseDiffNRTMeanAlignedLarge, phaseDiffNRTCI95AlignedLarge, ~, ~,...
        phaseDiffNRTMeanAlignedScaledLarge, phaseDiffNRTCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffNRT, tInterp, 'circularNP');
    [phaseDiffNRT2MeanAligned, phaseDiffNRT2CI95Aligned, ~, ~,...
        phaseDiffNRT2MeanAlignedScaled, phaseDiffNRT2CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffNRT2, tInterp, 'circularNP');
    [phaseDiffNRT2MeanAlignedLarge, phaseDiffNRT2CI95AlignedLarge, ~, ~,...
        phaseDiffNRT2MeanAlignedScaledLarge, phaseDiffNRT2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffNRT2, tInterp, 'circularNP');
    [phaseDiffTCMeanAligned, phaseDiffTCCI95Aligned, ~, ~,...
        phaseDiffTCMeanAlignedScaled, phaseDiffTCCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffTC, tInterp, 'circularNP');
    [phaseDiffTCMeanAlignedLarge, phaseDiffTCCI95AlignedLarge, ~, ~,...
        phaseDiffTCMeanAlignedScaledLarge, phaseDiffTCCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffTC, tInterp, 'circularNP');
    [phaseDiffTC2MeanAligned, phaseDiffTC2CI95Aligned, ~, ~,...
        phaseDiffTC2MeanAlignedScaled, phaseDiffTC2CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffTC2, tInterp, 'circularNP');
    [phaseDiffTC2MeanAlignedLarge, phaseDiffTC2CI95AlignedLarge, ~, ~,...
        phaseDiffTC2MeanAlignedScaledLarge, phaseDiffTC2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffTC2, tInterp, 'circularNP');
    
    phaseDiffMeanAlignedScaled = [phaseDiffCx23MeanAlignedScaled; phaseDiffCx23iMeanAlignedScaled; phaseDiffCx4MeanAlignedScaled;...
        phaseDiffCx4iMeanAlignedScaled; phaseDiffCx5MeanAlignedScaled; phaseDiffCx5iMeanAlignedScaled; phaseDiffCx6MeanAlignedScaled;...
        phaseDiffCx6iMeanAlignedScaled;phaseDiffNRTMeanAlignedScaled; phaseDiffNRT2MeanAlignedScaled; phaseDiffTCMeanAlignedScaled;...
        phaseDiffTC2MeanAlignedScaled];
    phaseDiffCI95AlignedScaled = [phaseDiffCx23CI95AlignedScaled; phaseDiffCx23iCI95AlignedScaled; phaseDiffCx4CI95AlignedScaled;...
        phaseDiffCx4iCI95AlignedScaled; phaseDiffCx5CI95AlignedScaled; phaseDiffCx5iCI95AlignedScaled; phaseDiffCx6CI95AlignedScaled;...
        phaseDiffCx6iCI95AlignedScaled; phaseDiffNRTCI95AlignedScaled; phaseDiffNRT2CI95AlignedScaled; phaseDiffTCCI95AlignedScaled;...
        phaseDiffTC2CI95AlignedScaled];
    fPhaseDiff = frAlignPlot(phaseDiffMeanAlignedScaled, phaseDiffCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled,...
        colours, lineTypes, 'Phase (rad)', legendEntries, 'Hilbert phase difference (V_M)');
    
    [psiRasterAllMeanAligned, psiRasterAllCI95Aligned, tStartAligned, tEndAligned,...
        psiRasterAllMeanAlignedScaled, psiRasterAllCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled] = frAlign(SWDsInterp,...
        psiRasterAll_t, tInterp);
    [psiRasterAllMeanAlignedLarge, psiRasterAllCI95AlignedLarge, tStartAlignedLarge, tEndAlignedLarge,...
        psiRasterAllMeanAlignedScaledLarge, psiRasterAllCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterAll_t, tInterp);
    [psiRasterCx23MeanAligned, psiRasterCx23CI95Aligned, ~, ~,...
        psiRasterCx23MeanAlignedScaled, psiRasterCx23CI95AlignedScaled] = frAlign(SWDsInterp, psiRasterCx23_t, tInterp);
    [psiRasterCx23MeanAlignedLarge, psiRasterCx23CI95AlignedLarge, ~, ~,...
        psiRasterCx23MeanAlignedScaledLarge, psiRasterCx23CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterCx23_t, tInterp);
    [psiRasterCx23iMeanAligned, psiRasterCx23iCI95Aligned, ~, ~,...
        psiRasterCx23iMeanAlignedScaled, psiRasterCx23iCI95AlignedScaled] = frAlign(SWDsInterp, psiRasterCx23i_t, tInterp);
    [psiRasterCx23iMeanAlignedLarge, psiRasterCx23iCI95AlignedLarge, ~, ~,...
        psiRasterCx23iMeanAlignedScaledLarge, psiRasterCx23iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterCx23i_t, tInterp);
    [psiRasterCx4MeanAligned, psiRasterCx4CI95Aligned, ~, ~,...
        psiRasterCx4MeanAlignedScaled, psiRasterCx4CI95AlignedScaled] = frAlign(SWDsInterp, psiRasterCx4_t, tInterp);
    [psiRasterCx4MeanAlignedLarge, psiRasterCx4CI95AlignedLarge, ~, ~,...
        psiRasterCx4MeanAlignedScaledLarge, psiRasterCx4CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterCx4_t, tInterp);
    [psiRasterCx4iMeanAligned, psiRasterCx4iCI95Aligned, ~, ~,...
        psiRasterCx4iMeanAlignedScaled, psiRasterCx4iCI95AlignedScaled] = frAlign(SWDsInterp, psiRasterCx4i_t, tInterp);
    [psiRasterCx4iMeanAlignedLarge, psiRasterCx4iCI95AlignedLarge, ~, ~,...
        psiRasterCx4iMeanAlignedScaledLarge, psiRasterCx4iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterCx4i_t, tInterp);
    [psiRasterCx5MeanAligned, psiRasterCx5CI95Aligned, ~, ~,...
        psiRasterCx5MeanAlignedScaled, psiRasterCx5CI95AlignedScaled] = frAlign(SWDsInterp, psiRasterCx5_t, tInterp);
    [psiRasterCx5MeanAlignedLarge, psiRasterCx5CI95AlignedLarge, ~, ~,...
        psiRasterCx5MeanAlignedScaledLarge, psiRasterCx5CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterCx5_t, tInterp);
    [psiRasterCx5iMeanAligned, psiRasterCx5iCI95Aligned, ~, ~,...
        psiRasterCx5iMeanAlignedScaled, psiRasterCx5iCI95AlignedScaled] = frAlign(SWDsInterp, psiRasterCx5i_t, tInterp);
    [psiRasterCx5iMeanAlignedLarge, psiRasterCx5iCI95AlignedLarge, ~, ~,...
        psiRasterCx5iMeanAlignedScaledLarge, psiRasterCx5iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterCx5i_t, tInterp);
    [psiRasterCx6MeanAligned, psiRasterCx6CI95Aligned, ~, ~,...
        psiRasterCx6MeanAlignedScaled, psiRasterCx6CI95AlignedScaled] = frAlign(SWDsInterp, psiRasterCx6_t, tInterp);
    [psiRasterCx6MeanAlignedLarge, psiRasterCx6CI95AlignedLarge, ~, ~,...
        psiRasterCx6MeanAlignedScaledLarge, psiRasterCx6CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterCx6_t, tInterp);
    [psiRasterCx6iMeanAligned, psiRasterCx6iCI95Aligned, ~, ~,...
        psiRasterCx6iMeanAlignedScaled, psiRasterCx6iCI95AlignedScaled] = frAlign(SWDsInterp, psiRasterCx6i_t, tInterp);
    [psiRasterCx6iMeanAlignedLarge, psiRasterCx6iCI95AlignedLarge, ~, ~,...
        psiRasterCx6iMeanAlignedScaledLarge, psiRasterCx6iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterCx6i_t, tInterp);
    [psiRasterNRTMeanAligned, psiRasterNRTCI95Aligned, ~, ~,...
        psiRasterNRTMeanAlignedScaled, psiRasterNRTCI95AlignedScaled] = frAlign(SWDsInterp, psiRasterNRT_t, tInterp);
    [psiRasterNRTMeanAlignedLarge, psiRasterNRTCI95AlignedLarge, ~, ~,...
        psiRasterNRTMeanAlignedScaledLarge, psiRasterNRTCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterNRT_t, tInterp);
    [psiRasterNRT2MeanAligned, psiRasterNRT2CI95Aligned, ~, ~,...
        psiRasterNRT2MeanAlignedScaled, psiRasterNRT2CI95AlignedScaled] = frAlign(SWDsInterp, psiRasterNRT2_t, tInterp);
    [psiRasterNRT2MeanAlignedLarge, psiRasterNRT2CI95AlignedLarge, ~, ~,...
        psiRasterNRT2MeanAlignedScaledLarge, psiRasterNRT2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterNRT2_t, tInterp);
    [psiRasterTCMeanAligned, psiRasterTCCI95Aligned, ~, ~,...
        psiRasterTCMeanAlignedScaled, psiRasterTCCI95AlignedScaled] = frAlign(SWDsInterp, psiRasterTC_t, tInterp);
    [psiRasterTCMeanAlignedLarge, psiRasterTCCI95AlignedLarge, ~, ~,...
        psiRasterTCMeanAlignedScaledLarge, psiRasterTCCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterTC_t, tInterp);
    [psiRasterTC2MeanAligned, psiRasterTC2CI95Aligned, ~, ~,...
        psiRasterTC2MeanAlignedScaled, psiRasterTC2CI95AlignedScaled] = frAlign(SWDsInterp, psiRasterTC2_t, tInterp);
    [psiRasterTC2MeanAlignedLarge, psiRasterTC2CI95AlignedLarge, ~, ~,...
        psiRasterTC2MeanAlignedScaledLarge, psiRasterTC2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp, psiRasterTC2_t, tInterp);
    
    psiRasterMeanAlignedScaled = [psiRasterCx23MeanAlignedScaled; psiRasterCx23iMeanAlignedScaled; psiRasterCx4MeanAlignedScaled;...
        psiRasterCx4iMeanAlignedScaled; psiRasterCx5MeanAlignedScaled; psiRasterCx5iMeanAlignedScaled; psiRasterCx6MeanAlignedScaled;...
        psiRasterCx6iMeanAlignedScaled; psiRasterNRTMeanAlignedScaled; psiRasterNRT2MeanAlignedScaled; psiRasterTCMeanAlignedScaled;...
        psiRasterTC2MeanAlignedScaled];
    psiRasterCI95AlignedScaled = [psiRasterCx23CI95AlignedScaled; psiRasterCx23iCI95AlignedScaled; psiRasterCx4CI95AlignedScaled;...
        psiRasterCx4iCI95AlignedScaled; psiRasterCx5CI95AlignedScaled; psiRasterCx5iCI95AlignedScaled; psiRasterCx6CI95AlignedScaled;...
        psiRasterCx6iCI95AlignedScaled; psiRasterNRTCI95AlignedScaled; psiRasterNRT2CI95AlignedScaled; psiRasterTCCI95AlignedScaled;...
        psiRasterTC2CI95AlignedScaled];
    fPSIraster = frAlignPlot(psiRasterMeanAlignedScaled, psiRasterCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled,...
        colours, lineTypes, 'PSI', legendEntries, 'Spiking PSI');
    
    [phaseDiffRasterAllMeanAligned, phaseDiffRasterAllCI95Aligned, tStartAligned, tEndAligned,...
        phaseDiffRasterAllMeanAlignedScaled, phaseDiffRasterAllCI95AlignedScaled, tStartAlignedScaled,...
        tEndAlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterAll, tInterp, 'circularNP');
    [phaseDiffRasterAllMeanAlignedLarge, phaseDiffRasterAllCI95AlignedLarge, tStartAlignedLarge, tEndAlignedLarge,...
        phaseDiffRasterAllMeanAlignedScaledLarge, phaseDiffRasterAllCI95AlignedScaledLarge, tStartAlignedScaledLarge,...
        tEndAlignedScaledLarge] = frAlign(SWDsLargeInterp, phaseDiffRasterAll, tInterp, 'circularNP');
    [phaseDiffRasterCx23MeanAligned, phaseDiffRasterCx23CI95Aligned, ~, ~,...
        phaseDiffRasterCx23MeanAlignedScaled, phaseDiffRasterCx23CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterCx23, tInterp, 'circularNP');
    [phaseDiffRasterCx23MeanAlignedLarge, phaseDiffRasterCx23CI95AlignedLarge, ~, ~,...
        phaseDiffRasterCx23MeanAlignedScaledLarge, phaseDiffRasterCx23CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterCx23, tInterp, 'circularNP');
    [phaseDiffRasterCx23iMeanAligned, phaseDiffRasterCx23iCI95Aligned, ~, ~,...
        phaseDiffRasterCx23iMeanAlignedScaled, phaseDiffRasterCx23iCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterCx23i, tInterp, 'circularNP');
    [phaseDiffRasterCx23iMeanAlignedLarge, phaseDiffRasterCx23iCI95AlignedLarge, ~, ~,...
        phaseDiffRasterCx23iMeanAlignedScaledLarge, phaseDiffRasterCx23iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterCx23i, tInterp, 'circularNP');
    [phaseDiffRasterCx4MeanAligned, phaseDiffRasterCx4CI95Aligned, ~, ~,...
        phaseDiffRasterCx4MeanAlignedScaled, phaseDiffRasterCx4CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterCx4, tInterp, 'circularNP');
    [phaseDiffRasterCx4MeanAlignedLarge, phaseDiffRasterCx4CI95AlignedLarge, ~, ~,...
        phaseDiffRasterCx4MeanAlignedScaledLarge, phaseDiffRasterCx4CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterCx4, tInterp, 'circularNP');
    [phaseDiffRasterCx4iMeanAligned, phaseDiffRasterCx4iCI95Aligned, ~, ~,...
        phaseDiffRasterCx4iMeanAlignedScaled, phaseDiffRasterCx4iCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterCx4i, tInterp, 'circularNP');
    [phaseDiffRasterCx4iMeanAlignedLarge, phaseDiffRasterCx4iCI95AlignedLarge, ~, ~,...
        phaseDiffRasterCx4iMeanAlignedScaledLarge, phaseDiffRasterCx4iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterCx4i, tInterp, 'circularNP');
    [phaseDiffRasterCx5MeanAligned, phaseDiffRasterCx5CI95Aligned, ~, ~,...
        phaseDiffRasterCx5MeanAlignedScaled, phaseDiffRasterCx5CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterCx5, tInterp, 'circularNP');
    [phaseDiffRasterCx5MeanAlignedLarge, phaseDiffRasterCx5CI95AlignedLarge, ~, ~,...
        phaseDiffRasterCx5MeanAlignedScaledLarge, phaseDiffRasterCx5CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterCx5, tInterp, 'circularNP');
    [phaseDiffRasterCx5iMeanAligned, phaseDiffRasterCx5iCI95Aligned, ~, ~,...
        phaseDiffRasterCx5iMeanAlignedScaled, phaseDiffRasterCx5iCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterCx5i, tInterp, 'circularNP');
    [phaseDiffRasterCx5iMeanAlignedLarge, phaseDiffRasterCx5iCI95AlignedLarge, ~, ~,...
        phaseDiffRasterCx5iMeanAlignedScaledLarge, phaseDiffRasterCx5iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterCx5i, tInterp, 'circularNP');
    [phaseDiffRasterCx6MeanAligned, phaseDiffRasterCx6CI95Aligned, ~, ~,...
        phaseDiffRasterCx6MeanAlignedScaled, phaseDiffRasterCx6CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterCx6, tInterp, 'circularNP');
    [phaseDiffRasterCx6MeanAlignedLarge, phaseDiffRasterCx6CI95AlignedLarge, ~, ~,...
        phaseDiffRasterCx6MeanAlignedScaledLarge, phaseDiffRasterCx6CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterCx6, tInterp, 'circularNP');
    [phaseDiffRasterCx6iMeanAligned, phaseDiffRasterCx6iCI95Aligned, ~, ~,...
        phaseDiffRasterCx6iMeanAlignedScaled, phaseDiffRasterCx6iCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterCx6i, tInterp, 'circularNP');
    [phaseDiffRasterCx6iMeanAlignedLarge, phaseDiffRasterCx6iCI95AlignedLarge, ~, ~,...
        phaseDiffRasterCx6iMeanAlignedScaledLarge, phaseDiffRasterCx6iCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterCx6i, tInterp, 'circularNP');
    [phaseDiffRasterNRTMeanAligned, phaseDiffRasterNRTCI95Aligned, ~, ~,...
        phaseDiffRasterNRTMeanAlignedScaled, phaseDiffRasterNRTCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterNRT, tInterp, 'circularNP');
    [phaseDiffRasterNRTMeanAlignedLarge, phaseDiffRasterNRTCI95AlignedLarge, ~, ~,...
        phaseDiffRasterNRTMeanAlignedScaledLarge, phaseDiffRasterNRTCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterNRT, tInterp, 'circularNP');
    [phaseDiffRasterNRT2MeanAligned, phaseDiffRasterNRT2CI95Aligned, ~, ~,...
        phaseDiffRasterNRT2MeanAlignedScaled, phaseDiffRasterNRT2CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterNRT2, tInterp, 'circularNP');
    [phaseDiffRasterNRT2MeanAlignedLarge, phaseDiffRasterNRT2CI95AlignedLarge, ~, ~,...
        phaseDiffRasterNRT2MeanAlignedScaledLarge, phaseDiffRasterNRT2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterNRT2, tInterp, 'circularNP');
    [phaseDiffRasterTCMeanAligned, phaseDiffRasterTCCI95Aligned, ~, ~,...
        phaseDiffRasterTCMeanAlignedScaled, phaseDiffRasterTCCI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterTC, tInterp, 'circularNP');
    [phaseDiffRasterTCMeanAlignedLarge, phaseDiffRasterTCCI95AlignedLarge, ~, ~,...
        phaseDiffRasterTCMeanAlignedScaledLarge, phaseDiffRasterTCCI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterTC, tInterp, 'circularNP');
    [phaseDiffRasterTC2MeanAligned, phaseDiffRasterTC2CI95Aligned, ~, ~,...
        phaseDiffRasterTC2MeanAlignedScaled, phaseDiffRasterTC2CI95AlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterTC2, tInterp, 'circularNP');
    [phaseDiffRasterTC2MeanAlignedLarge, phaseDiffRasterTC2CI95AlignedLarge, ~, ~,...
        phaseDiffRasterTC2MeanAlignedScaledLarge, phaseDiffRasterTC2CI95AlignedScaledLarge] = frAlign(SWDsLargeInterp,...
        phaseDiffRasterTC2, tInterp, 'circularNP');
    
    phaseDiffRasterMeanAlignedScaled = [phaseDiffRasterCx23MeanAlignedScaled; phaseDiffRasterCx23iMeanAlignedScaled;...
        phaseDiffRasterCx4MeanAlignedScaled; phaseDiffRasterCx4iMeanAlignedScaled; phaseDiffRasterCx5MeanAlignedScaled;...
        phaseDiffRasterCx5iMeanAlignedScaled; phaseDiffRasterCx6MeanAlignedScaled; phaseDiffRasterCx6iMeanAlignedScaled;...
        phaseDiffRasterNRTMeanAlignedScaled; phaseDiffRasterNRT2MeanAlignedScaled; phaseDiffRasterTCMeanAlignedScaled;...
        phaseDiffRasterTC2MeanAlignedScaled];
    phaseDiffRasterCI95AlignedScaled = [phaseDiffRasterCx23CI95AlignedScaled; phaseDiffRasterCx23iCI95AlignedScaled;...
        phaseDiffRasterCx4CI95AlignedScaled; phaseDiffRasterCx4iCI95AlignedScaled; phaseDiffRasterCx5CI95AlignedScaled;...
        phaseDiffRasterCx5iCI95AlignedScaled; phaseDiffRasterCx6CI95AlignedScaled; phaseDiffRasterCx6iCI95AlignedScaled;...
        phaseDiffRasterNRTCI95AlignedScaled; phaseDiffRasterNRT2CI95AlignedScaled; phaseDiffRasterTCCI95AlignedScaled;...
        phaseDiffRasterTC2CI95AlignedScaled];
    fPhaseDiffRaster = frAlignPlot(phaseDiffRasterMeanAlignedScaled, phaseDiffRasterCI95AlignedScaled, tStartAlignedScaled, tEndAlignedScaled,...
        colours, lineTypes, 'Phase (rad)', legendEntries, 'Hilbert phase difference (spiking)');

    [phaseDiffRasterAllMeanAlignedInitial, phaseDiffRasterAllCI95AlignedInitial, tStartAligned, tEndAligned,...
        phaseDiffRasterAllMeanAlignedScaledInitial, phaseDiffRasterAllCI95AlignedScaledInitial, tStartAlignedScaled,...
        tEndAlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterAllInitial, tInterp, 'circularNP');
    [phaseDiffRasterCx23MeanAlignedInitial, phaseDiffRasterCx23CI95AlignedInitial, ~, ~,...
        phaseDiffRasterCx23MeanAlignedScaledInitial, phaseDiffRasterCx23CI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterCx23Initial, tInterp, 'circularNP');
    [phaseDiffRasterCx23iMeanAlignedInitial, phaseDiffRasterCx23iCI95AlignedInitial, ~, ~,...
        phaseDiffRasterCx23iMeanAlignedScaledInitial, phaseDiffRasterCx23iCI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterCx23iInitial, tInterp, 'circularNP');
    [phaseDiffRasterCx4MeanAlignedInitial, phaseDiffRasterCx4CI95AlignedInitial, ~, ~,...
        phaseDiffRasterCx4MeanAlignedScaledInitial, phaseDiffRasterCx4CI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterCx4Initial, tInterp, 'circularNP');
    [phaseDiffRasterCx4iMeanAlignedInitial, phaseDiffRasterCx4iCI95AlignedInitial, ~, ~,...
        phaseDiffRasterCx4iMeanAlignedScaledInitial, phaseDiffRasterCx4iCI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterCx4iInitial, tInterp, 'circularNP');
    [phaseDiffRasterCx5MeanAlignedInitial, phaseDiffRasterCx5CI95AlignedInitial, ~, ~,...
        phaseDiffRasterCx5MeanAlignedScaledInitial, phaseDiffRasterCx5CI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterCx5Initial, tInterp, 'circularNP');
    [phaseDiffRasterCx5iMeanAlignedInitial, phaseDiffRasterCx5iCI95AlignedInitial, ~, ~,...
        phaseDiffRasterCx5iMeanAlignedScaledInitial, phaseDiffRasterCx5iCI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterCx5iInitial, tInterp, 'circularNP');
    [phaseDiffRasterCx6MeanAlignedInitial, phaseDiffRasterCx6CI95AlignedInitial, ~, ~,...
        phaseDiffRasterCx6MeanAlignedScaledInitial, phaseDiffRasterCx6CI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterCx6Initial, tInterp, 'circularNP');
    [phaseDiffRasterCx6iMeanAlignedInitial, phaseDiffRasterCx6iCI95AlignedInitial, ~, ~,...
        phaseDiffRasterCx6iMeanAlignedScaledInitial, phaseDiffRasterCx6iCI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterCx6iInitial, tInterp, 'circularNP');
    [phaseDiffRasterNRTMeanAlignedInitial, phaseDiffRasterNRTCI95AlignedInitial, ~, ~,...
        phaseDiffRasterNRTMeanAlignedScaledInitial, phaseDiffRasterNRTCI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterNRTInitial, tInterp, 'circularNP');
    [phaseDiffRasterNRT2MeanAlignedInitial, phaseDiffRasterNRT2CI95AlignedInitial, ~, ~,...
        phaseDiffRasterNRT2MeanAlignedScaledInitial, phaseDiffRasterNRT2CI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterNRT2Initial, tInterp, 'circularNP');
    [phaseDiffRasterTCMeanAlignedInitial, phaseDiffRasterTCCI95AlignedInitial, ~, ~,...
        phaseDiffRasterTCMeanAlignedScaledInitial, phaseDiffRasterTCCI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterTCInitial, tInterp, 'circularNP');
    [phaseDiffRasterTC2MeanAlignedInitial, phaseDiffRasterTC2CI95AlignedInitial, ~, ~,...
        phaseDiffRasterTC2MeanAlignedScaledInitial, phaseDiffRasterTC2CI95AlignedScaledInitial] = frAlign(SWDsInterp, phaseDiffRasterTC2Initial, tInterp, 'circularNP');
    
    phaseDiffRasterMeanAlignedScaledInitial = [phaseDiffRasterCx23MeanAlignedScaledInitial; phaseDiffRasterCx23iMeanAlignedScaledInitial;...
        phaseDiffRasterCx4MeanAlignedScaledInitial; phaseDiffRasterCx4iMeanAlignedScaledInitial; phaseDiffRasterCx5MeanAlignedScaledInitial;...
        phaseDiffRasterCx5iMeanAlignedScaledInitial; phaseDiffRasterCx6MeanAlignedScaledInitial; phaseDiffRasterCx6iMeanAlignedScaledInitial;...
        phaseDiffRasterNRTMeanAlignedScaledInitial; phaseDiffRasterNRT2MeanAlignedScaledInitial; phaseDiffRasterTCMeanAlignedScaledInitial;...
        phaseDiffRasterTC2MeanAlignedScaledInitial];
    phaseDiffRasterCI95AlignedScaledInitial = [phaseDiffRasterCx23CI95AlignedScaledInitial; phaseDiffRasterCx23iCI95AlignedScaledInitial;...
        phaseDiffRasterCx4CI95AlignedScaledInitial; phaseDiffRasterCx4iCI95AlignedScaledInitial; phaseDiffRasterCx5CI95AlignedScaledInitial;...
        phaseDiffRasterCx5iCI95AlignedScaledInitial; phaseDiffRasterCx6CI95AlignedScaledInitial; phaseDiffRasterCx6iCI95AlignedScaledInitial;...
        phaseDiffRasterNRTCI95AlignedScaledInitial; phaseDiffRasterNRT2CI95AlignedScaledInitial; phaseDiffRasterTCCI95AlignedScaledInitial;...
        phaseDiffRasterTC2CI95AlignedScaledInitial];
    fPhaseDiffRaster = frAlignPlot(phaseDiffRasterMeanAlignedScaledInitial, phaseDiffRasterCI95AlignedScaledInitial, tStartAlignedScaled, tEndAlignedScaled,...
        colours, lineTypes, 'Phase (rad)', legendEntries, 'Hilbert phase difference (initial spiking)');

    [phaseDiffRasterAllMeanAlignedFinal, phaseDiffRasterAllCI95AlignedFinal, tStartAligned, tEndAligned,...
        phaseDiffRasterAllMeanAlignedScaledFinal, phaseDiffRasterAllCI95AlignedScaledFinal, tStartAlignedScaled,...
        tEndAlignedScaled] = frAlign(SWDsInterp, phaseDiffRasterAllFinal, tInterp, 'circularNP');
    [phaseDiffRasterCx23MeanAlignedFinal, phaseDiffRasterCx23CI95AlignedFinal, ~, ~,...
        phaseDiffRasterCx23MeanAlignedScaledFinal, phaseDiffRasterCx23CI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterCx23Final, tInterp, 'circularNP');
    [phaseDiffRasterCx23iMeanAlignedFinal, phaseDiffRasterCx23iCI95AlignedFinal, ~, ~,...
        phaseDiffRasterCx23iMeanAlignedScaledFinal, phaseDiffRasterCx23iCI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterCx23iFinal, tInterp, 'circularNP');
    [phaseDiffRasterCx4MeanAlignedFinal, phaseDiffRasterCx4CI95AlignedFinal, ~, ~,...
        phaseDiffRasterCx4MeanAlignedScaledFinal, phaseDiffRasterCx4CI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterCx4Final, tInterp, 'circularNP');
    [phaseDiffRasterCx4iMeanAlignedFinal, phaseDiffRasterCx4iCI95AlignedFinal, ~, ~,...
        phaseDiffRasterCx4iMeanAlignedScaledFinal, phaseDiffRasterCx4iCI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterCx4iFinal, tInterp, 'circularNP');
    [phaseDiffRasterCx5MeanAlignedFinal, phaseDiffRasterCx5CI95AlignedFinal, ~, ~,...
        phaseDiffRasterCx5MeanAlignedScaledFinal, phaseDiffRasterCx5CI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterCx5Final, tInterp, 'circularNP');
    [phaseDiffRasterCx5iMeanAlignedFinal, phaseDiffRasterCx5iCI95AlignedFinal, ~, ~,...
        phaseDiffRasterCx5iMeanAlignedScaledFinal, phaseDiffRasterCx5iCI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterCx5iFinal, tInterp, 'circularNP');
    [phaseDiffRasterCx6MeanAlignedFinal, phaseDiffRasterCx6CI95AlignedFinal, ~, ~,...
        phaseDiffRasterCx6MeanAlignedScaledFinal, phaseDiffRasterCx6CI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterCx6Final, tInterp, 'circularNP');
    [phaseDiffRasterCx6iMeanAlignedFinal, phaseDiffRasterCx6iCI95AlignedFinal, ~, ~,...
        phaseDiffRasterCx6iMeanAlignedScaledFinal, phaseDiffRasterCx6iCI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterCx6iFinal, tInterp, 'circularNP');
    [phaseDiffRasterNRTMeanAlignedFinal, phaseDiffRasterNRTCI95AlignedFinal, ~, ~,...
        phaseDiffRasterNRTMeanAlignedScaledFinal, phaseDiffRasterNRTCI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterNRTFinal, tInterp, 'circularNP');
    [phaseDiffRasterNRT2MeanAlignedFinal, phaseDiffRasterNRT2CI95AlignedFinal, ~, ~,...
        phaseDiffRasterNRT2MeanAlignedScaledFinal, phaseDiffRasterNRT2CI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterNRT2Final, tInterp, 'circularNP');
    [phaseDiffRasterTCMeanAlignedFinal, phaseDiffRasterTCCI95AlignedFinal, ~, ~,...
        phaseDiffRasterTCMeanAlignedScaledFinal, phaseDiffRasterTCCI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterTCFinal, tInterp, 'circularNP');
    [phaseDiffRasterTC2MeanAlignedFinal, phaseDiffRasterTC2CI95AlignedFinal, ~, ~,...
        phaseDiffRasterTC2MeanAlignedScaledFinal, phaseDiffRasterTC2CI95AlignedScaledFinal] = frAlign(SWDsInterp, phaseDiffRasterTC2Final, tInterp, 'circularNP');
    
    phaseDiffRasterMeanAlignedScaledFinal = [phaseDiffRasterCx23MeanAlignedScaledFinal; phaseDiffRasterCx23iMeanAlignedScaledFinal;...
        phaseDiffRasterCx4MeanAlignedScaledFinal; phaseDiffRasterCx4iMeanAlignedScaledFinal; phaseDiffRasterCx5MeanAlignedScaledFinal;...
        phaseDiffRasterCx5iMeanAlignedScaledFinal; phaseDiffRasterCx6MeanAlignedScaledFinal; phaseDiffRasterCx6iMeanAlignedScaledFinal;...
        phaseDiffRasterNRTMeanAlignedScaledFinal; phaseDiffRasterNRT2MeanAlignedScaledFinal; phaseDiffRasterTCMeanAlignedScaledFinal;...
        phaseDiffRasterTC2MeanAlignedScaledFinal];
    phaseDiffRasterCI95AlignedScaledFinal = [phaseDiffRasterCx23CI95AlignedScaledFinal; phaseDiffRasterCx23iCI95AlignedScaledFinal;...
        phaseDiffRasterCx4CI95AlignedScaledFinal; phaseDiffRasterCx4iCI95AlignedScaledFinal; phaseDiffRasterCx5CI95AlignedScaledFinal;...
        phaseDiffRasterCx5iCI95AlignedScaledFinal; phaseDiffRasterCx6CI95AlignedScaledFinal; phaseDiffRasterCx6iCI95AlignedScaledFinal;...
        phaseDiffRasterNRTCI95AlignedScaledFinal; phaseDiffRasterNRT2CI95AlignedScaledFinal; phaseDiffRasterTCCI95AlignedScaledFinal;...
        phaseDiffRasterTC2CI95AlignedScaledFinal];
    fPhaseDiffRaster = frAlignPlot(phaseDiffRasterMeanAlignedScaledFinal, phaseDiffRasterCI95AlignedScaledFinal, tStartAlignedScaled, tEndAlignedScaled,...
        colours, lineTypes, 'Phase (rad)', legendEntries, 'Hilbert phase difference (final spiking)');
    
    interictalInterp = interp1(t, interictal, tInterp, 'linear', 'extrap');
    interictalLargeInterp = interp1(t, interictalLarge, tInterp, 'linear', 'extrap');
    [psiAllMeanAligned_i, psiAllCI95Aligned_i, tStartAligned_i, tEndAligned_i,...
        psiAllMeanAlignedScaled_i, psiAllCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i] = frAlign(interictalInterp, psiAll_t, tInterp);
    [psiAllMeanAlignedLarge, psiAllCI95AlignedLarge, tStartAlignedLarge, tEndAlignedLarge,...
        psiAllMeanAlignedScaledLarge, psiAllCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiAll_t, tInterp);
    [psiCx23MeanAligned_i, psiCx23CI95Aligned_i, ~, ~,...
        psiCx23MeanAlignedScaled_i, psiCx23CI95AlignedScaled_i] = frAlign(interictalInterp, psiCx23_t, tInterp);
    [psiCx23MeanAlignedLarge, psiCx23CI95AlignedLarge, ~, ~,...
        psiCx23MeanAlignedScaledLarge, psiCx23CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiCx23_t, tInterp);
    [psiCx23iMeanAligned_i, psiCx23iCI95Aligned_i, ~, ~,...
        psiCx23iMeanAlignedScaled_i, psiCx23iCI95AlignedScaled_i] = frAlign(interictalInterp, psiCx23i_t, tInterp);
    [psiCx23iMeanAlignedLarge, psiCx23iCI95AlignedLarge, ~, ~,...
        psiCx23iMeanAlignedScaledLarge, psiCx23iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiCx23i_t, tInterp);
    [psiCx4MeanAligned_i, psiCx4CI95Aligned_i, ~, ~,...
        psiCx4MeanAlignedScaled_i, psiCx4CI95AlignedScaled_i] = frAlign(interictalInterp, psiCx4_t, tInterp);
    [psiCx4MeanAlignedLarge, psiCx4CI95AlignedLarge, ~, ~,...
        psiCx4MeanAlignedScaledLarge, psiCx4CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiCx4_t, tInterp);
    [psiCx4iMeanAligned_i, psiCx4iCI95Aligned_i, ~, ~,...
        psiCx4iMeanAlignedScaled_i, psiCx4iCI95AlignedScaled_i] = frAlign(interictalInterp, psiCx4i_t, tInterp);
    [psiCx4iMeanAlignedLarge, psiCx4iCI95AlignedLarge, ~, ~,...
        psiCx4iMeanAlignedScaledLarge, psiCx4iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiCx4i_t, tInterp);
    [psiCx5MeanAligned_i, psiCx5CI95Aligned_i, ~, ~,...
        psiCx5MeanAlignedScaled_i, psiCx5CI95AlignedScaled_i] = frAlign(interictalInterp, psiCx5_t, tInterp);
    [psiCx5MeanAlignedLarge, psiCx5CI95AlignedLarge, ~, ~,...
        psiCx5MeanAlignedScaledLarge, psiCx5CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiCx5_t, tInterp);
    [psiCx5iMeanAligned_i, psiCx5iCI95Aligned_i, ~, ~,...
        psiCx5iMeanAlignedScaled_i, psiCx5iCI95AlignedScaled_i] = frAlign(interictalInterp, psiCx5i_t, tInterp);
    [psiCx5iMeanAlignedLarge, psiCx5iCI95AlignedLarge, ~, ~,...
        psiCx5iMeanAlignedScaledLarge, psiCx5iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiCx5i_t, tInterp);
    [psiCx6MeanAligned_i, psiCx6CI95Aligned_i, ~, ~,...
        psiCx6MeanAlignedScaled_i, psiCx6CI95AlignedScaled_i] = frAlign(interictalInterp, psiCx6_t, tInterp);
    [psiCx6MeanAlignedLarge, psiCx6CI95AlignedLarge, ~, ~,...
        psiCx6MeanAlignedScaledLarge, psiCx6CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiCx6_t, tInterp);
    [psiCx6iMeanAligned_i, psiCx6iCI95Aligned_i, ~, ~,...
        psiCx6iMeanAlignedScaled_i, psiCx6iCI95AlignedScaled_i] = frAlign(interictalInterp, psiCx6i_t, tInterp);
    [psiCx6iMeanAlignedLarge, psiCx6iCI95AlignedLarge, ~, ~,...
        psiCx6iMeanAlignedScaledLarge, psiCx6iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiCx6i_t, tInterp);
    [psiNRTMeanAligned_i, psiNRTCI95Aligned_i, ~, ~,...
        psiNRTMeanAlignedScaled_i, psiNRTCI95AlignedScaled_i] = frAlign(interictalInterp, psiNRT_t, tInterp);
    [psiNRTMeanAlignedLarge, psiNRTCI95AlignedLarge, ~, ~,...
        psiNRTMeanAlignedScaledLarge, psiNRTCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiNRT_t, tInterp);
    [psiNRT2MeanAligned_i, psiNRT2CI95Aligned_i, ~, ~,...
        psiNRT2MeanAlignedScaled_i, psiNRT2CI95AlignedScaled_i] = frAlign(interictalInterp, psiNRT2_t, tInterp);
    [psiNRT2MeanAlignedLarge, psiNRT2CI95AlignedLarge, ~, ~,...
        psiNRT2MeanAlignedScaledLarge, psiNRT2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiNRT2_t, tInterp);
    [psiTCMeanAligned_i, psiTCCI95Aligned_i, ~, ~,...
        psiTCMeanAlignedScaled_i, psiTCCI95AlignedScaled_i] = frAlign(interictalInterp, psiTC_t, tInterp);
    [psiTCMeanAlignedLarge, psiTCCI95AlignedLarge, ~, ~,...
        psiTCMeanAlignedScaledLarge, psiTCCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiTC_t, tInterp);
    [psiTC2MeanAligned_i, psiTC2CI95Aligned_i, ~, ~,...
        psiTC2MeanAlignedScaled_i, psiTC2CI95AlignedScaled_i] = frAlign(interictalInterp, psiTC2_t, tInterp);
    [psiTC2MeanAlignedLarge, psiTC2CI95AlignedLarge, ~, ~,...
        psiTC2MeanAlignedScaledLarge, psiTC2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiTC2_t, tInterp);
    
    psiMeanAlignedScaled_i = [psiCx23MeanAlignedScaled_i; psiCx23iMeanAlignedScaled_i; psiCx4MeanAlignedScaled_i; psiCx4iMeanAlignedScaled_i;...
        psiCx5MeanAlignedScaled_i; psiCx5iMeanAlignedScaled_i; psiCx6MeanAlignedScaled_i; psiCx6iMeanAlignedScaled_i;
        psiNRTMeanAlignedScaled_i; psiNRT2MeanAlignedScaled_i; psiTCMeanAlignedScaled_i; psiTC2MeanAlignedScaled_i];
    psiCI95AlignedScaled_i = [psiCx23CI95AlignedScaled_i; psiCx23iCI95AlignedScaled_i; psiCx4CI95AlignedScaled_i; psiCx4iCI95AlignedScaled_i;...
        psiCx5CI95AlignedScaled_i; psiCx5iCI95AlignedScaled_i; psiCx6CI95AlignedScaled_i; psiCx6iCI95AlignedScaled_i;
        psiNRTCI95AlignedScaled_i; psiNRT2CI95AlignedScaled_i; psiTCCI95AlignedScaled_i; psiTC2CI95AlignedScaled_i];
    colours = [cellColour('Cx23'); cellColour('Cx23i'); cellColour('Cx4'); cellColour('Cx4i'); cellColour('Cx5'); cellColour('Cx5i');...
        cellColour('Cx6'); cellColour('Cx6i'); cellColour('NRT'); cellColour('NRT2'); cellColour('TC'); cellColour('TC2')];
    lineTypes = {'-','-','-','-','-','-','-','-','-','-','-','-'};
    legendEntries = {'L2/3 PY', 'L2/3 IN', 'L4 PY', 'L4 IN', 'L5 PY', 'L5 IN', 'L6 PY', 'L6 IN', 'NRT_F_O', 'NRT_H_O', 'TC_F_O', 'TC_H_O'};
    fPSI = frAlignPlot(psiMeanAlignedScaled_i, psiCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i, colours, lineTypes, 'PSI',...
        legendEntries, 'V_M PSI');
    
    [phaseDiffAllMeanAligned_i, phaseDiffAllCI95Aligned_i, tStartAligned_i, tEndAligned_i,...
        phaseDiffAllMeanAlignedScaled_i, phaseDiffAllCI95AlignedScaled_i, tStartAlignedScaled_i,...
        tEndAlignedScaled_i] = frAlign(interictalInterp, phaseDiffAll, tInterp, 'circularNP');
    [phaseDiffAllMeanAlignedLarge_i, phaseDiffAllCI95AlignedLarge_i, tStartAlignedLarge_i, tEndAlignedLarge_i,...
        phaseDiffAllMeanAlignedScaledLarge_i, phaseDiffAllCI95AlignedScaledLarge_i, tStartAlignedScaledLarge_i,...
        tEndAlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffAll, tInterp, 'circularNP');
    [phaseDiffCx23MeanAligned_i, phaseDiffCx23CI95Aligned_i, ~, ~,...
        phaseDiffCx23MeanAlignedScaled_i, phaseDiffCx23CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffCx23, tInterp, 'circularNP');
    [phaseDiffCx23MeanAlignedLarge_i, phaseDiffCx23CI95AlignedLarge_i, ~, ~,...
        phaseDiffCx23MeanAlignedScaledLarge_i, phaseDiffCx23CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffCx23, tInterp, 'circularNP');
    [phaseDiffCx23iMeanAligned_i, phaseDiffCx23iCI95Aligned_i, ~, ~,...
        phaseDiffCx23iMeanAlignedScaled_i, phaseDiffCx23iCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffCx23i, tInterp, 'circularNP');
    [phaseDiffCx23iMeanAlignedLarge_i, phaseDiffCx23iCI95AlignedLarge_i, ~, ~,...
        phaseDiffCx23iMeanAlignedScaledLarge_i, phaseDiffCx23iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffCx23i, tInterp, 'circularNP');
    [phaseDiffCx4MeanAligned_i, phaseDiffCx4CI95Aligned_i, ~, ~,...
        phaseDiffCx4MeanAlignedScaled_i, phaseDiffCx4CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffCx4, tInterp, 'circularNP');
    [phaseDiffCx4MeanAlignedLarge_i, phaseDiffCx4CI95AlignedLarge_i, ~, ~,...
        phaseDiffCx4MeanAlignedScaledLarge_i, phaseDiffCx4CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffCx4, tInterp, 'circularNP');
    [phaseDiffCx4iMeanAligned_i, phaseDiffCx4iCI95Aligned_i, ~, ~,...
        phaseDiffCx4iMeanAlignedScaled_i, phaseDiffCx4iCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffCx4i, tInterp, 'circularNP');
    [phaseDiffCx4iMeanAlignedLarge_i, phaseDiffCx4iCI95AlignedLarge_i, ~, ~,...
        phaseDiffCx4iMeanAlignedScaledLarge_i, phaseDiffCx4iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffCx4i, tInterp, 'circularNP');
    [phaseDiffCx5MeanAligned_i, phaseDiffCx5CI95Aligned_i, ~, ~,...
        phaseDiffCx5MeanAlignedScaled_i, phaseDiffCx5CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffCx5, tInterp, 'circularNP');
    [phaseDiffCx5MeanAlignedLarge_i, phaseDiffCx5CI95AlignedLarge_i, ~, ~,...
        phaseDiffCx5MeanAlignedScaledLarge_i, phaseDiffCx5CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffCx5, tInterp, 'circularNP');
    [phaseDiffCx5iMeanAligned_i, phaseDiffCx5iCI95Aligned_i, ~, ~,...
        phaseDiffCx5iMeanAlignedScaled_i, phaseDiffCx5iCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffCx5i, tInterp, 'circularNP');
    [phaseDiffCx5iMeanAlignedLarge_i, phaseDiffCx5iCI95AlignedLarge_i, ~, ~,...
        phaseDiffCx5iMeanAlignedScaledLarge_i, phaseDiffCx5iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffCx5i, tInterp, 'circularNP');
    [phaseDiffCx6MeanAligned_i, phaseDiffCx6CI95Aligned_i, ~, ~,...
        phaseDiffCx6MeanAlignedScaled_i, phaseDiffCx6CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffCx6, tInterp, 'circularNP');
    [phaseDiffCx6MeanAlignedLarge_i, phaseDiffCx6CI95AlignedLarge_i, ~, ~,...
        phaseDiffCx6MeanAlignedScaledLarge_i, phaseDiffCx6CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffCx6, tInterp, 'circularNP');
    [phaseDiffCx6iMeanAligned_i, phaseDiffCx6iCI95Aligned_i, ~, ~,...
        phaseDiffCx6iMeanAlignedScaled_i, phaseDiffCx6iCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffCx6i, tInterp, 'circularNP');
    [phaseDiffCx6iMeanAlignedLarge_i, phaseDiffCx6iCI95AlignedLarge_i, ~, ~,...
        phaseDiffCx6iMeanAlignedScaledLarge_i, phaseDiffCx6iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffCx6i, tInterp, 'circularNP');
    [phaseDiffNRTMeanAligned_i, phaseDiffNRTCI95Aligned_i, ~, ~,...
        phaseDiffNRTMeanAlignedScaled_i, phaseDiffNRTCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffNRT, tInterp, 'circularNP');
    [phaseDiffNRTMeanAlignedLarge_i, phaseDiffNRTCI95AlignedLarge_i, ~, ~,...
        phaseDiffNRTMeanAlignedScaledLarge_i, phaseDiffNRTCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffNRT, tInterp, 'circularNP');
    [phaseDiffNRT2MeanAligned_i, phaseDiffNRT2CI95Aligned_i, ~, ~,...
        phaseDiffNRT2MeanAlignedScaled_i, phaseDiffNRT2CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffNRT2, tInterp, 'circularNP');
    [phaseDiffNRT2MeanAlignedLarge_i, phaseDiffNRT2CI95AlignedLarge_i, ~, ~,...
        phaseDiffNRT2MeanAlignedScaledLarge_i, phaseDiffNRT2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffNRT2, tInterp, 'circularNP');
    [phaseDiffTCMeanAligned_i, phaseDiffTCCI95Aligned_i, ~, ~,...
        phaseDiffTCMeanAlignedScaled_i, phaseDiffTCCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffTC, tInterp, 'circularNP');
    [phaseDiffTCMeanAlignedLarge_i, phaseDiffTCCI95AlignedLarge_i, ~, ~,...
        phaseDiffTCMeanAlignedScaledLarge_i, phaseDiffTCCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffTC, tInterp, 'circularNP');
    [phaseDiffTC2MeanAligned_i, phaseDiffTC2CI95Aligned_i, ~, ~,...
        phaseDiffTC2MeanAlignedScaled_i, phaseDiffTC2CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffTC2, tInterp, 'circularNP');
    [phaseDiffTC2MeanAlignedLarge_i, phaseDiffTC2CI95AlignedLarge_i, ~, ~,...
        phaseDiffTC2MeanAlignedScaledLarge_i, phaseDiffTC2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffTC2, tInterp, 'circularNP');
    
    phaseDiffMeanAlignedScaled_i = [phaseDiffCx23MeanAlignedScaled_i; phaseDiffCx23iMeanAlignedScaled_i; phaseDiffCx4MeanAlignedScaled_i;...
        phaseDiffCx4iMeanAlignedScaled_i; phaseDiffCx5MeanAlignedScaled_i; phaseDiffCx5iMeanAlignedScaled_i; phaseDiffCx6MeanAlignedScaled_i;...
        phaseDiffCx6iMeanAlignedScaled_i;phaseDiffNRTMeanAlignedScaled_i; phaseDiffNRT2MeanAlignedScaled_i; phaseDiffTCMeanAlignedScaled_i;...
        phaseDiffTC2MeanAlignedScaled_i];
    phaseDiffCI95AlignedScaled_i = [phaseDiffCx23CI95AlignedScaled_i; phaseDiffCx23iCI95AlignedScaled_i; phaseDiffCx4CI95AlignedScaled_i;...
        phaseDiffCx4iCI95AlignedScaled_i; phaseDiffCx5CI95AlignedScaled_i; phaseDiffCx5iCI95AlignedScaled_i; phaseDiffCx6CI95AlignedScaled_i;...
        phaseDiffCx6iCI95AlignedScaled_i; phaseDiffNRTCI95AlignedScaled_i; phaseDiffNRT2CI95AlignedScaled_i; phaseDiffTCCI95AlignedScaled_i;...
        phaseDiffTC2CI95AlignedScaled_i];
    fPhaseDiff = frAlignPlot(phaseDiffMeanAlignedScaled_i, phaseDiffCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i,...
        colours, lineTypes, 'Phase (rad)', legendEntries, 'Hilbert phase difference (V_M)');
    
    [psiRasterAllMeanAligned_i, psiRasterAllCI95Aligned_i, tStartAligned_i, tEndAligned_i,...
        psiRasterAllMeanAlignedScaled_i, psiRasterAllCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i] = frAlign(interictalInterp,...
        psiRasterAll_t, tInterp);
    [psiRasterAllMeanAlignedLarge_i, psiRasterAllCI95AlignedLarge_i, tStartAlignedLarge_i, tEndAlignedLarge_i,...
        psiRasterAllMeanAlignedScaledLarge_i, psiRasterAllCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterAll_t, tInterp);
    [psiRasterCx23MeanAligned_i, psiRasterCx23CI95Aligned_i, ~, ~,...
        psiRasterCx23MeanAlignedScaled_i, psiRasterCx23CI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterCx23_t, tInterp);
    [psiRasterCx23MeanAlignedLarge_i, psiRasterCx23CI95AlignedLarge_i, ~, ~,...
        psiRasterCx23MeanAlignedScaledLarge_i, psiRasterCx23CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterCx23_t, tInterp);
    [psiRasterCx23iMeanAligned_i, psiRasterCx23iCI95Aligned_i, ~, ~,...
        psiRasterCx23iMeanAlignedScaled_i, psiRasterCx23iCI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterCx23i_t, tInterp);
    [psiRasterCx23iMeanAlignedLarge_i, psiRasterCx23iCI95AlignedLarge_i, ~, ~,...
        psiRasterCx23iMeanAlignedScaledLarge_i, psiRasterCx23iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterCx23i_t, tInterp);
    [psiRasterCx4MeanAligned_i, psiRasterCx4CI95Aligned_i, ~, ~,...
        psiRasterCx4MeanAlignedScaled_i, psiRasterCx4CI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterCx4_t, tInterp);
    [psiRasterCx4MeanAlignedLarge_i, psiRasterCx4CI95AlignedLarge_i, ~, ~,...
        psiRasterCx4MeanAlignedScaledLarge_i, psiRasterCx4CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterCx4_t, tInterp);
    [psiRasterCx4iMeanAligned_i, psiRasterCx4iCI95Aligned_i, ~, ~,...
        psiRasterCx4iMeanAlignedScaled_i, psiRasterCx4iCI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterCx4i_t, tInterp);
    [psiRasterCx4iMeanAlignedLarge_i, psiRasterCx4iCI95AlignedLarge_i, ~, ~,...
        psiRasterCx4iMeanAlignedScaledLarge_i, psiRasterCx4iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterCx4i_t, tInterp);
    [psiRasterCx5MeanAligned_i, psiRasterCx5CI95Aligned_i, ~, ~,...
        psiRasterCx5MeanAlignedScaled_i, psiRasterCx5CI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterCx5_t, tInterp);
    [psiRasterCx5MeanAlignedLarge_i, psiRasterCx5CI95AlignedLarge_i, ~, ~,...
        psiRasterCx5MeanAlignedScaledLarge_i, psiRasterCx5CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterCx5_t, tInterp);
    [psiRasterCx5iMeanAligned_i, psiRasterCx5iCI95Aligned_i, ~, ~,...
        psiRasterCx5iMeanAlignedScaled_i, psiRasterCx5iCI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterCx5i_t, tInterp);
    [psiRasterCx5iMeanAlignedLarge_i, psiRasterCx5iCI95AlignedLarge_i, ~, ~,...
        psiRasterCx5iMeanAlignedScaledLarge_i, psiRasterCx5iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterCx5i_t, tInterp);
    [psiRasterCx6MeanAligned_i, psiRasterCx6CI95Aligned_i, ~, ~,...
        psiRasterCx6MeanAlignedScaled_i, psiRasterCx6CI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterCx6_t, tInterp);
    [psiRasterCx6MeanAlignedLarge_i, psiRasterCx6CI95AlignedLarge_i, ~, ~,...
        psiRasterCx6MeanAlignedScaledLarge_i, psiRasterCx6CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterCx6_t, tInterp);
    [psiRasterCx6iMeanAligned_i, psiRasterCx6iCI95Aligned_i, ~, ~,...
        psiRasterCx6iMeanAlignedScaled_i, psiRasterCx6iCI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterCx6i_t, tInterp);
    [psiRasterCx6iMeanAlignedLarge_i, psiRasterCx6iCI95AlignedLarge_i, ~, ~,...
        psiRasterCx6iMeanAlignedScaledLarge_i, psiRasterCx6iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterCx6i_t, tInterp);
    [psiRasterNRTMeanAligned_i, psiRasterNRTCI95Aligned_i, ~, ~,...
        psiRasterNRTMeanAlignedScaled_i, psiRasterNRTCI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterNRT_t, tInterp);
    [psiRasterNRTMeanAlignedLarge_i, psiRasterNRTCI95AlignedLarge_i, ~, ~,...
        psiRasterNRTMeanAlignedScaledLarge_i, psiRasterNRTCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterNRT_t, tInterp);
    [psiRasterNRT2MeanAligned_i, psiRasterNRT2CI95Aligned_i, ~, ~,...
        psiRasterNRT2MeanAlignedScaled_i, psiRasterNRT2CI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterNRT2_t, tInterp);
    [psiRasterNRT2MeanAlignedLarge_i, psiRasterNRT2CI95AlignedLarge_i, ~, ~,...
        psiRasterNRT2MeanAlignedScaledLarge_i, psiRasterNRT2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterNRT2_t, tInterp);
    [psiRasterTCMeanAligned_i, psiRasterTCCI95Aligned_i, ~, ~,...
        psiRasterTCMeanAlignedScaled_i, psiRasterTCCI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterTC_t, tInterp);
    [psiRasterTCMeanAlignedLarge_i, psiRasterTCCI95AlignedLarge_i, ~, ~,...
        psiRasterTCMeanAlignedScaledLarge_i, psiRasterTCCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterTC_t, tInterp);
    [psiRasterTC2MeanAligned_i, psiRasterTC2CI95Aligned_i, ~, ~,...
        psiRasterTC2MeanAlignedScaled_i, psiRasterTC2CI95AlignedScaled_i] = frAlign(interictalInterp, psiRasterTC2_t, tInterp);
    [psiRasterTC2MeanAlignedLarge_i, psiRasterTC2CI95AlignedLarge_i, ~, ~,...
        psiRasterTC2MeanAlignedScaledLarge_i, psiRasterTC2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp, psiRasterTC2_t, tInterp);
    
    psiRasterMeanAlignedScaled_i = [psiRasterCx23MeanAlignedScaled_i; psiRasterCx23iMeanAlignedScaled_i; psiRasterCx4MeanAlignedScaled_i;...
        psiRasterCx4iMeanAlignedScaled_i; psiRasterCx5MeanAlignedScaled_i; psiRasterCx5iMeanAlignedScaled_i; psiRasterCx6MeanAlignedScaled_i;...
        psiRasterCx6iMeanAlignedScaled_i; psiRasterNRTMeanAlignedScaled_i; psiRasterNRT2MeanAlignedScaled_i; psiRasterTCMeanAlignedScaled_i;...
        psiRasterTC2MeanAlignedScaled_i];
    psiRasterCI95AlignedScaled_i = [psiRasterCx23CI95AlignedScaled_i; psiRasterCx23iCI95AlignedScaled_i; psiRasterCx4CI95AlignedScaled_i;...
        psiRasterCx4iCI95AlignedScaled_i; psiRasterCx5CI95AlignedScaled_i; psiRasterCx5iCI95AlignedScaled_i; psiRasterCx6CI95AlignedScaled_i;...
        psiRasterCx6iCI95AlignedScaled_i; psiRasterNRTCI95AlignedScaled_i; psiRasterNRT2CI95AlignedScaled_i; psiRasterTCCI95AlignedScaled_i;...
        psiRasterTC2CI95AlignedScaled_i];
    fPSIraster = frAlignPlot(psiRasterMeanAlignedScaled_i, psiRasterCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i,...
        colours, lineTypes, 'PSI', legendEntries, 'Spiking PSI');
    
    [phaseDiffRasterAllMeanAligned_i, phaseDiffRasterAllCI95Aligned_i, tStartAligned_i, tEndAligned_i,...
        phaseDiffRasterAllMeanAlignedScaled_i, phaseDiffRasterAllCI95AlignedScaled_i, tStartAlignedScaled_i,...
        tEndAlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterAll, tInterp, 'circularNP');
    [phaseDiffRasterAllMeanAlignedLarge_i, phaseDiffRasterAllCI95AlignedLarge_i, tStartAlignedLarge_i, tEndAlignedLarge_i,...
        phaseDiffRasterAllMeanAlignedScaledLarge_i, phaseDiffRasterAllCI95AlignedScaledLarge_i, tStartAlignedScaledLarge_i,...
        tEndAlignedScaledLarge_i] = frAlign(interictalLargeInterp, phaseDiffRasterAll, tInterp, 'circularNP');
    [phaseDiffRasterCx23MeanAligned_i, phaseDiffRasterCx23CI95Aligned_i, ~, ~,...
        phaseDiffRasterCx23MeanAlignedScaled_i, phaseDiffRasterCx23CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterCx23, tInterp, 'circularNP');
    [phaseDiffRasterCx23MeanAlignedLarge_i, phaseDiffRasterCx23CI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterCx23MeanAlignedScaledLarge_i, phaseDiffRasterCx23CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterCx23, tInterp, 'circularNP');
    [phaseDiffRasterCx23iMeanAligned_i, phaseDiffRasterCx23iCI95Aligned_i, ~, ~,...
        phaseDiffRasterCx23iMeanAlignedScaled_i, phaseDiffRasterCx23iCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterCx23i, tInterp, 'circularNP');
    [phaseDiffRasterCx23iMeanAlignedLarge_i, phaseDiffRasterCx23iCI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterCx23iMeanAlignedScaledLarge_i, phaseDiffRasterCx23iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterCx23i, tInterp, 'circularNP');
    [phaseDiffRasterCx4MeanAligned_i, phaseDiffRasterCx4CI95Aligned_i, ~, ~,...
        phaseDiffRasterCx4MeanAlignedScaled_i, phaseDiffRasterCx4CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterCx4, tInterp, 'circularNP');
    [phaseDiffRasterCx4MeanAlignedLarge_i, phaseDiffRasterCx4CI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterCx4MeanAlignedScaledLarge_i, phaseDiffRasterCx4CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterCx4, tInterp, 'circularNP');
    [phaseDiffRasterCx4iMeanAligned_i, phaseDiffRasterCx4iCI95Aligned_i, ~, ~,...
        phaseDiffRasterCx4iMeanAlignedScaled_i, phaseDiffRasterCx4iCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterCx4i, tInterp, 'circularNP');
    [phaseDiffRasterCx4iMeanAlignedLarge_i, phaseDiffRasterCx4iCI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterCx4iMeanAlignedScaledLarge_i, phaseDiffRasterCx4iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterCx4i, tInterp, 'circularNP');
    [phaseDiffRasterCx5MeanAligned_i, phaseDiffRasterCx5CI95Aligned_i, ~, ~,...
        phaseDiffRasterCx5MeanAlignedScaled_i, phaseDiffRasterCx5CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterCx5, tInterp, 'circularNP');
    [phaseDiffRasterCx5MeanAlignedLarge_i, phaseDiffRasterCx5CI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterCx5MeanAlignedScaledLarge_i, phaseDiffRasterCx5CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterCx5, tInterp, 'circularNP');
    [phaseDiffRasterCx5iMeanAligned_i, phaseDiffRasterCx5iCI95Aligned_i, ~, ~,...
        phaseDiffRasterCx5iMeanAlignedScaled_i, phaseDiffRasterCx5iCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterCx5i, tInterp, 'circularNP');
    [phaseDiffRasterCx5iMeanAlignedLarge_i, phaseDiffRasterCx5iCI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterCx5iMeanAlignedScaledLarge_i, phaseDiffRasterCx5iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterCx5i, tInterp, 'circularNP');
    [phaseDiffRasterCx6MeanAligned_i, phaseDiffRasterCx6CI95Aligned_i, ~, ~,...
        phaseDiffRasterCx6MeanAlignedScaled_i, phaseDiffRasterCx6CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterCx6, tInterp, 'circularNP');
    [phaseDiffRasterCx6MeanAlignedLarge_i, phaseDiffRasterCx6CI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterCx6MeanAlignedScaledLarge_i, phaseDiffRasterCx6CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterCx6, tInterp, 'circularNP');
    [phaseDiffRasterCx6iMeanAligned_i, phaseDiffRasterCx6iCI95Aligned_i, ~, ~,...
        phaseDiffRasterCx6iMeanAlignedScaled_i, phaseDiffRasterCx6iCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterCx6i, tInterp, 'circularNP');
    [phaseDiffRasterCx6iMeanAlignedLarge_i, phaseDiffRasterCx6iCI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterCx6iMeanAlignedScaledLarge_i, phaseDiffRasterCx6iCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterCx6i, tInterp, 'circularNP');
    [phaseDiffRasterNRTMeanAligned_i, phaseDiffRasterNRTCI95Aligned_i, ~, ~,...
        phaseDiffRasterNRTMeanAlignedScaled_i, phaseDiffRasterNRTCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterNRT, tInterp, 'circularNP');
    [phaseDiffRasterNRTMeanAlignedLarge_i, phaseDiffRasterNRTCI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterNRTMeanAlignedScaledLarge_i, phaseDiffRasterNRTCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterNRT, tInterp, 'circularNP');
    [phaseDiffRasterNRT2MeanAligned_i, phaseDiffRasterNRT2CI95Aligned_i, ~, ~,...
        phaseDiffRasterNRT2MeanAlignedScaled_i, phaseDiffRasterNRT2CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterNRT2, tInterp, 'circularNP');
    [phaseDiffRasterNRT2MeanAlignedLarge_i, phaseDiffRasterNRT2CI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterNRT2MeanAlignedScaledLarge_i, phaseDiffRasterNRT2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterNRT2, tInterp, 'circularNP');
    [phaseDiffRasterTCMeanAligned_i, phaseDiffRasterTCCI95Aligned_i, ~, ~,...
        phaseDiffRasterTCMeanAlignedScaled_i, phaseDiffRasterTCCI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterTC, tInterp, 'circularNP');
    [phaseDiffRasterTCMeanAlignedLarge_i, phaseDiffRasterTCCI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterTCMeanAlignedScaledLarge_i, phaseDiffRasterTCCI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterTC, tInterp, 'circularNP');
    [phaseDiffRasterTC2MeanAligned_i, phaseDiffRasterTC2CI95Aligned_i, ~, ~,...
        phaseDiffRasterTC2MeanAlignedScaled_i, phaseDiffRasterTC2CI95AlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterTC2, tInterp, 'circularNP');
    [phaseDiffRasterTC2MeanAlignedLarge_i, phaseDiffRasterTC2CI95AlignedLarge_i, ~, ~,...
        phaseDiffRasterTC2MeanAlignedScaledLarge_i, phaseDiffRasterTC2CI95AlignedScaledLarge_i] = frAlign(interictalLargeInterp,...
        phaseDiffRasterTC2, tInterp, 'circularNP');
    
    phaseDiffRasterMeanAlignedScaled_i = [phaseDiffRasterCx23MeanAlignedScaled_i; phaseDiffRasterCx23iMeanAlignedScaled_i;...
        phaseDiffRasterCx4MeanAlignedScaled_i; phaseDiffRasterCx4iMeanAlignedScaled_i; phaseDiffRasterCx5MeanAlignedScaled_i;...
        phaseDiffRasterCx5iMeanAlignedScaled_i; phaseDiffRasterCx6MeanAlignedScaled_i; phaseDiffRasterCx6iMeanAlignedScaled_i;...
        phaseDiffRasterNRTMeanAlignedScaled_i; phaseDiffRasterNRT2MeanAlignedScaled_i; phaseDiffRasterTCMeanAlignedScaled_i;...
        phaseDiffRasterTC2MeanAlignedScaled_i];
    phaseDiffRasterCI95AlignedScaled_i = [phaseDiffRasterCx23CI95AlignedScaled_i; phaseDiffRasterCx23iCI95AlignedScaled_i;...
        phaseDiffRasterCx4CI95AlignedScaled_i; phaseDiffRasterCx4iCI95AlignedScaled_i; phaseDiffRasterCx5CI95AlignedScaled_i;...
        phaseDiffRasterCx5iCI95AlignedScaled_i; phaseDiffRasterCx6CI95AlignedScaled_i; phaseDiffRasterCx6iCI95AlignedScaled_i;...
        phaseDiffRasterNRTCI95AlignedScaled_i; phaseDiffRasterNRT2CI95AlignedScaled_i; phaseDiffRasterTCCI95AlignedScaled_i;...
        phaseDiffRasterTC2CI95AlignedScaled_i];
    fPhaseDiffRaster = frAlignPlot(phaseDiffRasterMeanAlignedScaled_i, phaseDiffRasterCI95AlignedScaled_i, tStartAlignedScaled_i, tEndAlignedScaled_i,...
        colours, lineTypes, 'Phase (rad)', legendEntries, 'Hilbert phase difference (spiking)');

    [phaseDiffRasterAllMeanAlignedInitial_i, phaseDiffRasterAllCI95AlignedInitial_i, tStartAligned, tEndAligned,...
        phaseDiffRasterAllMeanAlignedScaledInitial_i, phaseDiffRasterAllCI95AlignedScaledInitial_i, tStartAlignedScaled_i,...
        tEndAlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterAllInitial, tInterp, 'circularNP');
    [phaseDiffRasterCx23MeanAlignedInitial_i, phaseDiffRasterCx23CI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterCx23MeanAlignedScaledInitial_i, phaseDiffRasterCx23CI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterCx23Initial, tInterp, 'circularNP');
    [phaseDiffRasterCx23iMeanAlignedInitial_i, phaseDiffRasterCx23iCI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterCx23iMeanAlignedScaledInitial_i, phaseDiffRasterCx23iCI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterCx23iInitial, tInterp, 'circularNP');
    [phaseDiffRasterCx4MeanAlignedInitial_i, phaseDiffRasterCx4CI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterCx4MeanAlignedScaledInitial_i, phaseDiffRasterCx4CI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterCx4Initial, tInterp, 'circularNP');
    [phaseDiffRasterCx4iMeanAlignedInitial_i, phaseDiffRasterCx4iCI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterCx4iMeanAlignedScaledInitial_i, phaseDiffRasterCx4iCI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterCx4iInitial, tInterp, 'circularNP');
    [phaseDiffRasterCx5MeanAlignedInitial_i, phaseDiffRasterCx5CI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterCx5MeanAlignedScaledInitial_i, phaseDiffRasterCx5CI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterCx5Initial, tInterp, 'circularNP');
    [phaseDiffRasterCx5iMeanAlignedInitial_i, phaseDiffRasterCx5iCI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterCx5iMeanAlignedScaledInitial_i, phaseDiffRasterCx5iCI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterCx5iInitial, tInterp, 'circularNP');
    [phaseDiffRasterCx6MeanAlignedInitial_i, phaseDiffRasterCx6CI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterCx6MeanAlignedScaledInitial_i, phaseDiffRasterCx6CI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterCx6Initial, tInterp, 'circularNP');
    [phaseDiffRasterCx6iMeanAlignedInitial_i, phaseDiffRasterCx6iCI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterCx6iMeanAlignedScaledInitial_i, phaseDiffRasterCx6iCI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterCx6iInitial, tInterp, 'circularNP');
    [phaseDiffRasterNRTMeanAlignedInitial_i, phaseDiffRasterNRTCI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterNRTMeanAlignedScaledInitial_i, phaseDiffRasterNRTCI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterNRTInitial, tInterp, 'circularNP');
    [phaseDiffRasterNRT2MeanAlignedInitial_i, phaseDiffRasterNRT2CI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterNRT2MeanAlignedScaledInitial_i, phaseDiffRasterNRT2CI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterNRT2Initial, tInterp, 'circularNP');
    [phaseDiffRasterTCMeanAlignedInitial_i, phaseDiffRasterTCCI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterTCMeanAlignedScaledInitial_i, phaseDiffRasterTCCI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterTCInitial, tInterp, 'circularNP');
    [phaseDiffRasterTC2MeanAlignedInitial_i, phaseDiffRasterTC2CI95AlignedInitial_i, ~, ~,...
        phaseDiffRasterTC2MeanAlignedScaledInitial_i, phaseDiffRasterTC2CI95AlignedScaledInitial_i] = frAlign(interictalInterp, phaseDiffRasterTC2Initial, tInterp, 'circularNP');
    
    phaseDiffRasterMeanAlignedScaledInitial_i = [phaseDiffRasterCx23MeanAlignedScaledInitial_i; phaseDiffRasterCx23iMeanAlignedScaledInitial_i;...
        phaseDiffRasterCx4MeanAlignedScaledInitial_i; phaseDiffRasterCx4iMeanAlignedScaledInitial_i; phaseDiffRasterCx5MeanAlignedScaledInitial_i;...
        phaseDiffRasterCx5iMeanAlignedScaledInitial_i; phaseDiffRasterCx6MeanAlignedScaledInitial_i; phaseDiffRasterCx6iMeanAlignedScaledInitial_i;...
        phaseDiffRasterNRTMeanAlignedScaledInitial_i; phaseDiffRasterNRT2MeanAlignedScaledInitial_i; phaseDiffRasterTCMeanAlignedScaledInitial_i;...
        phaseDiffRasterTC2MeanAlignedScaledInitial_i];
    phaseDiffRasterCI95AlignedScaledInitial_i = [phaseDiffRasterCx23CI95AlignedScaledInitial_i; phaseDiffRasterCx23iCI95AlignedScaledInitial_i;...
        phaseDiffRasterCx4CI95AlignedScaledInitial_i; phaseDiffRasterCx4iCI95AlignedScaledInitial_i; phaseDiffRasterCx5CI95AlignedScaledInitial_i;...
        phaseDiffRasterCx5iCI95AlignedScaledInitial_i; phaseDiffRasterCx6CI95AlignedScaledInitial_i; phaseDiffRasterCx6iCI95AlignedScaledInitial_i;...
        phaseDiffRasterNRTCI95AlignedScaledInitial_i; phaseDiffRasterNRT2CI95AlignedScaledInitial_i; phaseDiffRasterTCCI95AlignedScaledInitial_i;...
        phaseDiffRasterTC2CI95AlignedScaledInitial_i];
    fPhaseDiffRaster = frAlignPlot(phaseDiffRasterMeanAlignedScaledInitial_i, phaseDiffRasterCI95AlignedScaledInitial_i, tStartAlignedScaled_i, tEndAlignedScaled_i,...
        colours, lineTypes, 'Phase (rad)', legendEntries, 'Hilbert phase difference (initial spiking)');

    [phaseDiffRasterAllMeanAlignedFinal_i, phaseDiffRasterAllCI95AlignedFinal_i, tStartAligned, tEndAligned,...
        phaseDiffRasterAllMeanAlignedScaledFinal_i, phaseDiffRasterAllCI95AlignedScaledFinal_i, tStartAlignedScaled_i,...
        tEndAlignedScaled_i] = frAlign(interictalInterp, phaseDiffRasterAllFinal, tInterp, 'circularNP');
    [phaseDiffRasterCx23MeanAlignedFinal_i, phaseDiffRasterCx23CI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterCx23MeanAlignedScaledFinal_i, phaseDiffRasterCx23CI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterCx23Final, tInterp, 'circularNP');
    [phaseDiffRasterCx23iMeanAlignedFinal_i, phaseDiffRasterCx23iCI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterCx23iMeanAlignedScaledFinal_i, phaseDiffRasterCx23iCI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterCx23iFinal, tInterp, 'circularNP');
    [phaseDiffRasterCx4MeanAlignedFinal_i, phaseDiffRasterCx4CI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterCx4MeanAlignedScaledFinal_i, phaseDiffRasterCx4CI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterCx4Final, tInterp, 'circularNP');
    [phaseDiffRasterCx4iMeanAlignedFinal_i, phaseDiffRasterCx4iCI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterCx4iMeanAlignedScaledFinal_i, phaseDiffRasterCx4iCI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterCx4iFinal, tInterp, 'circularNP');
    [phaseDiffRasterCx5MeanAlignedFinal_i, phaseDiffRasterCx5CI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterCx5MeanAlignedScaledFinal_i, phaseDiffRasterCx5CI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterCx5Final, tInterp, 'circularNP');
    [phaseDiffRasterCx5iMeanAlignedFinal_i, phaseDiffRasterCx5iCI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterCx5iMeanAlignedScaledFinal_i, phaseDiffRasterCx5iCI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterCx5iFinal, tInterp, 'circularNP');
    [phaseDiffRasterCx6MeanAlignedFinal_i, phaseDiffRasterCx6CI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterCx6MeanAlignedScaledFinal_i, phaseDiffRasterCx6CI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterCx6Final, tInterp, 'circularNP');
    [phaseDiffRasterCx6iMeanAlignedFinal_i, phaseDiffRasterCx6iCI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterCx6iMeanAlignedScaledFinal_i, phaseDiffRasterCx6iCI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterCx6iFinal, tInterp, 'circularNP');
    [phaseDiffRasterNRTMeanAlignedFinal_i, phaseDiffRasterNRTCI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterNRTMeanAlignedScaledFinal_i, phaseDiffRasterNRTCI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterNRTFinal, tInterp, 'circularNP');
    [phaseDiffRasterNRT2MeanAlignedFinal_i, phaseDiffRasterNRT2CI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterNRT2MeanAlignedScaledFinal_i, phaseDiffRasterNRT2CI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterNRT2Final, tInterp, 'circularNP');
    [phaseDiffRasterTCMeanAlignedFinal_i, phaseDiffRasterTCCI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterTCMeanAlignedScaledFinal_i, phaseDiffRasterTCCI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterTCFinal, tInterp, 'circularNP');
    [phaseDiffRasterTC2MeanAlignedFinal_i, phaseDiffRasterTC2CI95AlignedFinal_i, ~, ~,...
        phaseDiffRasterTC2MeanAlignedScaledFinal_i, phaseDiffRasterTC2CI95AlignedScaledFinal_i] = frAlign(interictalInterp, phaseDiffRasterTC2Final, tInterp, 'circularNP');
    
    phaseDiffRasterMeanAlignedScaledFinal_i = [phaseDiffRasterCx23MeanAlignedScaledFinal_i; phaseDiffRasterCx23iMeanAlignedScaledFinal_i;...
        phaseDiffRasterCx4MeanAlignedScaledFinal_i; phaseDiffRasterCx4iMeanAlignedScaledFinal_i; phaseDiffRasterCx5MeanAlignedScaledFinal_i;...
        phaseDiffRasterCx5iMeanAlignedScaledFinal_i; phaseDiffRasterCx6MeanAlignedScaledFinal_i; phaseDiffRasterCx6iMeanAlignedScaledFinal_i;...
        phaseDiffRasterNRTMeanAlignedScaledFinal_i; phaseDiffRasterNRT2MeanAlignedScaledFinal_i; phaseDiffRasterTCMeanAlignedScaledFinal_i;...
        phaseDiffRasterTC2MeanAlignedScaledFinal_i];
    phaseDiffRasterCI95AlignedScaledFinal_i = [phaseDiffRasterCx23CI95AlignedScaledFinal_i; phaseDiffRasterCx23iCI95AlignedScaledFinal_i;...
        phaseDiffRasterCx4CI95AlignedScaledFinal_i; phaseDiffRasterCx4iCI95AlignedScaledFinal_i; phaseDiffRasterCx5CI95AlignedScaledFinal_i;...
        phaseDiffRasterCx5iCI95AlignedScaledFinal_i; phaseDiffRasterCx6CI95AlignedScaledFinal_i; phaseDiffRasterCx6iCI95AlignedScaledFinal_i;...
        phaseDiffRasterNRTCI95AlignedScaledFinal_i; phaseDiffRasterNRT2CI95AlignedScaledFinal_i; phaseDiffRasterTCCI95AlignedScaledFinal_i;...
        phaseDiffRasterTC2CI95AlignedScaledFinal_i];
    fPhaseDiffRaster = frAlignPlot(phaseDiffRasterMeanAlignedScaledFinal_i, phaseDiffRasterCI95AlignedScaledFinal_i, tStartAlignedScaled_i, tEndAlignedScaled_i,...
        colours, lineTypes, 'Phase (rad)', legendEntries, 'Hilbert phase difference (initial spiking)');
    
    save('psiData.mat', 'dt','t','dtInterp','tInterp','psiAll','psiAllCI95','psiAllmean','psiCx23','psiCx23CI95',...
        'psiCx23i','psiCx23iCI95','psiCx23imean','psiCx23mean','psiCx4','psiCx4CI95','psiCx4i',...
        'psiCx4iCI95','psiCx4imean','psiCx4mean','psiCx5','psiCx5CI95','psiCx5i','psiCx5iCI95',...
        'psiCx5imean','psiCx5mean','psiCx6','psiCx6CI95','psiCx6i','psiCx6iCI95','psiCx6imean',...
        'psiCx6mean','psiNRT','psiNRT2','psiNRT2CI95','psiNRT2mean','psiNRTCI95','psiNRTmean',...
        'psiTC','psiTC2','psiTC2CI95','psiTC2mean','psiTCCI95','psiTCmean','psiAll_t','psiAllCI95_t',...
        'psiAllmean_t','psiCx23_t','psiCx23CI95_t','psiCx23i_t','psiCx23iCI95_t','psiCx23imean_t',...
        'psiCx23mean_t','psiCx4_t','psiCx4CI95_t','psiCx4i_t','psiCx4iCI95_t','psiCx4imean_t',...
        'psiCx4mean_t','psiCx5_t','psiCx5CI95_t','psiCx5i_t','psiCx5iCI95_t','psiCx5imean_t',...
        'psiCx5mean_t','psiCx6_t','psiCx6CI95_t','psiCx6i_t','psiCx6iCI95_t','psiCx6imean_t',...
        'psiCx6mean_t','psiNRT_t','psiNRT2_t','psiNRT2CI95_t','psiNRT2mean_t','psiNRTCI95_t',...
        'psiNRTmean_t','psiTC_t','psiTC2_t','psiTC2CI95_t','psiTC2mean_t','psiTCCI95_t',...
        'psiTCmean_t','phaseDiffAll','phaseDiffAllCI95','phaseDiffAllmean','phaseDiffCx23',...
        'phaseDiffCx23CI95','phaseDiffCx23i','phaseDiffCx23iCI95','phaseDiffCx23imean',...
        'phaseDiffCx23mean','phaseDiffCx4','phaseDiffCx4CI95','phaseDiffCx4i','phaseDiffCx4iCI95',...
        'phaseDiffCx4imean','phaseDiffCx4mean','phaseDiffCx5','phaseDiffCx5CI95','phaseDiffCx5i',...
        'phaseDiffCx5iCI95','phaseDiffCx5imean','phaseDiffCx5mean','phaseDiffCx6',...
        'phaseDiffCx6CI95','phaseDiffCx6i','phaseDiffCx6iCI95','phaseDiffCx6imean',...
        'phaseDiffCx6mean','phaseDiffNRT','phaseDiffNRT2','phaseDiffNRT2CI95','phaseDiffNRT2mean',...
        'phaseDiffNRTCI95','phaseDiffNRTmean','phaseDiffTC','phaseDiffTC2','phaseDiffTC2CI95',...
        'phaseDiffTC2mean','phaseDiffTCCI95','phaseDiffTCmean','psiRasterAll','psiRasterAllCI95','psiRasterAllmean','psiRasterCx23',...
        'psiRasterCx23CI95','psiRasterCx23i','psiRasterCx23iCI95','psiRasterCx23imean','psiRasterCx23mean','psiRasterCx4',...
        'psiRasterCx4CI95','psiRasterCx4i','psiRasterCx4iCI95','psiRasterCx4imean','psiRasterCx4mean','psiRasterCx5','psiRasterCx5CI95',...
        'psiRasterCx5i','psiRasterCx5iCI95','psiRasterCx5imean','psiRasterCx5mean','psiRasterCx6','psiRasterCx6CI95','psiRasterCx6i',...
        'psiRasterCx6iCI95','psiRasterCx6imean','psiRasterCx6mean','psiRasterNRT','psiRasterNRT2','psiRasterNRT2CI95',...
        'psiRasterNRT2mean','psiRasterNRTCI95','psiRasterNRTmean','psiRasterTC','psiRasterTC2','psiRasterTC2CI95','psiRasterTC2mean',...
        'psiRasterTCCI95','psiRasterTCmean','psiRasterAll_t','psiRasterAllCI95_t','psiRasterAllmean_t','psiRasterCx23_t',...
        'psiRasterCx23CI95_t','psiRasterCx23i_t','psiRasterCx23iCI95_t','psiRasterCx23imean_t','psiRasterCx23mean_t','psiRasterCx4_t',...
        'psiRasterCx4CI95_t','psiRasterCx4i_t','psiRasterCx4iCI95_t','psiRasterCx4imean_t','psiRasterCx4mean_t','psiRasterCx5_t',...
        'psiRasterCx5CI95_t','psiRasterCx5i_t','psiRasterCx5iCI95_t','psiRasterCx5imean_t','psiRasterCx5mean_t','psiRasterCx6_t',...
        'psiRasterCx6CI95_t','psiRasterCx6i_t','psiRasterCx6iCI95_t','psiRasterCx6imean_t','psiRasterCx6mean_t','psiRasterNRT_t',...
        'psiRasterNRT2_t','psiRasterNRT2CI95_t','psiRasterNRT2mean_t','psiRasterNRTCI95_t','psiRasterNRTmean_t','psiRasterTC_t',...
        'psiRasterTC2_t','psiRasterTC2CI95_t','psiRasterTC2mean_t','psiRasterTCCI95_t','psiRasterTCmean_t','phaseDiffRasterAll',...
        'phaseDiffRasterAllCI95','phaseDiffRasterAllmean','phaseDiffRasterCx23','phaseDiffRasterCx23CI95','phaseDiffRasterCx23i',...
        'phaseDiffRasterCx23iCI95','phaseDiffRasterCx23imean','phaseDiffRasterCx23mean','phaseDiffRasterCx4','phaseDiffRasterCx4CI95',...
        'phaseDiffRasterCx4i','phaseDiffRasterCx4iCI95','phaseDiffRasterCx4imean','phaseDiffRasterCx4mean','phaseDiffRasterCx5',...
        'phaseDiffRasterCx5CI95','phaseDiffRasterCx5i','phaseDiffRasterCx5iCI95','phaseDiffRasterCx5imean','phaseDiffRasterCx5mean',...
        'phaseDiffRasterCx6','phaseDiffRasterCx6CI95','phaseDiffRasterCx6i','phaseDiffRasterCx6iCI95','phaseDiffRasterCx6imean',...
        'phaseDiffRasterCx6mean','phaseDiffRasterNRT','phaseDiffRasterNRT2','phaseDiffRasterNRT2CI95','phaseDiffRasterNRT2mean',...
        'phaseDiffRasterNRTCI95','phaseDiffRasterNRTmean','phaseDiffRasterTC','phaseDiffRasterTC2','phaseDiffRasterTC2CI95',...
        'phaseDiffRasterTC2mean','phaseDiffRasterTCCI95','phaseDiffRasterTCmean',...
        'phaseDiffRasterCx23Initial','phaseDiffRasterCx23iInitial','phaseDiffRasterCx4Initial','phaseDiffRasterCx4iInitial',...
        'phaseDiffRasterCx5Initial','phaseDiffRasterCx5iInitial','phaseDiffRasterCx6Initial','phaseDiffRasterCx6iInitial',...
        'phaseDiffRasterNRTInitial','phaseDiffRasterNRT2Initial','phaseDiffRasterTCInitial','phaseDiffRasterTC2Initial',...
        'phaseDiffRasterCx23Final','phaseDiffRasterCx23iFinal','phaseDiffRasterCx4Final','phaseDiffRasterCx4iFinal',...
        'phaseDiffRasterCx5Final','phaseDiffRasterCx5iFinal','phaseDiffRasterCx6Final','phaseDiffRasterCx6iFinal',...
        'phaseDiffRasterNRTFinal','phaseDiffRasterNRT2Final','phaseDiffRasterTCFinal','phaseDiffRasterTC2Final',...
        'iRange','nIN','nNRT','nPY','nTC','psiWindow',...
        'psiRasterMeanAlignedScaled','psiRasterCI95AlignedScaled',...
        'phaseDiffRasterMeanAlignedScaled','phaseDiffRasterCI95AlignedScaled','phaseDiffRasterMeanAlignedScaledInitial','phaseDiffRasterCI95AlignedScaledInitial',...
        'phaseDiffRasterMeanAlignedScaledFinal','phaseDiffRasterCI95AlignedScaledFinal','tStartAlignedScaled','tEndAlignedScaled',...
        'psiRasterMeanAlignedScaled_i','psiRasterCI95AlignedScaled_i',...
        'phaseDiffRasterMeanAlignedScaled_i','phaseDiffRasterCI95AlignedScaled_i','phaseDiffRasterMeanAlignedScaledInitial_i','phaseDiffRasterCI95AlignedScaledInitial_i',...
        'phaseDiffRasterMeanAlignedScaledFinal_i','phaseDiffRasterCI95AlignedScaledFinal_i','tStartAlignedScaled_i','tEndAlignedScaled_i');
end

% Save
if coherence && fullRun
    save('coherenceData.mat', 'dt','t','dtInterp','tInterp','freq','cohAll','cohAll_conf','cohAllCI95','cohAllmean','cohCx23','cohCx23CI95',...
        'cohCx23i','cohCx23iCI95','cohCx23imean','cohCx23mean','cohCx4','cohCx4CI95','cohCx4i','cohCx4iCI95',...
        'cohCx4imean','cohCx4mean','cohCx5','cohCx5CI95','cohCx5i','cohCx5iCI95','cohCx5imean','cohCx5mean',...
        'cohCx6','cohCx6CI95','cohCx6i','cohCx6iCI95','cohCx6imean','cohCx6mean','cohNRT','cohNRT2','cohNRT2CI95',...
        'cohNRT2mean','cohNRTCI95','cohNRTmean','cohTC','cohTC2','cohTC2CI95','cohTC2mean','cohTCCI95','cohTCmean',...
        'phaseAll','phaseAll_confU','phaseAll_confL','phaseAllCI95','phaseAllmean','phaseCx23','phaseCx23CI95',...
        'phaseCx23i','phaseCx23iCI95','phaseCx23imean','phaseCx23mean','phaseCx4','phaseCx4CI95','phaseCx4i',...
        'phaseCx4iCI95','phaseCx4imean','phaseCx4mean','phaseCx5','phaseCx5CI95','phaseCx5i','phaseCx5iCI95',...
        'phaseCx5imean','phaseCx5mean','phaseCx6','phaseCx6CI95','phaseCx6i','phaseCx6iCI95','phaseCx6imean',...
        'phaseCx6mean','phaseNRT','phaseNRT2','phaseNRT2CI95','phaseNRT2mean','phaseNRTCI95','phaseNRTmean',...
        'phaseTC','phaseTC2','phaseTC2CI95','phaseTC2mean','phaseTCCI95','phaseTCmean','iRange','nIN','nNRT',...
        'nPY','nTC');
end
if xCorrelation && fullRun
    save('xCorrelationData.mat', 'dt','t','dtInterp','tInterp','xCorrAll','xCorrAllCI95','xCorrAllmean','xCorrCx23','xCorrCx23CI95',...
        'xCorrCx23i','xCorrCx23iCI95','xCorrCx23imean','xCorrCx23mean','xCorrCx4','xCorrCx4CI95','xCorrCx4i',...
        'xCorrCx4iCI95','xCorrCx4imean','xCorrCx4mean','xCorrCx5','xCorrCx5CI95','xCorrCx5i','xCorrCx5iCI95',...
        'xCorrCx5imean','xCorrCx5mean','xCorrCx6','xCorrCx6CI95','xCorrCx6i','xCorrCx6iCI95','xCorrCx6imean',...
        'xCorrCx6mean','xCorrNRT','xCorrNRT2','xCorrNRT2CI95','xCorrNRT2mean','xCorrNRTCI95','xCorrNRTmean',...
        'xCorrTC','xCorrTC2','xCorrTC2CI95','xCorrTC2mean','xCorrTCCI95','xCorrTCmean','iRange','nIN','nNRT',...
        'nPY','nTC','window');
end
if eegts && fullRun
    if strcmpi(type, 'SWDs_human')
        save('eegtsData.mat', 'dt','t','dtInterp','tInterp','eegtsAll','eegtsAllCI95','eegtsAllmean','eegtsCx23','eegtsCx23CI95',...
            'eegtsCx23i','eegtsCx23iCI95','eegtsCx23imean','eegtsCx23mean','eegtsCx4','eegtsCx4CI95','eegtsCx4i',...
            'eegtsCx4iCI95','eegtsCx4imean','eegtsCx4mean','eegtsCx5','eegtsCx5CI95','eegtsCx5i','eegtsCx5iCI95',...
            'eegtsCx5imean','eegtsCx5mean','eegtsCx6','eegtsCx6CI95','eegtsCx6i','eegtsCx6iCI95','eegtsCx6imean',...
            'eegtsCx6mean','eegtsNRT','eegtsNRT2','eegtsNRT2CI95','eegtsNRT2mean','eegtsNRTCI95','eegtsNRTmean',...
            'eegtsTC','eegtsTC2','eegtsTC2CI95','eegtsTC2mean','eegtsTCCI95','eegtsTCmean','eegtsInitAll',...
            'eegtsInitAllCI95','eegtsInitAllmean','eegtsInitCx23','eegtsInitCx23CI95','eegtsInitCx23i',...
            'eegtsInitCx23iCI95','eegtsInitCx23imean','eegtsInitCx23mean','eegtsInitCx4','eegtsInitCx4CI95',...
            'eegtsInitCx4i','eegtsInitCx4iCI95','eegtsInitCx4imean','eegtsInitCx4mean','eegtsInitCx5',...
            'eegtsInitCx5CI95','eegtsInitCx5i','eegtsInitCx5iCI95','eegtsInitCx5imean','eegtsInitCx5mean',...
            'eegtsInitCx6','eegtsInitCx6CI95','eegtsInitCx6i','eegtsInitCx6iCI95','eegtsInitCx6imean',...
            'eegtsInitCx6mean','eegtsInitNRT','eegtsInitNRT2','eegtsInitNRT2CI95','eegtsInitNRT2mean',...
            'eegtsInitNRTCI95','eegtsInitNRTmean','eegtsInitTC','eegtsInitTC2','eegtsInitTC2CI95',...
            'eegtsInitTC2mean','eegtsInitTCCI95','eegtsInitTCmean','eegtsInitLargeAll','eegtsInitLargeAllCI95',...
            'eegtsInitLargeAllmean','eegtsInitLargeCx23','eegtsInitLargeCx23CI95','eegtsInitLargeCx23i',...
            'eegtsInitLargeCx23iCI95','eegtsInitLargeCx23imean','eegtsInitLargeCx23mean','eegtsInitLargeCx4',...
            'eegtsInitLargeCx4CI95','eegtsInitLargeCx4i','eegtsInitLargeCx4iCI95','eegtsInitLargeCx4imean',...
            'eegtsInitLargeCx4mean','eegtsInitLargeCx5','eegtsInitLargeCx5CI95','eegtsInitLargeCx5i',...
            'eegtsInitLargeCx5iCI95','eegtsInitLargeCx5imean','eegtsInitLargeCx5mean','eegtsInitLargeCx6',...
            'eegtsInitLargeCx6CI95','eegtsInitLargeCx6i','eegtsInitLargeCx6iCI95','eegtsInitLargeCx6imean',...
            'eegtsInitLargeCx6mean','eegtsInitLargeNRT','eegtsInitLargeNRT2','eegtsInitLargeNRT2CI95',...
            'eegtsInitLargeNRT2mean','eegtsInitLargeNRTCI95','eegtsInitLargeNRTmean','eegtsInitLargeTC',...
            'eegtsInitLargeTC2','eegtsInitLargeTC2CI95','eegtsInitLargeTC2mean','eegtsInitLargeTCCI95',...
            'eegtsInitLargeTCmean','eegtsFinalAll',...
            'eegtsFinalAllCI95','eegtsFinalAllmean','eegtsFinalCx23','eegtsFinalCx23CI95','eegtsFinalCx23i',...
            'eegtsFinalCx23iCI95','eegtsFinalCx23imean','eegtsFinalCx23mean','eegtsFinalCx4','eegtsFinalCx4CI95',...
            'eegtsFinalCx4i','eegtsFinalCx4iCI95','eegtsFinalCx4imean','eegtsFinalCx4mean','eegtsFinalCx5',...
            'eegtsFinalCx5CI95','eegtsFinalCx5i','eegtsFinalCx5iCI95','eegtsFinalCx5imean','eegtsFinalCx5mean',...
            'eegtsFinalCx6','eegtsFinalCx6CI95','eegtsFinalCx6i','eegtsFinalCx6iCI95','eegtsFinalCx6imean',...
            'eegtsFinalCx6mean','eegtsFinalNRT','eegtsFinalNRT2','eegtsFinalNRT2CI95','eegtsFinalNRT2mean',...
            'eegtsFinalNRTCI95','eegtsFinalNRTmean','eegtsFinalTC','eegtsFinalTC2','eegtsFinalTC2CI95',...
            'eegtsFinalTC2mean','eegtsFinalTCCI95','eegtsFinalTCmean','eegtsFinalLargeAll','eegtsFinalLargeAllCI95',...
            'eegtsFinalLargeAllmean','eegtsFinalLargeCx23','eegtsFinalLargeCx23CI95','eegtsFinalLargeCx23i',...
            'eegtsFinalLargeCx23iCI95','eegtsFinalLargeCx23imean','eegtsFinalLargeCx23mean','eegtsFinalLargeCx4',...
            'eegtsFinalLargeCx4CI95','eegtsFinalLargeCx4i','eegtsFinalLargeCx4iCI95','eegtsFinalLargeCx4imean',...
            'eegtsFinalLargeCx4mean','eegtsFinalLargeCx5','eegtsFinalLargeCx5CI95','eegtsFinalLargeCx5i',...
            'eegtsFinalLargeCx5iCI95','eegtsFinalLargeCx5imean','eegtsFinalLargeCx5mean','eegtsFinalLargeCx6',...
            'eegtsFinalLargeCx6CI95','eegtsFinalLargeCx6i','eegtsFinalLargeCx6iCI95','eegtsFinalLargeCx6imean',...
            'eegtsFinalLargeCx6mean','eegtsFinalLargeNRT','eegtsFinalLargeNRT2','eegtsFinalLargeNRT2CI95',...
            'eegtsFinalLargeNRT2mean','eegtsFinalLargeNRTCI95','eegtsFinalLargeNRTmean','eegtsFinalLargeTC',...
            'eegtsFinalLargeTC2','eegtsFinalLargeTC2CI95','eegtsFinalLargeTC2mean','eegtsFinalLargeTCCI95',...
            'eegtsFinalLargeTCmean','iRange','nIN','nNRT','nPY','nTC','window');
    else
        save('eegtsData.mat', 'dt','t','dtInterp','tInterp','eegtsAll','eegtsAllCI95','eegtsAllmean','eegtsCx23','eegtsCx23CI95',...
            'eegtsCx23i','eegtsCx23iCI95','eegtsCx23imean','eegtsCx23mean','eegtsCx4','eegtsCx4CI95','eegtsCx4i',...
            'eegtsCx4iCI95','eegtsCx4imean','eegtsCx4mean','eegtsCx5','eegtsCx5CI95','eegtsCx5i','eegtsCx5iCI95',...
            'eegtsCx5imean','eegtsCx5mean','eegtsCx6','eegtsCx6CI95','eegtsCx6i','eegtsCx6iCI95','eegtsCx6imean',...
            'eegtsCx6mean','eegtsNRT','eegtsNRT2','eegtsNRT2CI95','eegtsNRT2mean','eegtsNRTCI95','eegtsNRTmean',...
            'eegtsTC','eegtsTC2','eegtsTC2CI95','eegtsTC2mean','eegtsTCCI95','eegtsTCmean','iRange','nIN','nNRT',...
            'nPY','nTC','window');
    end
end
if eegsts && fullRun
    if strcmpi(type, 'SWDs_human')
        save('eegstsData.mat', 'dt','t','dtInterp','tInterp','eegstsAll','eegstsAllCI95','eegstsAllmean','eegstsCx23','eegstsCx23CI95',...
            'eegstsCx23i','eegstsCx23iCI95','eegstsCx23imean','eegstsCx23mean','eegstsCx4','eegstsCx4CI95','eegstsCx4i',...
            'eegstsCx4iCI95','eegstsCx4imean','eegstsCx4mean','eegstsCx5','eegstsCx5CI95','eegstsCx5i','eegstsCx5iCI95',...
            'eegstsCx5imean','eegstsCx5mean','eegstsCx6','eegstsCx6CI95','eegstsCx6i','eegstsCx6iCI95','eegstsCx6imean',...
            'eegstsCx6mean','eegstsNRT','eegstsNRT2','eegstsNRT2CI95','eegstsNRT2mean','eegstsNRTCI95','eegstsNRTmean',...
            'eegstsTC','eegstsTC2','eegstsTC2CI95','eegstsTC2mean','eegstsTCCI95','eegstsTCmean','eegstsInitAll',...
            'eegstsInitAllCI95','eegstsInitAllmean','eegstsInitCx23','eegstsInitCx23CI95','eegstsInitCx23i',...
            'eegstsInitCx23iCI95','eegstsInitCx23imean','eegstsInitCx23mean','eegstsInitCx4','eegstsInitCx4CI95',...
            'eegstsInitCx4i','eegstsInitCx4iCI95','eegstsInitCx4imean','eegstsInitCx4mean','eegstsInitCx5',...
            'eegstsInitCx5CI95','eegstsInitCx5i','eegstsInitCx5iCI95','eegstsInitCx5imean','eegstsInitCx5mean',...
            'eegstsInitCx6','eegstsInitCx6CI95','eegstsInitCx6i','eegstsInitCx6iCI95','eegstsInitCx6imean',...
            'eegstsInitCx6mean','eegstsInitNRT','eegstsInitNRT2','eegstsInitNRT2CI95','eegstsInitNRT2mean',...
            'eegstsInitNRTCI95','eegstsInitNRTmean','eegstsInitTC','eegstsInitTC2','eegstsInitTC2CI95',...
            'eegstsInitTC2mean','eegstsInitTCCI95','eegstsInitTCmean','eegstsInitLargeAll','eegstsInitLargeAllCI95',...
            'eegstsInitLargeAllmean','eegstsInitLargeCx23','eegstsInitLargeCx23CI95','eegstsInitLargeCx23i',...
            'eegstsInitLargeCx23iCI95','eegstsInitLargeCx23imean','eegstsInitLargeCx23mean','eegstsInitLargeCx4',...
            'eegstsInitLargeCx4CI95','eegstsInitLargeCx4i','eegstsInitLargeCx4iCI95','eegstsInitLargeCx4imean',...
            'eegstsInitLargeCx4mean','eegstsInitLargeCx5','eegstsInitLargeCx5CI95','eegstsInitLargeCx5i',...
            'eegstsInitLargeCx5iCI95','eegstsInitLargeCx5imean','eegstsInitLargeCx5mean','eegstsInitLargeCx6',...
            'eegstsInitLargeCx6CI95','eegstsInitLargeCx6i','eegstsInitLargeCx6iCI95','eegstsInitLargeCx6imean',...
            'eegstsInitLargeCx6mean','eegstsInitLargeNRT','eegstsInitLargeNRT2','eegstsInitLargeNRT2CI95',...
            'eegstsInitLargeNRT2mean','eegstsInitLargeNRTCI95','eegstsInitLargeNRTmean','eegstsInitLargeTC',...
            'eegstsInitLargeTC2','eegstsInitLargeTC2CI95','eegstsInitLargeTC2mean','eegstsInitLargeTCCI95',...
            'eegstsInitLargeTCmean','eegstsFinalAll',...
            'eegstsFinalAllCI95','eegstsFinalAllmean','eegstsFinalCx23','eegstsFinalCx23CI95','eegstsFinalCx23i',...
            'eegstsFinalCx23iCI95','eegstsFinalCx23imean','eegstsFinalCx23mean','eegstsFinalCx4','eegstsFinalCx4CI95',...
            'eegstsFinalCx4i','eegstsFinalCx4iCI95','eegstsFinalCx4imean','eegstsFinalCx4mean','eegstsFinalCx5',...
            'eegstsFinalCx5CI95','eegstsFinalCx5i','eegstsFinalCx5iCI95','eegstsFinalCx5imean','eegstsFinalCx5mean',...
            'eegstsFinalCx6','eegstsFinalCx6CI95','eegstsFinalCx6i','eegstsFinalCx6iCI95','eegstsFinalCx6imean',...
            'eegstsFinalCx6mean','eegstsFinalNRT','eegstsFinalNRT2','eegstsFinalNRT2CI95','eegstsFinalNRT2mean',...
            'eegstsFinalNRTCI95','eegstsFinalNRTmean','eegstsFinalTC','eegstsFinalTC2','eegstsFinalTC2CI95',...
            'eegstsFinalTC2mean','eegstsFinalTCCI95','eegstsFinalTCmean','eegstsFinalLargeAll','eegstsFinalLargeAllCI95',...
            'eegstsFinalLargeAllmean','eegstsFinalLargeCx23','eegstsFinalLargeCx23CI95','eegstsFinalLargeCx23i',...
            'eegstsFinalLargeCx23iCI95','eegstsFinalLargeCx23imean','eegstsFinalLargeCx23mean','eegstsFinalLargeCx4',...
            'eegstsFinalLargeCx4CI95','eegstsFinalLargeCx4i','eegstsFinalLargeCx4iCI95','eegstsFinalLargeCx4imean',...
            'eegstsFinalLargeCx4mean','eegstsFinalLargeCx5','eegstsFinalLargeCx5CI95','eegstsFinalLargeCx5i',...
            'eegstsFinalLargeCx5iCI95','eegstsFinalLargeCx5imean','eegstsFinalLargeCx5mean','eegstsFinalLargeCx6',...
            'eegstsFinalLargeCx6CI95','eegstsFinalLargeCx6i','eegstsFinalLargeCx6iCI95','eegstsFinalLargeCx6imean',...
            'eegstsFinalLargeCx6mean','eegstsFinalLargeNRT','eegstsFinalLargeNRT2','eegstsFinalLargeNRT2CI95',...
            'eegstsFinalLargeNRT2mean','eegstsFinalLargeNRTCI95','eegstsFinalLargeNRTmean','eegstsFinalLargeTC',...
            'eegstsFinalLargeTC2','eegstsFinalLargeTC2CI95','eegstsFinalLargeTC2mean','eegstsFinalLargeTCCI95',...
            'eegstsFinalLargeTCmean','iRange','nIN','nNRT','nPY','nTC','window');
    else
        save('eegstsData.mat', 'dt','t','dtInterp','tInterp','eegstsAll','eegstsAllCI95','eegstsAllmean','eegstsCx23','eegstsCx23CI95',...
            'eegstsCx23i','eegstsCx23iCI95','eegstsCx23imean','eegstsCx23mean','eegstsCx4','eegstsCx4CI95','eegstsCx4i',...
            'eegstsCx4iCI95','eegstsCx4imean','eegstsCx4mean','eegstsCx5','eegstsCx5CI95','eegstsCx5i','eegstsCx5iCI95',...
            'eegstsCx5imean','eegstsCx5mean','eegstsCx6','eegstsCx6CI95','eegstsCx6i','eegstsCx6iCI95','eegstsCx6imean',...
            'eegstsCx6mean','eegstsNRT','eegstsNRT2','eegstsNRT2CI95','eegstsNRT2mean','eegstsNRTCI95','eegstsNRTmean',...
            'eegstsTC','eegstsTC2','eegstsTC2CI95','eegstsTC2mean','eegstsTCCI95','eegstsTCmean','iRange','nIN','nNRT',...
            'nPY','nTC','window');
    end
end
if vm && fullRun
    save('vmData.mat', 'dt','t','dtInterp','tInterp','vmAll','vmAllCI95','vmAllmean','vmCx23','vmCx23CI95',...
        'vmCx23i','vmCx23iCI95','vmCx23imean','vmCx23mean','vmCx4','vmCx4CI95','vmCx4i',...
        'vmCx4iCI95','vmCx4imean','vmCx4mean','vmCx5','vmCx5CI95','vmCx5i','vmCx5iCI95',...
        'vmCx5imean','vmCx5mean','vmCx6','vmCx6CI95','vmCx6i','vmCx6iCI95','vmCx6imean',...
        'vmCx6mean','vmNRT','vmNRT2','vmNRT2CI95','vmNRT2mean','vmNRTCI95','vmNRTmean',...
        'vmTC','vmTC2','vmTC2CI95','vmTC2mean','vmTCCI95','vmTCmean','iRange','nIN','nNRT',...
        'nPY','nTC');
end
if fr && fullRun
    save('frData.mat', 'dt','t','dtInterp','tInterp','frAll','frAllCI95','frAllmean','frCx23','frCx23CI95','frCx23i','frCx23iCI95',...
        'frCx23imean','frCx23mean','frCx4','frCx4CI95','frCx4i','frCx4iCI95','frCx4imean','frCx4mean','frCx5',...
        'frCx5CI95','frCx5i','frCx5iCI95','frCx5imean','frCx5mean','frCx6','frCx6CI95','frCx6i','frCx6iCI95',...
        'frCx6imean','frCx6mean','frNRT','frNRT2','frNRT2CI95','frNRT2mean','frNRTCI95','frNRTmean','frTC','frTC2',...
        'frTC2CI95','frTC2mean','frTCCI95','frTCmean','trAll','trAllCI95','trAllmean','trCx23','trCx23CI95','trCx23i',...
        'trCx23iCI95','trCx23imean','trCx23mean','trCx4','trCx4CI95','trCx4i','trCx4iCI95','trCx4imean','trCx4mean',...
        'trCx5','trCx5CI95','trCx5i','trCx5iCI95','trCx5imean','trCx5mean','trCx6','trCx6CI95','trCx6i','trCx6iCI95',...
        'trCx6imean','trCx6mean','trNRT','trNRT2','trNRT2CI95','trNRT2mean','trNRTCI95','trNRTmean','trTC','trTC2',...
        'trTC2CI95','trTC2mean','trTCCI95','trTCmean','brAll','brAllCI95','brAllmean','brCx23','brCx23CI95','brCx23i',...
        'brCx23iCI95','brCx23imean','brCx23mean','brCx4','brCx4CI95','brCx4i','brCx4iCI95','brCx4imean','brCx4mean',...
        'brCx5','brCx5CI95','brCx5i','brCx5iCI95','brCx5imean','brCx5mean','brCx6','brCx6CI95','brCx6i','brCx6iCI95',...
        'brCx6imean','brCx6mean','brNRT','brNRT2','brNRT2CI95','brNRT2mean','brNRTCI95','brNRTmean','brTC','brTC2',...
        'brTC2CI95','brTC2mean','brTCCI95','brTCmean','br2All','br2AllCI95','br2Allmean','br2Cx23','br2Cx23CI95','br2Cx23i',...
        'br2Cx23iCI95','br2Cx23imean','br2Cx23mean','br2Cx4','br2Cx4CI95','br2Cx4i','br2Cx4iCI95','br2Cx4imean','br2Cx4mean',...
        'br2Cx5','br2Cx5CI95','br2Cx5i','br2Cx5iCI95','br2Cx5imean','br2Cx5mean','br2Cx6','br2Cx6CI95','br2Cx6i','br2Cx6iCI95',...
        'br2Cx6imean','br2Cx6mean','br2NRT','br2NRT2','br2NRT2CI95','br2NRT2mean','br2NRTCI95','br2NRTmean','br2TC','br2TC2',...
        'br2TC2CI95','br2TC2mean','br2TCCI95','br2TCmean','frFrAll','frFrAllCI95','frFrAllmean','frFrCx23','frFrCx23CI95',...
        'frFrCx23i','frFrCx23iCI95','frFrCx23imean','frFrCx23mean','frFrCx4','frFrCx4CI95','frFrCx4i','frFrCx4iCI95',...
        'frFrCx4imean','frFrCx4mean','frFrCx5','frFrCx5CI95','frFrCx5i','frFrCx5iCI95','frFrCx5imean','frFrCx5mean',...
        'frFrCx6','frFrCx6CI95','frFrCx6i','frFrCx6iCI95','frFrCx6imean','frFrCx6mean','frFrNRT','frFrNRT2',...
        'frFrNRT2CI95','frFrNRT2mean','frFrNRTCI95','frFrNRTmean','frFrTC','frFrTC2','frFrTC2CI95','frFrTC2mean',...
        'frFrTCCI95','frFrTCmean','trFrAll','trFrAllCI95','trFrAllmean','trFrCx23','trFrCx23CI95','trFrCx23i',...
        'trFrCx23iCI95','trFrCx23imean','trFrCx23mean','trFrCx4','trFrCx4CI95','trFrCx4i','trFrCx4iCI95','trFrCx4imean',...
        'trFrCx4mean','trFrCx5','trFrCx5CI95','trFrCx5i','trFrCx5iCI95','trFrCx5imean','trFrCx5mean','trFrCx6',...
        'trFrCx6CI95','trFrCx6i','trFrCx6iCI95','trFrCx6imean','trFrCx6mean','trFrNRT','trFrNRT2','trFrNRT2CI95',...
        'trFrNRT2mean','trFrNRTCI95','trFrNRTmean','trFrTC','trFrTC2','trFrTC2CI95','trFrTC2mean','trFrTCCI95',...
        'trFrTCmean','brFrAll','brFrAllCI95','brFrAllmean','brFrCx23','brFrCx23CI95','brFrCx23i','brFrCx23iCI95',...
        'brFrCx23imean','brFrCx23mean','brFrCx4','brFrCx4CI95','brFrCx4i','brFrCx4iCI95','brFrCx4imean','brFrCx4mean',...
        'brFrCx5','brFrCx5CI95','brFrCx5i','brFrCx5iCI95','brFrCx5imean','brFrCx5mean','brFrCx6','brFrCx6CI95',...
        'brFrCx6i','brFrCx6iCI95','brFrCx6imean','brFrCx6mean','brFrNRT','brFrNRT2','brFrNRT2CI95','brFrNRT2mean',...
        'brFrNRTCI95','brFrNRTmean','brFrTC','brFrTC2','brFrTC2CI95','brFrTC2mean','brFrTCCI95','brFrTCmean',...
        'frFrLargeAll','frFrLargeAllCI95','frFrLargeAllmean','frFrLargeCx23','frFrLargeCx23CI95','frFrLargeCx23i',...
        'frFrLargeCx23iCI95','frFrLargeCx23imean','frFrLargeCx23mean','frFrLargeCx4','frFrLargeCx4CI95','frFrLargeCx4i',...
        'frFrLargeCx4iCI95','frFrLargeCx4imean','frFrLargeCx4mean','frFrLargeCx5','frFrLargeCx5CI95','frFrLargeCx5i',...
        'frFrLargeCx5iCI95','frFrLargeCx5imean','frFrLargeCx5mean','frFrLargeCx6','frFrLargeCx6CI95','frFrLargeCx6i',...
        'frFrLargeCx6iCI95','frFrLargeCx6imean','frFrLargeCx6mean','frFrLargeNRT','frFrLargeNRT2','frFrLargeNRT2CI95',...
        'frFrLargeNRT2mean','frFrLargeNRTCI95','frFrLargeNRTmean','frFrLargeTC','frFrLargeTC2','frFrLargeTC2CI95',...
        'frFrLargeTC2mean','frFrLargeTCCI95','frFrLargeTCmean','trFrLargeAll','trFrLargeAllCI95','trFrLargeAllmean',...
        'trFrLargeCx23','trFrLargeCx23CI95','trFrLargeCx23i','trFrLargeCx23iCI95','trFrLargeCx23imean',...
        'trFrLargeCx23mean','trFrLargeCx4','trFrLargeCx4CI95','trFrLargeCx4i','trFrLargeCx4iCI95','trFrLargeCx4imean',...
        'trFrLargeCx4mean','trFrLargeCx5','trFrLargeCx5CI95','trFrLargeCx5i','trFrLargeCx5iCI95','trFrLargeCx5imean',...
        'trFrLargeCx5mean','trFrLargeCx6','trFrLargeCx6CI95','trFrLargeCx6i','trFrLargeCx6iCI95','trFrLargeCx6imean',...
        'trFrLargeCx6mean','trFrLargeNRT','trFrLargeNRT2','trFrLargeNRT2CI95','trFrLargeNRT2mean','trFrLargeNRTCI95',...
        'trFrLargeNRTmean','trFrLargeTC','trFrLargeTC2','trFrLargeTC2CI95','trFrLargeTC2mean','trFrLargeTCCI95',...
        'trFrLargeTCmean','brFrLargeAll','brFrLargeAllCI95','brFrLargeAllmean','brFrLargeCx23','brFrLargeCx23CI95',...
        'brFrLargeCx23i','brFrLargeCx23iCI95','brFrLargeCx23imean','brFrLargeCx23mean','brFrLargeCx4',...
        'brFrLargeCx4CI95','brFrLargeCx4i','brFrLargeCx4iCI95','brFrLargeCx4imean','brFrLargeCx4mean','brFrLargeCx5',...
        'brFrLargeCx5CI95','brFrLargeCx5i','brFrLargeCx5iCI95','brFrLargeCx5imean','brFrLargeCx5mean','brFrLargeCx6',...
        'brFrLargeCx6CI95','brFrLargeCx6i','brFrLargeCx6iCI95','brFrLargeCx6imean','brFrLargeCx6mean','brFrLargeNRT',...
        'brFrLargeNRT2','brFrLargeNRT2CI95','brFrLargeNRT2mean','brFrLargeNRTCI95','brFrLargeNRTmean','brFrLargeTC',...
        'brFrLargeTC2','brFrLargeTC2CI95','brFrLargeTC2mean','brFrLargeTCCI95','brFrLargeTCmean','iRange','nIN','nNRT',...
        'nPY','nTC');
end
if psi && fullRun
    save('psiData.mat', 'dt','t','dtInterp','tInterp','psiAll','psiAllCI95','psiAllmean','psiCx23','psiCx23CI95',...
        'psiCx23i','psiCx23iCI95','psiCx23imean','psiCx23mean','psiCx4','psiCx4CI95','psiCx4i',...
        'psiCx4iCI95','psiCx4imean','psiCx4mean','psiCx5','psiCx5CI95','psiCx5i','psiCx5iCI95',...
        'psiCx5imean','psiCx5mean','psiCx6','psiCx6CI95','psiCx6i','psiCx6iCI95','psiCx6imean',...
        'psiCx6mean','psiNRT','psiNRT2','psiNRT2CI95','psiNRT2mean','psiNRTCI95','psiNRTmean',...
        'psiTC','psiTC2','psiTC2CI95','psiTC2mean','psiTCCI95','psiTCmean','psiAll_t','psiAllCI95_t',...
        'psiAllmean_t','psiCx23_t','psiCx23CI95_t','psiCx23i_t','psiCx23iCI95_t','psiCx23imean_t',...
        'psiCx23mean_t','psiCx4_t','psiCx4CI95_t','psiCx4i_t','psiCx4iCI95_t','psiCx4imean_t',...
        'psiCx4mean_t','psiCx5_t','psiCx5CI95_t','psiCx5i_t','psiCx5iCI95_t','psiCx5imean_t',...
        'psiCx5mean_t','psiCx6_t','psiCx6CI95_t','psiCx6i_t','psiCx6iCI95_t','psiCx6imean_t',...
        'psiCx6mean_t','psiNRT_t','psiNRT2_t','psiNRT2CI95_t','psiNRT2mean_t','psiNRTCI95_t',...
        'psiNRTmean_t','psiTC_t','psiTC2_t','psiTC2CI95_t','psiTC2mean_t','psiTCCI95_t',...
        'psiTCmean_t','phaseDiffAll','phaseDiffAllCI95','phaseDiffAllmean','phaseDiffCx23',...
        'phaseDiffCx23CI95','phaseDiffCx23i','phaseDiffCx23iCI95','phaseDiffCx23imean',...
        'phaseDiffCx23mean','phaseDiffCx4','phaseDiffCx4CI95','phaseDiffCx4i','phaseDiffCx4iCI95',...
        'phaseDiffCx4imean','phaseDiffCx4mean','phaseDiffCx5','phaseDiffCx5CI95','phaseDiffCx5i',...
        'phaseDiffCx5iCI95','phaseDiffCx5imean','phaseDiffCx5mean','phaseDiffCx6',...
        'phaseDiffCx6CI95','phaseDiffCx6i','phaseDiffCx6iCI95','phaseDiffCx6imean',...
        'phaseDiffCx6mean','phaseDiffNRT','phaseDiffNRT2','phaseDiffNRT2CI95','phaseDiffNRT2mean',...
        'phaseDiffNRTCI95','phaseDiffNRTmean','phaseDiffTC','phaseDiffTC2','phaseDiffTC2CI95',...
        'phaseDiffTC2mean','phaseDiffTCCI95','phaseDiffTCmean','psiRasterAll','psiRasterAllCI95','psiRasterAllmean','psiRasterCx23',...
        'psiRasterCx23CI95','psiRasterCx23i','psiRasterCx23iCI95','psiRasterCx23imean','psiRasterCx23mean','psiRasterCx4',...
        'psiRasterCx4CI95','psiRasterCx4i','psiRasterCx4iCI95','psiRasterCx4imean','psiRasterCx4mean','psiRasterCx5','psiRasterCx5CI95',...
        'psiRasterCx5i','psiRasterCx5iCI95','psiRasterCx5imean','psiRasterCx5mean','psiRasterCx6','psiRasterCx6CI95','psiRasterCx6i',...
        'psiRasterCx6iCI95','psiRasterCx6imean','psiRasterCx6mean','psiRasterNRT','psiRasterNRT2','psiRasterNRT2CI95',...
        'psiRasterNRT2mean','psiRasterNRTCI95','psiRasterNRTmean','psiRasterTC','psiRasterTC2','psiRasterTC2CI95','psiRasterTC2mean',...
        'psiRasterTCCI95','psiRasterTCmean','psiRasterAll_t','psiRasterAllCI95_t','psiRasterAllmean_t','psiRasterCx23_t',...
        'psiRasterCx23CI95_t','psiRasterCx23i_t','psiRasterCx23iCI95_t','psiRasterCx23imean_t','psiRasterCx23mean_t','psiRasterCx4_t',...
        'psiRasterCx4CI95_t','psiRasterCx4i_t','psiRasterCx4iCI95_t','psiRasterCx4imean_t','psiRasterCx4mean_t','psiRasterCx5_t',...
        'psiRasterCx5CI95_t','psiRasterCx5i_t','psiRasterCx5iCI95_t','psiRasterCx5imean_t','psiRasterCx5mean_t','psiRasterCx6_t',...
        'psiRasterCx6CI95_t','psiRasterCx6i_t','psiRasterCx6iCI95_t','psiRasterCx6imean_t','psiRasterCx6mean_t','psiRasterNRT_t',...
        'psiRasterNRT2_t','psiRasterNRT2CI95_t','psiRasterNRT2mean_t','psiRasterNRTCI95_t','psiRasterNRTmean_t','psiRasterTC_t',...
        'psiRasterTC2_t','psiRasterTC2CI95_t','psiRasterTC2mean_t','psiRasterTCCI95_t','psiRasterTCmean_t','phaseDiffRasterAll',...
        'phaseDiffRasterAllCI95','phaseDiffRasterAllmean','phaseDiffRasterCx23','phaseDiffRasterCx23CI95','phaseDiffRasterCx23i',...
        'phaseDiffRasterCx23iCI95','phaseDiffRasterCx23imean','phaseDiffRasterCx23mean','phaseDiffRasterCx4','phaseDiffRasterCx4CI95',...
        'phaseDiffRasterCx4i','phaseDiffRasterCx4iCI95','phaseDiffRasterCx4imean','phaseDiffRasterCx4mean','phaseDiffRasterCx5',...
        'phaseDiffRasterCx5CI95','phaseDiffRasterCx5i','phaseDiffRasterCx5iCI95','phaseDiffRasterCx5imean','phaseDiffRasterCx5mean',...
        'phaseDiffRasterCx6','phaseDiffRasterCx6CI95','phaseDiffRasterCx6i','phaseDiffRasterCx6iCI95','phaseDiffRasterCx6imean',...
        'phaseDiffRasterCx6mean','phaseDiffRasterNRT','phaseDiffRasterNRT2','phaseDiffRasterNRT2CI95','phaseDiffRasterNRT2mean',...
        'phaseDiffRasterNRTCI95','phaseDiffRasterNRTmean','phaseDiffRasterTC','phaseDiffRasterTC2','phaseDiffRasterTC2CI95',...
        'phaseDiffRasterTC2mean','phaseDiffRasterTCCI95','phaseDiffRasterTCmean',...
        'phaseDiffRasterCx23Initial','phaseDiffRasterCx23iInitial','phaseDiffRasterCx4Initial','phaseDiffRasterCx4iInitial',...
        'phaseDiffRasterCx5Initial','phaseDiffRasterCx5iInitial','phaseDiffRasterCx6Initial','phaseDiffRasterCx6iInitial',...
        'phaseDiffRasterNRTInitial','phaseDiffRasterNRT2Initial','phaseDiffRasterTCInitial','phaseDiffRasterTC2Initial',...
        'phaseDiffRasterCx23Final','phaseDiffRasterCx23iFinal','phaseDiffRasterCx4Final','phaseDiffRasterCx4iFinal',...
        'phaseDiffRasterCx5Final','phaseDiffRasterCx5iFinal','phaseDiffRasterCx6Final','phaseDiffRasterCx6iFinal',...
        'phaseDiffRasterNRTFinal','phaseDiffRasterNRT2Final','phaseDiffRasterTCFinal','phaseDiffRasterTC2Final',...
        'iRange','nIN','nNRT','nPY','nTC','psiWindow');
end
toc